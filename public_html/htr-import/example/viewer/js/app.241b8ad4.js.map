{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/openseadragon-svg-overlay.js","webpack:///./src/App.vue?22f0","webpack:///./src/views/Editor.vue?8126","webpack:///./src/components/DetailView/TranscriptionInterfaceLocal.vue?1389","webpack:///./src/components/DetailView/DetailEditLayout.vue?4558","webpack:///src/components/DetailView/DetailEditLayout.vue","webpack:///./src/components/DetailView/DetailEditLayout.vue?dd19","webpack:///./src/components/DetailView/DetailEditLayout.vue","webpack:///./src/components/DetailView/DetailContentEdit.vue?cd07","webpack:///./src/components/DetailView/DetailContentLayout.vue?1362","webpack:///./src/components/DetailView/DetailContentLayout.vue","webpack:///./src/components/DetailView/DetailContentTextEdit.vue?b1af","webpack:///./src/components/Editor/RegionNode.vue?1302","webpack:///src/components/Editor/RegionNode.vue","webpack:///./src/components/Editor/RegionNode.vue?05ea","webpack:///./src/components/Editor/RegionNode.vue","webpack:///./src/components/Editor/RegionExtension.js","webpack:///./src/components/Editor/LineNode.vue?143b","webpack:///src/components/Editor/LineNode.vue","webpack:///./src/components/Editor/LineNode.vue?3fc7","webpack:///./src/components/Editor/LineNode.vue","webpack:///./src/config/index.js","webpack:///./src/utils/xml.js","webpack:///./src/utils/api.js","webpack:///./src/store/detail/index.js","webpack:///./src/store/browse/index.js","webpack:///./src/store/content/index.js","webpack:///./src/store/index.js","webpack:///./src/components/Editor/LineExtension.js","webpack:///./src/components/Editor/TagExtension.js","webpack:///./src/components/Editor/SubscriptExtension.js","webpack:///./src/components/Editor/SuperscriptExtension.js","webpack:///src/components/DetailView/DetailContentTextEdit.vue","webpack:///./src/components/DetailView/DetailContentTextEdit.vue?7c02","webpack:///./src/components/DetailView/DetailContentTextEdit.vue","webpack:///src/components/DetailView/DetailContentEdit.vue","webpack:///./src/components/DetailView/DetailContentEdit.vue?389d","webpack:///./src/components/DetailView/DetailContentEdit.vue","webpack:///./src/components/DetailView/DetailImageEditViewer.vue?4554","webpack:///./src/mixins/image.js","webpack:///./src/components/vue-openseadragon.vue?62b0","webpack:///src/components/vue-openseadragon.vue","webpack:///./src/components/vue-openseadragon.vue?f2f4","webpack:///./src/components/vue-openseadragon.vue","webpack:///src/components/DetailView/DetailImageEditViewer.vue","webpack:///./src/components/DetailView/DetailImageEditViewer.vue?0808","webpack:///./src/components/DetailView/DetailImageEditViewer.vue","webpack:///./src/components/DetailView/DetailImageControls.vue?8881","webpack:///src/components/DetailView/DetailImageControls.vue","webpack:///./src/components/DetailView/DetailImageControls.vue?8c77","webpack:///./src/components/DetailView/DetailImageControls.vue?2687","webpack:///src/components/DetailView/TranscriptionInterfaceLocal.vue","webpack:///./src/components/DetailView/TranscriptionInterfaceLocal.vue?8f55","webpack:///./src/components/DetailView/TranscriptionInterfaceLocal.vue","webpack:///src/views/Editor.vue","webpack:///./src/views/Editor.vue?115f","webpack:///./src/views/Editor.vue","webpack:///src/App.vue","webpack:///./src/App.vue?a37b","webpack:///./src/App.vue?180a","webpack:///./src/plugins/fontawesome.js","webpack:///./src/main.js","webpack:///./src/App.vue?df62","webpack:///./src/components/DetailView/DetailImageControls.vue?4c95","webpack:///./src/components/DetailView/TranscriptionInterfaceLocal.vue?6a20","webpack:///./node_modules/rollup-plugin-banner/dist sync","webpack:///./src/components/Editor/RegionNode.vue?4ffd"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","$","OpenSeadragon","require","Error","svgNS","Viewer","svgOverlay","this","_svgOverlayInfo","Overlay","viewer","self","_viewer","_containerWidth","_containerHeight","_svg","document","createElementNS","style","position","left","top","width","height","canvas","appendChild","_node","addHandler","resize","evt","node","container","clientWidth","setAttribute","clientHeight","viewport","pixelFromPoint","Point","zoom","getZoom","rotation","getRotation","scale","_containerInnerSize","x","y","onClick","handler","MouseTracker","element","clickHandler","setTracking","render","_vm","_h","$createElement","_c","_self","attrs","iiifUrl","toJsonObject","xmlJson","staticRenderFns","tags","staticClass","view","scopedSlots","_u","fn","ref","imageInfo","parsedJson","results","_e","on","handleControlEvent","proxy","_t","components","computed","props","type","String","validator","includes","component","staticStyle","script","isLoading","model","callback","$$v","expression","isAnnotation","_v","$event","setFontSize","layoutIcon","setEditLayout","editor","chain","focus","undo","run","redo","saveContent","_l","selectedTag","tempTag","index","_s","tag","findTagAttributes","attribute","changeContinued","attributes","$set","setAttributes","tagDefs","class","isActive","toggleBold","toggleStrike","toggleUnderline","toggleSub","toggleSuper","definitions","color","label","fontSize","NodeViewWrapper","NodeViewContent","selectable","Node","group","content","addAttributes","lines","default","parseHTML","renderHTML","HTMLAttributes","mergeAttributes","addNodeView","VueNodeViewRenderer","Component","line","onMouseClick","id","onMouseOut","onMouseOver","methods","highlight","$store","dispatch","target","origin","select","urls","image","xml","hashidsSecret","token","transcriptionURL","searchApiBaseUrl","apiBaseUrl","contactEmail","bugEmail","bugtrackerUrl","repo","consentCookie","recordSession","xml2js","json2xml","jp","XML2JS","DEFAULT","compact","trim","alwaysArray","alwaysChildren","attributeValueFn","parseAttributeValue","TEST","parsePointsAttribute","string","split","map","parseInt","reverseParsePointsAttribute","values","pointString","point","points","temp","replace","parseCustomAttribute","reduce","indexOf","concat","decodeURIComponent","JSON","parse","Boolean","reverseParseparseCustomAttribute","customString","custom","stringify","replaceAll","reverseParseAttributeValue","imgUrl","getObjects","obj","val","objects","lastIndexOf","replaceLine","textString","customObjArr","elementArr","elements","text","parseEditorOutput","editorJson","globalJson","editorLineArr","lineIndex","contentIndex","undefined","lineContent","marks","markIndex","mark","offset","strikethrough","underlined","subscript","superscript","parseToXML","json","options","ignoreComment","spaces","sanitize","attributesFn","parseJsonContent","search","PcGts","Page","parsePageContent","js","xmlModel","fetch","logOut","$auth","loginWith","fetchSearchResults","term","documents","titles","page","fuzziness","limit","$nuxt","$axios","method","body","collections","collection","headers","CONTENT_TYPE","Accept","res","status","fetchTagDef","collId","fetchDocumentsMeta","docId","params","nrOfTranscripts","fetchPageContentXML","fetchPageInfo","pageNr","title","colTitle","maxPage","NaN","documentInfo","isDocumentReady","isDocumentNotFoundError","pageId","pageNum","pageInfo","pageContentId","tsList","tsKey","isPageReady","isPageContentReady","isPageNotFoundError","isPageContentNotFoundError","requestCount","tagMode","changed","state","assign","getters","rootState","hasResults","mutations","update","beginRequest","endRequest","actions","commit","routeParams","docid","collectionid","pageid","fetchDocumentInfo","collectionList","colList","find","colId","nrOfPages","transcripts","fetchPageContent","freeze","namespaced","colRole","deepEqual","setCollections","setTagDefs","setDocuments","setColTitle","setColRole","selected","highlighted","isError","isReady","wasSaved","wasEdited","editLayoutHorizontal","reset","isready","setSelectedTag","setXmlModel","findElementById","stack","pop","forEach","Vue","use","Vuex","Store","browse","detail","strict","process","addProseMirrorPlugins","Plugin","handleKeyDown","event","which","deleting","filterTransaction","transaction","mapping","maps","oldStart","oldEnd","newStart","newEnd","doc","nodesBetween","number","pos","parent","addKeyboardShortcuts","Enter","commands","selectParentNode","selection","nodeAt","$head","selectNodeForward","setTextSelection","size","lineId","el","getElementById","scrollIntoView","behavior","store","ArrowDown","console","log","ArrowUp","tagExtensions","tagIndex","tagExtensionArr","tempExtension","Highlight","extend","toggleBulletList","addCommands","setTag","setMark","toggleTag","tr","toggleMark","unsetTag","unsetMark","annotationId","getAttribute","backgroundColor","Subscript","Mark","defaultOptions","consuming","getAttrs","setSub","unsetSub","Superscript","setSuper","unsetSuper","groupBy","filters","item","clean","watch","newValue","oldValue","nodes","docView","descendants","deep","setup","TextAlign","EditorContent","BubbleMenu","required","editorContentJson","annotationCounter","lastTag","hasContent","contentData","linetemp","hasTag","getTags","continued","continuedTags","findMarkByUid","from","to","found","filter","annotations","tagObj","tagName","tagColor","contentObj","getAttributes","anchor","$anchor","openToast","$buefy","toast","open","duration","message","groupByRow","table","getTagDef","beforeDestroy","destroy","setEditorContentJSON","tagContent","setTagContent","editorContent","groupedRows","rowContent","row","cellContent","rowtemp","cell","celltemp","lineObjects","lineObj","regionObj","setContent","arrText","stringOffset","findTags","tagTemp","textStyles","setTextStyles","textStyle","tagDef","tagMark","bold","textStyleArr","indexes","sort","unshift","str","substring","lineText","tagtext","substr","textStyleClass","classString","$refs","Layout","ContentTextEdit","onOpen","imageBaseUrl","config","getPaddedRect","padding","getImageInfo","getImageSource","getScaledSource","getThumbnailSource","getContextImageSource","toRect","getRoundedRect","rect","round","getIntersectionRatio","r1","r2","dx","Math","min","max","dy","getScaledRect","rounded","w","getScaledPoints","test","i18n","messages","mounted","$nextTick","translate","_options","tileSources","zoomPerClick","addOnceHandler","resolve","_cursor","setString","panTo","fitBoundsWithConstraints","addOverlay","mixins","source","Number","Array","selectLayoutElement","fitBounds","prefixUrl","maxZoomLevel","showZoomControl","showHomeControl","showFullPageControl","visibilityRatio","destroyed","openseadragon","svgNode","innerHTML","fitToWidth","layoutElements","renderLayout","overlays","selectedOverlayIndex","newBounds","viewportAspect","setHome","gestureSettingsMouse","clickToZoom","isAnimated","delta","zoomBy","applyConstraints","activeNode","classList","add","selectWithPan","svg","attr","geometry","pointsTemp","coords","elementGroup","className","highlightLayoutElement","highlightedLayoutElement","contains","renderPolygon","createOverlays","d3","d3Rect","clear","remove","sanitizeScore","score","increaseZoom","decreaseZoom","fullscreen","$emit","home","$fullscreen","toggle","DetailEditLayout","Content","ImageViewer","ImageControls","toLowerCase","TranscriptionInterfaceLocal","xmlJsonString","escapeSpecialChars","Editor","cleanedString","install","library","faSearch","faAngleRight","faAngleLeft","faAngleUp","faAngleDown","faMinusSquare","faPlusSquare","faChevronLeft","faChevronRight","faChevronUp","faChevronDown","faFileAlt","faTimes","faArrowUp","faCompress","faExpand","faArrowDown","faPlus","faMinus","faTrash","faDesktop","faColumns","faImage","faCode","faEye","faPaperPlane","faCheck","faShoppingCart","faDownload","faEyeSlash","faTags","faCaretDown","faCaretUp","faAlignLeft","faImages","faObjectGroup","faQuestion","faQuestionCircle","faExternalLinkAlt","faUndo","faRedo","faBars","faSave","faBold","faStrikethrough","faUnderline","faSubscript","faSuperscript","faTag","FontAwesomeIcon","productionTip","fontawesome","Buefy","defaultIconComponent","defaultIconPack","VueFullscreen","root_element","AppRoot","App","eventBus","propsData","dataset","$root","$on","save","output","$mount","webpackEmptyContext","req","e","code","keys"],"mappings":"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","file":"js/app.241b8ad4.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// OpenSeadragon SVG Overlay plugin 0.0.5\n\n(function() {\n\n    var $ = window.OpenSeadragon;\n    \n    if (!$) {\n        $ = require('openseadragon');\n        if (!$) {\n            throw new Error('OpenSeadragon is missing.');\n        }\n    }\n\n    var svgNS = 'http://www.w3.org/2000/svg';\n\n    // ----------\n    $.Viewer.prototype.svgOverlay = function() {\n        if (this._svgOverlayInfo) {\n            return this._svgOverlayInfo;\n        }\n\n        this._svgOverlayInfo = new Overlay(this);\n        return this._svgOverlayInfo;\n    };\n\n    // ----------\n    var Overlay = function(viewer) {\n        var self = this;\n\n        this._viewer = viewer;\n        this._containerWidth = 0;\n        this._containerHeight = 0;\n\n        this._svg = document.createElementNS(svgNS, 'svg');\n        this._svg.style.position = 'absolute';\n        this._svg.style.left = 0;\n        this._svg.style.top = 0;\n        this._svg.style.width = '100%';\n        this._svg.style.height = '100%';\n        this._viewer.canvas.appendChild(this._svg);\n\n        this._node = document.createElementNS(svgNS, 'g');\n        this._svg.appendChild(this._node);\n\n        this._viewer.addHandler('animation', function() {\n            self.resize();\n        });\n\n        this._viewer.addHandler('open', function() {\n            self.resize();\n        });\n\n        this._viewer.addHandler('rotate', function(evt) {\n            self.resize();\n        });\n\n        this._viewer.addHandler('resize', function() {\n            self.resize();\n        });\n\n        this.resize();\n    };\n\n    // ----------\n    Overlay.prototype = {\n        // ----------\n        node: function() {\n            return this._node;\n        },\n\n        // ----------\n        resize: function() {\n            if (this._containerWidth !== this._viewer.container.clientWidth) {\n                this._containerWidth = this._viewer.container.clientWidth;\n                this._svg.setAttribute('width', this._containerWidth);\n            }\n\n            if (this._containerHeight !== this._viewer.container.clientHeight) {\n                this._containerHeight = this._viewer.container.clientHeight;\n                this._svg.setAttribute('height', this._containerHeight);\n            }\n\n            var p = this._viewer.viewport.pixelFromPoint(new $.Point(0, 0), true);\n            var zoom = this._viewer.viewport.getZoom(true);\n            var rotation = this._viewer.viewport.getRotation();\n            // TODO: Expose an accessor for _containerInnerSize in the OSD API so we don't have to use the private variable.\n            var scale = this._viewer.viewport._containerInnerSize.x * zoom;\n            this._node.setAttribute('transform',\n                'translate(' + p.x + ',' + p.y + ') scale(' + scale + ') rotate(' + rotation + ')');\n        },\n\n        // ----------\n        onClick: function(node, handler) {\n            // TODO: Fast click for mobile browsers\n\n            new $.MouseTracker({\n                element: node,\n                clickHandler: handler\n            }).setTracking(true);\n        }\n    };\n\n})();\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"transkribusEditor\"}},[(_vm.xmlJsonString)?_c('Editor',{attrs:{\"iiifUrl\":_vm.iiifUrl,\"xmlJson\":_vm.toJsonObject}}):_c('Editor',{attrs:{\"iiifUrl\":_vm.iiifUrl,\"xmlJson\":_vm.xmlJson}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',[_c('TranscriptionInterfaceLocal',{attrs:{\"iiifUrl\":_vm.iiifUrl,\"xmlJson\":_vm.xmlJson,\"tags\":_vm.tags}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"hero is-fullheight-with-navbar\"},[_c('DetailEditLayout',{attrs:{\"name\":_vm.view},scopedSlots:_vm._u([{key:\"image\",fn:function(){return [(_vm.imageInfo)?_c('ImageViewer',{ref:\"viewer\",attrs:{\"source\":_vm.iiifUrl,\"width\":_vm.imageInfo.width,\"height\":_vm.imageInfo.height,\"xmlJson\":_vm.parsedJson,\"results\":_vm.results}}):_vm._e(),_c('aside',{staticClass:\"detail-image-controls-wrapper\"},[_c('ImageControls',{on:{\"input\":_vm.handleControlEvent}})],1)]},proxy:true},{key:\"content\",fn:function(){return [_c('Content',{attrs:{\"id\":\"textEditor\",\"xmlJson\":_vm.parsedJson}})]},proxy:true}])})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"is-covering\"},[(_vm.editLayoutHorizontal)?_c('Splitpanes',{staticClass:\"default-theme\",attrs:{\"horizontal\":\"\"}},[_c('Pane',{attrs:{\"id\":\"imageHorizontal\"}},[_vm._t(\"image\")],2),_c('Pane',{attrs:{\"id\":\"contentHorizontal\"}},[_vm._t(\"content\")],2)],1):_c('Splitpanes',{staticClass:\"default-theme\"},[_c('Pane',{attrs:{\"id\":\"imageVertical\"}},[_vm._t(\"image\")],2),_c('Pane',{attrs:{\"id\":\"contentVertical\"}},[_vm._t(\"content\")],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"is-covering\">\n    <Splitpanes v-if=\"editLayoutHorizontal\" horizontal class=\"default-theme\">\n      <Pane\n        id=\"imageHorizontal\"\n      >\n        <slot name=\"image\"></slot>\n      </Pane>\n      <Pane id=\"contentHorizontal\">\n        <slot name=\"content\"></slot>\n      </Pane>\n    </Splitpanes>\n    <Splitpanes v-else class=\"default-theme\">\n      <Pane id=\"imageVertical\" style=\"\">\n        <slot name=\"image\"></slot>\n      </Pane>\n      <Pane id=\"contentVertical\" style=\"\">\n        <slot name=\"content\"></slot>\n      </Pane>\n    </Splitpanes>\n  </div>\n</template>\n\n<script>\nimport { Splitpanes, Pane } from \"splitpanes\";\nimport \"splitpanes/dist/splitpanes.css\";\n\nimport { mapState } from \"vuex\";\n\nexport default {\n  components: { Splitpanes, Pane },\n  computed: {\n    ...mapState(\"content\", [\"editLayoutHorizontal\"]),\n  },\n  props: {\n    name: {\n      type: String,\n      validator: (value) => {\n        return [\"both\", \"image\", \"content\", \"edit\"].includes(value);\n      },\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailEditLayout.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailEditLayout.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailEditLayout.vue?vue&type=template&id=35ad93c0&\"\nimport script from \"./DetailEditLayout.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailEditLayout.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Layout',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return undefined},proxy:true},{key:\"footer\",fn:function(){return undefined},proxy:true}])},[[_c('ContentTextEdit',{attrs:{\"xmlJson\":_vm.xmlJson}})]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"display\":\"flex\",\"flex-flow\":\"column nowrap\",\"height\":\"100%\",\"overflow\":\"hidden\",\"width\":\"100%\"}},[_c('div',[_vm._t(\"header\")],2),_vm._t(\"default\"),_vm._t(\"footer\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./DetailContentLayout.vue?vue&type=template&id=1d20946a&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.editor)?_c('div',{staticClass:\"editor\"},[_c('b-loading',{attrs:{\"active\":_vm.isLoading,\"is-full-page\":false},model:{value:(_vm.isLoading),callback:function ($$v) {_vm.isLoading=$$v},expression:\"isLoading\"}}),(_vm.editor)?_c('div',{staticClass:\"editor__header\"},[_c('b-navbar',{staticStyle:{\"width\":\"100%\",\"overflow\":\"auto\"},scopedSlots:_vm._u([{key:\"start\",fn:function(){return [_c('b-navbar-item',[_c('b-switch',{model:{value:(_vm.isAnnotation),callback:function ($$v) {_vm.isAnnotation=$$v},expression:\"isAnnotation\"}},[_vm._v(\" Annotation \")])],1)]},proxy:true},{key:\"end\",fn:function(){return [_c('b-navbar-item',[_c('b-button',{attrs:{\"title\":\"Increase font size\",\"icon-left\":\"plus\"},on:{\"click\":function($event){return _vm.setFontSize(0.1)}}}),_c('b-button',{attrs:{\"title\":\"Decrease font size\",\"icon-left\":\"minus\"},on:{\"click\":function($event){return _vm.setFontSize(-0.1)}}})],1),_c('b-navbar-item',[_c('b-button',{attrs:{\"title\":\"Switch view\",\"icon-left\":_vm.layoutIcon()},on:{\"click\":_vm.setEditLayout}}),_c('b-button',{attrs:{\"title\":\"Undo\",\"icon-left\":\"undo\"},on:{\"click\":function($event){_vm.editor.chain().focus().undo().run()}}}),_c('b-button',{attrs:{\"title\":\"Redo\",\"icon-left\":\"redo\"},on:{\"click\":function($event){_vm.editor.chain().focus().redo().run()}}})],1),_c('b-navbar-item',[_c('b-field',[_c('b-button',{attrs:{\"icon-left\":\"save\",\"type\":\"is-success\"},on:{\"click\":_vm.saveContent}},[_vm._v(\"\\n              Save\\n            \")])],1)],1)]},proxy:true}],null,false,916800163)})],1):_vm._e(),_c('div',{staticClass:\"tile editor__content\"},[(_vm.isAnnotation)?_c('div',{staticClass:\"tile is-parent is-vertical is-3\"},[(_vm.selectedTag)?_c('div',{staticClass:\"tile is-child box\"},[_c('div',_vm._l((_vm.selectedTag.marks),function(tempTag,index){return _c('div',{key:index,staticClass:\"tile is-vertical\",staticStyle:{\"width\":\"100%\"}},[(tempTag.attrs.tag)?_c('div',{staticClass:\"tile is-child\"},[_c('b-tag',{style:((\"outline-color: \" + (tempTag.attrs.color) + \" !important; outline: 2px solid; color : \" + (tempTag.attrs.color) + \" !important;margin-top: auto;margin-bottom: auto;\")),attrs:{\"icon-left\":\"tag\"}},[_vm._v(\"\\n                \"+_vm._s(tempTag.attrs.tag.name)+\"\\n              \")])],1):_vm._e(),_vm._l((_vm.findTagAttributes(tempTag)),function(attribute,i){return _c('div',{key:i,staticClass:\"tile is-child\"},[(tempTag.attrs.tag)?_c('b-field',{attrs:{\"label\":attribute,\"label-position\":\"on-border\"}},[_c('b-input',{on:{\"input\":function($event){return _vm.changeContinued(\n                      tempTag,\n                      tempTag.attrs.tag.attributes[attribute],\n                      attribute\n                    )}},model:{value:(tempTag.attrs.tag.attributes[attribute]),callback:function ($$v) {_vm.$set(tempTag.attrs.tag.attributes, attribute, $$v)},expression:\"tempTag.attrs.tag.attributes[attribute]\"}})],1):_vm._e()],1)}),(tempTag.attrs.tag)?_c('div',{staticClass:\"tile is-child\"},[_c('b-button',{attrs:{\"type\":\"is-danger\",\"icon-left\":\"trash\"},on:{\"click\":function($event){return _vm.setAttributes(tempTag)}}},[_vm._v(\"\\n                Delete\\n              \")])],1):_vm._e()],2)}),0)]):_vm._e(),_c('div',{staticClass:\"tile is-child box\"},[(_vm.editor && _vm.isAnnotation && _vm.tagDefs)?_c('div',{staticClass:\"transkribusEditor-bubble-menu\",staticStyle:{\"text-align\":\"center\"}},[_c('b-button',{class:{ 'is-active': _vm.editor.isActive('bold') },attrs:{\"title\":\"Bold\",\"type\":\"is-primary\",\"icon-left\":\"bold\"},on:{\"click\":function($event){_vm.editor.chain().focus().toggleBold().run()}}}),_c('b-button',{class:{ 'is-active': _vm.editor.isActive('strike') },attrs:{\"title\":\"Strike\",\"type\":\"is-primary\",\"icon-left\":\"strikethrough\"},on:{\"click\":function($event){_vm.editor.chain().focus().toggleStrike().run()}}}),_c('b-button',{class:{ 'is-active': _vm.editor.isActive('underline') },attrs:{\"title\":\"Underline\",\"type\":\"is-primary\",\"icon-left\":\"underline\"},on:{\"click\":function($event){_vm.editor.chain().focus().toggleUnderline().run()}}}),_c('b-button',{class:{ 'is-active': _vm.editor.isActive('subscript') },attrs:{\"title\":\"Subscript\",\"type\":\"is-primary\",\"icon-left\":\"subscript\"},on:{\"click\":function($event){_vm.editor.chain().focus().toggleSub().run()}}}),_c('b-button',{class:{ 'is-active': _vm.editor.isActive('superscript') },attrs:{\"title\":\"Superscript\",\"type\":\"is-primary\",\"icon-left\":\"superscript\"},on:{\"click\":function($event){_vm.editor.chain().focus().toggleSuper().run()}}}),_c('br'),_vm._l((_vm.tagDefs.definitions.annotations),function(tag,index){return _c('b-button',{key:index,class:{\n              'is-active': _vm.editor.isActive(tag.name, {\n                color: tag.color,\n              }),\n            },style:('background-color:' + tag.color),attrs:{\"icon-left\":\"tag\"},on:{\"click\":function($event){return _vm.setAttributes(tag)}}},[_vm._v(\"\\n            \"+_vm._s(tag.label)+\"\\n          \")])})],2):_vm._e()])]):_vm._e(),_c('div',{staticClass:\"tile is-parent box\"},[_c('editor-content',{staticClass:\"editor__content\",style:({ fontSize: _vm.fontSize + 'rem' }),attrs:{\"editor\":_vm.editor}})],1)])],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('node-view-wrapper',{staticClass:\"region\"},[_c('node-view-content',{staticClass:\"content\"})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <node-view-wrapper class=\"region\">\n    <!-- <span v-if=\"this.node.attrs.lines.attributes.id\" class=\"label\">Region {{ this.node.attrs.lines.attributes.id }}</span> -->\n    <node-view-content class=\"content\"> </node-view-content>\n  </node-view-wrapper>\n</template>\n\n<script>\nimport { NodeViewWrapper, NodeViewContent, nodeViewProps } from \"@tiptap/vue-2\";\n\nexport default {\n  components: {\n    NodeViewWrapper,\n    NodeViewContent,\n  },\n\n  props: nodeViewProps,\n\n  selectable: false,\n};\n</script>\n\n<style lang=\"scss\" scoped>\n// .region {\n//   background: #e1ebee;\n//   border: 1px solid #0d0d0d;\n//   border-radius: 0.5rem;\n//   margin: 1rem 0;\n//   position: relative;\n// }\n\n// .label {\n//   margin-left: 1rem;\n//   background-color: #0d0d0d;\n//   font-size: 0.6rem;\n//   letter-spacing: 1px;\n//   font-weight: bold;\n//   text-transform: uppercase;\n//   color: #fff;\n//   position: absolute;\n//   top: 0;\n//   padding: 0.25rem 0.75rem;\n//   border-radius: 0 0 0.5rem 0.5rem;\n// }\n\n// .content {\n//   // margin-top: 1.5rem;\n//   padding: 0.3rem;\n// }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RegionNode.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RegionNode.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RegionNode.vue?vue&type=template&id=90ae8d76&scoped=true&\"\nimport script from \"./RegionNode.vue?vue&type=script&lang=js&\"\nexport * from \"./RegionNode.vue?vue&type=script&lang=js&\"\nimport style0 from \"./RegionNode.vue?vue&type=style&index=0&id=90ae8d76&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"90ae8d76\",\n  null\n  \n)\n\nexport default component.exports","import { Node, mergeAttributes } from \"@tiptap/core\";\nimport { VueNodeViewRenderer } from \"@tiptap/vue-2\";\nimport Component from \"./RegionNode.vue\";\n\nexport default Node.create({\n  name: \"region\",\n\n  group: \"block\",\n\n  content: \"(line+ | table+)\",\n\n  addAttributes() {\n    return {\n      lines: {\n        default: [],\n      },\n    };\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: \"div\",\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\"div\", mergeAttributes(HTMLAttributes)];\n  },\n\n  addNodeView() {\n    return VueNodeViewRenderer(Component);\n  },\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (this.node.attrs.line.attributes)?_c('node-view-wrapper',{staticClass:\"line\"},[_c('div',{on:{\"click\":function($event){return _vm.onMouseClick(_vm.node.attrs.line.attributes.id)},\"mouseout\":function($event){return _vm.onMouseOut(_vm.node.attrs.line.attributes.id)},\"mouseover\":function($event){return _vm.onMouseOver(_vm.node.attrs.line.attributes.id)}}},[_c('node-view-content',{attrs:{\"id\":this.node.attrs.line.attributes.id}})],1)]):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <node-view-wrapper v-if=\"this.node.attrs.line.attributes\" class=\"line\">\n    <!-- <div\n    @mouseout=\"onMouseOut(node.attrs.line.attributes.id)\" @mouseover=\"onMouseOver(node.attrs.line.attributes.id)\"\n      class=\"drag-handle\"\n      contenteditable=\"false\"\n      draggable=\"true\"\n      data-drag-handle\n    /> -->\n    <div\n      @click=\"onMouseClick(node.attrs.line.attributes.id)\"\n      @mouseout=\"onMouseOut(node.attrs.line.attributes.id)\"\n      @mouseover=\"onMouseOver(node.attrs.line.attributes.id)\"\n    >\n      <node-view-content :id=\"this.node.attrs.line.attributes.id\">\n      </node-view-content>\n    </div>\n  </node-view-wrapper>\n</template>\n\n<script>\nimport { NodeViewWrapper, NodeViewContent, nodeViewProps } from '@tiptap/vue-2'\nimport { mapState } from 'vuex'\n\nexport default {\n  components: {\n    NodeViewWrapper,\n    NodeViewContent\n  },\n  methods: {\n    highlight(id) {\n      this.$store.dispatch('content/highlight', {\n        target: id,\n        origin: 'content'\n      })\n    },\n    select(id) {\n      this.$store.dispatch('content/select', {\n        target: id,\n        origin: 'content'\n      })\n    },\n    onMouseOver(id) {\n      this.highlight(id)\n    },\n    onMouseOut(id) {\n      this.highlight(id)\n    },\n    onMouseClick(id) {\n      this.select(id)\n    }\n  },\n\n  props: nodeViewProps\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LineNode.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LineNode.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LineNode.vue?vue&type=template&id=3a71c82c&\"\nimport script from \"./LineNode.vue?vue&type=script&lang=js&\"\nexport * from \"./LineNode.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default {\n  // imageBaseUrl: 'https://dbis-thure.uibk.ac.at/iiif/2',\n  // imageBaseUrl: 'https://files-test.transkribus.eu/iiif/2',\n  urls: {\n    image: \"https://files.transkribus.eu/iiif/2\",\n    xml: \"https://files.transkribus.eu/Get?id=\",\n  },\n  hashidsSecret: \"1234\",\n  token: \"\",\n  transcriptionURL: \"https://transkribus.eu/r/testing/sandbox/application/\",\n  searchApiBaseUrl: \"https://transkribus.eu/r/zQPlDb1ZvVWJuiBU/api/v0\",\n  apiBaseUrl: \"https://transkribus.eu/TrpServerTesting/rest\",\n  contactEmail: \"info@readcoop.eu\",\n  bugEmail: \"bugs@readcoop.eu\",\n  bugtrackerUrl:\n    \"incoming+readcoop-webdev-public-transkribuslite-25175868-issue-@incoming.gitlab.com\",\n  repo: \"https://gitlab.com/readcoop/webdev/public/transkribuslite\",\n  consentCookie: \"cookieaccepted\",\n  recordSession: true,\n};\n","const { xml2js, json2xml } = require(\"xml-js\");\nconst jp = require(\"jmespath\");\nconst simplify = require(\"simplify-js\");\n\nconst XML2JS = {\n  DEFAULT: {\n    compact: false,\n    trim: false,\n    alwaysArray: true,\n    alwaysChildren: true,\n    attributeValueFn: parseAttributeValue,\n  },\n  TEST: {\n    compact: false,\n    attributeValueFn: parseAttributeValue,\n  },\n};\n\nconst SIMPLIFY_TOLERANCE = 25; // pixels\n\nfunction parsePointsAttribute(string = \"\") {\n  return string\n  .split(/\\s+/)\n  .map(string => string.split(/\\s*,\\s*/).map(x => parseInt(x)))\n  .map(([x, y]) => ({ x, y }))\n  // return simplify(\n  //   string\n  //     .split(/\\s+/)\n  //     .map((string) => string.split(/\\s*,\\s*/).map((x) => parseInt(x)))\n  //     .map(([x, y]) => ({ x, y })),\n  //   SIMPLIFY_TOLERANCE\n  // );\n}\n\nfunction reverseParsePointsAttribute(values) {\n  var pointString = \"\";\n  for (var point in values.points) {\n    var temp = values.points[point];\n    pointString += temp.x + \",\" + temp.y + \" \";\n  }\n  values.points = pointString.replace(/\\s*$/, \"\");\n}\n\nfunction parseCustomAttribute(string) {\n  if (string === \"\") return [];\n\n  return string.split(\"} \").reduce((results, string) => {\n    const name = string.split(\" {\")[0];\n    let attrs = string.split(\" {\")[1];\n\n    if (attrs.indexOf(\"}\")) attrs = attrs.replace(\"}\", \"\");\n\n    var key, value;\n\n    return results.concat({\n      name: name.trim(),\n      attributes: attrs.split(\";\").reduce((attrs, string) => {\n        string = string.trim();\n        if (string) {\n          key = string.split(\":\")[0].trim();\n          value = decodeURIComponent(\n            JSON.parse(\n              '\"' + string.split(\":\")[1].trim().replace('\"', '\\\\\"') + '\"'\n            )\n          );\n          if (key === \"index\" || key === \"offset\" || key === \"length\") {\n            attrs[key] = parseInt(value);\n          } else if (\n            key === \"continued\" ||\n            key === \"superscript\" ||\n            key === \"bold\" ||\n            key === \"italic\" ||\n            key === \"subscript\"\n          ) {\n            attrs[key] = Boolean(value);\n          } else attrs[key] = value;\n        }\n        return attrs;\n      }, {}),\n    });\n  }, []);\n}\n\nfunction reverseParseparseCustomAttribute(value) {\n  var customString = \"\";\n  for (var custom in value.custom) {\n    var temp = value.custom[custom];\n    customString +=\n      temp.name +\n      \" \" +\n      JSON.stringify(temp.attributes).replaceAll('\"', \"\").replaceAll(\",\", \";\") +\n      \" \";\n  }\n  value.custom = customString;\n}\n\nfunction parseAttributeValue(value, name) {\n  switch (name) {\n    case \"points\":\n      return parsePointsAttribute(value);\n    case \"custom\":\n      return parseCustomAttribute(value);\n    default:\n      return value;\n  }\n}\n\nfunction reverseParseAttributeValue(values, name) {\n  if (values.points) {\n    reverseParsePointsAttribute(values);\n  }\n  if (values.custom) {\n    reverseParseparseCustomAttribute(values);\n  }\n  if (values.imgUrl) {\n    values.imgUrl = values.imgUrl.replaceAll(\"&\", \"&amp;\");\n  }\n  switch (name) {\n    case \"points\":\n      return reverseParsePointsAttribute(values);\n    case \"custom\":\n      return reverseParseparseCustomAttribute(values);\n    default:\n      return values;\n  }\n}\n\nexport function getObjects(obj, key, val) {\n  var objects = [];\n  for (var i in obj) {\n    if (!obj.hasOwnProperty(i)) continue;\n    if (typeof obj[i] == \"object\") {\n      objects = objects.concat(getObjects(obj[i], key, val));\n    } else if ((i == key && obj[i] == val) || (i == key && val == \"\")) {\n      objects.push(obj);\n    } else if (obj[i] == val && key == \"\") {\n      if (objects.lastIndexOf(obj) == -1) {\n        objects.push(obj);\n      }\n    }\n  }\n  return objects;\n}\n\nfunction replaceLine(obj, key, val, textString, customObjArr) {\n  for (var i in obj) {\n    if (!obj.hasOwnProperty(i)) continue;\n    if (typeof obj[i] == \"object\") {\n      if (obj[i] && obj[i].name == \"TextLine\" && obj[i].attributes) {\n        if (obj[i].attributes.id == val) {\n          obj[i].attributes.custom = customObjArr;\n          var elementArr = {\n            elements: [{ text: \"\", type: \"text\" }],\n            name: \"Unicode\",\n            type: \"element\",\n          };\n          obj[i].elements[2].elements[0] = elementArr;\n          obj[i].elements[2].elements[0].elements[0].text = textString;\n          return obj[i];\n        }\n      }\n      replaceLine(obj[i], key, val, textString, customObjArr);\n    } else if ((i == key && obj[i] == val) || (i == key && val == \" \")) {\n      obj[i].attributes.custom = customObjArr;\n      obj[i].elements[2].elements[0].elements[0].text = textString;\n      return obj[i];\n    }\n  }\n}\n\nexport function getValues(obj, key) {\n  var objects = [];\n  for (var i in obj) {\n    if (!obj.hasOwnProperty(i)) continue;\n    if (typeof obj[i] == \"object\") {\n      objects = objects.concat(getValues(obj[i], key));\n    } else if (i == key) {\n      objects.push(obj[i]);\n    }\n  }\n  return objects;\n}\n\nexport function getKeys(obj, val) {\n  var objects = [];\n  for (var i in obj) {\n    if (!obj.hasOwnProperty(i)) continue;\n    if (typeof obj[i] == \"object\") {\n      objects = objects.concat(getKeys(obj[i], val));\n    } else if (obj[i] == val) {\n      objects.push(i);\n    }\n  }\n  return objects;\n}\n\nexport function parseEditorOutput(editorJson, globalJson) {\n  var editorLineArr = getObjects(editorJson, \"type\", \"line\");\n  for (var lineIndex in editorLineArr) {\n    var line = editorLineArr[lineIndex];\n    var customObjArr = [];\n    customObjArr.push(line.attrs.line.attributes.custom[0]);\n    var textString = \"\";\n    if (line.content == undefined) {\n      replaceLine(\n        globalJson,\n        \"id\",\n        line.attrs.line.attributes.id,\n        \" \",\n        customObjArr\n      );\n    }\n    for (var contentIndex in line.content) {\n      var lineContent = line.content[contentIndex];\n      var text = lineContent.text;\n      if (lineContent.marks) {\n        for (var markIndex in lineContent.marks) {\n          var mark = lineContent.marks[markIndex];\n          var attributes = {};\n          var name = mark.type;\n          var offset = textString.length;\n          var length = text.length;\n          if (mark.attrs) {\n            attributes = mark.attrs.tag.attributes;\n          }\n\n          if (attributes.offset === undefined) {\n            //TODO check for continued\n            attributes.offset = offset;\n            attributes.length = length;\n          }\n\n          switch (name) {\n            case \"strike\":\n              name = \"textStyle\";\n              attributes.strikethrough = true;\n              break;\n            case \"underline\":\n              name = \"textStyle\";\n              attributes.underlined = true;\n              break;\n            case \"subscript\":\n              name = \"textStyle\";\n              attributes.subscript = true;\n              break;\n\n            case \"superscript\":\n              name = \"textStyle\";\n              attributes.superscript = true;\n              break;\n          }\n\n          customObjArr.push({ name: name, attributes: attributes });\n        }\n      }\n      textString += text;\n      replaceLine(\n        globalJson,\n        \"id\",\n        line.attrs.line.attributes.id,\n        textString,\n        customObjArr\n      );\n    }\n  }\n  return globalJson;\n}\n\nexport function parseToXML(json) {\n  var options = {\n    compact: false,\n    ignoreComment: true,\n    spaces: 4,\n    sanitize: false,\n    attributesFn: reverseParseAttributeValue,\n  };\n  var result = json2xml(json, options);\n  return result;\n}\n\nexport function parseJsonContent(json) {\n  const result = jp.search(\n    json,\n    \"{ declaration: declaration,PcGts: elements[?name == 'PcGts'].{type: name,attributes: attributes,Page: elements[?name == 'Page'].{type: name,attributes: attributes,elements: elements[?name == 'TextRegion' || name == 'TableRegion'].{type: name,attributes: attributes,geometry: {coords: elements[?name == 'Coords'].attributes.points | [0]},elements: elements[?name == 'TextLine' || name == 'TableCell'].{type: name,attributes: attributes,geometry: {coords: elements[?name == 'Coords'].attributes.points | [0],baseline: elements[?name == 'Baseline'].attributes.points | [0]},elements: [elements[?name == 'TextEquiv' || name == 'TextLine'].{ elements:[elements[?name == 'Unicode' || name == 'TextEquiv'].[elements[?type == 'text' || name == 'Unicode']] | []], attributes : attributes, geometry: {coords: elements[?name == 'Coords'].attributes.points | [0]}}] | [] | [] | []} | []} } | [0]} | [0]}\"\n  );\n  return result.PcGts.Page;\n}\n\nexport function parsePageContent(xml, type = \"DEFAULT\") {\n  const js = xml2js(xml, XML2JS[type]);\n  var json = JSON.parse(JSON.stringify(js));\n  this.$store.dispatch(\"content/setXmlModel\", {\n    xmlModel: json,\n  });\n  const result = jp.search(\n    js,\n    \"{ declaration: declaration,PcGts: elements[?name == 'PcGts'].{type: name,attributes: attributes,Page: elements[?name == 'Page'].{type: name,attributes: attributes,elements: elements[?name == 'TextRegion' || name == 'TableRegion'].{type: name,attributes: attributes,geometry: {coords: elements[?name == 'Coords'].attributes.points | [0]},elements: elements[?name == 'TextLine' || name == 'TableCell'].{type: name,attributes: attributes,geometry: {coords: elements[?name == 'Coords'].attributes.points | [0],baseline: elements[?name == 'Baseline'].attributes.points | [0]},elements: [elements[?name == 'TextEquiv' || name == 'TextLine'].{ elements:[elements[?name == 'Unicode' || name == 'TextEquiv'].[elements[?type == 'text' || name == 'Unicode']] | []], attributes : attributes, geometry: {coords: elements[?name == 'Coords'].attributes.points | [0]}}] | [] | [] | []} | []} } | [0]} | [0]}\"\n  );\n  return result.PcGts.Page;\n}\n","import config from \"../config\";\nimport { parsePageContent } from \"./xml.js\";\nimport pkg from \"../../package.json\";\n\nconst fetch = require(\"node-fetch\");\n\nconst CONTENT = \"https://transkribus.eu/r/zQPlDb1ZvVWJuiBU/api/v0\";\n\nasync function logOut() {\n  const response = await this.$auth.loginWith(\"keycloak\");\n}\n\nexport function getImageSize(imageUrl) {\n  \n}\n\nexport async function fetchSearchResults(\n  { term, documents, titles, page, fuzziness },\n  { offset = 0, limit = 10 }\n) {\n  const res = await window.$nuxt.$axios(\n    \"https://transkribus.eu/r/search/search\",\n    {\n      method: \"POST\",\n      body: JSON.stringify({\n        term,\n        collections: [collection],\n        documents,\n        titles,\n        page,\n        fuzziness,\n        offset,\n        limit,\n      }),\n      headers: {\n        \"Content-Type\": CONTENT_TYPE,\n        Accept: CONTENT_TYPE,\n      },\n    }\n  );\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchSearchFacets({\n  term,\n  documents,\n  titles,\n  fuzziness,\n}) {\n  const res = await window.$nuxt.$axios(\n    \"https://transkribus.eu/r/search/facets\",\n    {\n      method: \"POST\",\n      body: JSON.stringify({\n        term,\n        collections: [collection],\n        documents,\n        titles,\n        fuzziness,\n      }),\n      headers: {\n        \"Content-Type\": CONTENT_TYPE,\n        Accept: CONTENT_TYPE,\n      },\n    }\n  );\n  const data = await res.json();\n  if (res.status === 401) {\n    logOut();\n  }\n  const { total, facets, params } = data;\n  return {\n    total,\n    facets,\n    params,\n  };\n}\n\nexport async function fetchSearchFulltext({ term, start, rows, filter }) {\n  const res = await window.$nuxt.$axios.get(\"/search/fulltext\", {\n    params: {\n      query: term,\n      type: \"LinesLc\",\n      start: start,\n      rows: rows,\n      filter: filter,\n    },\n  });\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function uploadImageJSON({ data, colId }) {\n  const res = await window.$nuxt.$axios(\"/uploads\", {\n    method: \"post\",\n    params: {\n      collId: colId,\n    },\n    data: data,\n  });\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function uploadImageData({ uploadId, formData }) {\n  const res = await window.$nuxt.$axios(\"/uploads/\" + uploadId, {\n    method: \"PUT\",\n    headers: {\n      \"Content-Type\": \"multipart/form-data\",\n    },\n    data: formData,\n    // onUploadProgress: e => {\n    //   // updating progress indicator\n    //   // progress(e.lengthComputable, e.loaded, e.total)\n    // }\n  });\n  if (res.status === 200) return res.data;\n  if (res.status === 401) return this.$auth.loginWith(\"keycloak\");\n  else throw new Error(res);\n}\n\nexport async function uploadPDFData({ collId, formData }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/createDocFromPdf\",\n    {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"multipart/form-data\",\n      },\n      data: formData,\n    }\n  );\n  if (res.status === 200) return res.data;\n  else throw new Error(res);\n}\n\nexport async function fetchCollections({ offset, limit }) {\n  const res = await window.$nuxt.$axios.get(\"/collections/list\", {\n    params: {\n      nValues: limit,\n      index: offset,\n    },\n  });\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchCollectionsForUser({ userid }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + userid + \"/listCols\",\n    {}\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchUsersForCollection({ collId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/userlist\",\n    {}\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\n// Get tag def from https://transkribus.eu/r/storage/collections/{colId}\n\nexport async function fetchStorageTagDef({ collId }) {\n  const res = await window.$nuxt.$axios\n    .get(\"https://transkribus.eu/r/storage/collections/\" + collId)\n    .catch(function (error) {\n      console.log(error);\n      throw new Error(res);\n    });\n\n  if (res.status === 200) {\n    return res.data;\n  }\n}\n\nexport async function saveStorageTagDef({ data, collId }) {\n  const res = await window.$nuxt.$axios.post(\n    \"https://transkribus.eu/r/storage/collections/\",\n    {\n      data: data,\n      id: collId,\n    },\n    {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  // if (res.status === 401) {\n  //   logOut()\n  // } else throw new Error(res)\n}\n\nexport async function fetchTagDef({ collId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/listTagDefs\",\n    {}\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function saveTagDef({ def, collId }) {\n  console.log(\"saveTagdef\");\n  console.log(def);\n  const json = JSON.stringify(def);\n  const res = await window.$nuxt.$axios.post(\n    \"/collections/\" + collId + \"/tagDefs\",\n    json,\n    {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function findUser({ mail, firstName, lastName }) {\n  const res = await window.$nuxt.$axios.get(\"/user/findUser\", {\n    params: {\n      user: mail,\n      firstName: firstName,\n      lastName: lastName,\n    },\n  });\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function addModifyUserCollection({ collId, userId, role }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/addOrModifyUserInCollection\",\n    {\n      method: \"POST\",\n      params: {\n        userid: userId,\n        role: role,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function removeUserCollection({ collId, userId }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/removeUserFromCollection\",\n    {\n      method: \"POST\",\n      params: {\n        userid: userId,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function deleteDocument({ collId, docId }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/\" + docId,\n    {\n      method: \"DELETE\",\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function removeDocumentCollection({ collId, docId }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/removeDocFromCollection\",\n    {\n      method: \"POST\",\n      params: {\n        id: docId,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function addDocumentCollection({ collId, docId }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/addDocToCollection\",\n    {\n      method: \"POST\",\n      params: {\n        id: docId,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function fetchCollectionsMeta({ collId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/metadata\",\n    {\n      params: {\n        stats: true,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchDocuments({ collId, offset, limit }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/list\",\n    {\n      params: {\n        nValues: limit,\n        index: offset,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchDocumentsMeta({ collId, docId, limit }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/\" + docId + \"/metadata\",\n    {\n      params: {\n        nrOfTranscripts: limit,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchPages({ collId, docId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/\" + docId + \"/fulldoc\",\n    {\n      params: {\n        nrOfTranscripts: 1,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchPagesString({ collId, docId, offset, limit }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/\" + docId + \"/pages\",\n    {\n      params: {\n        pages: offset + \"-\" + limit,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchPageContent({ id }) {\n  const res = await window.$nuxt.$axios.get(\n    config.searchApiBaseUrl + \"/content/\" + id,\n    {\n      method: \"GET\",\n    }\n  );\n  if (res.status === 200) return res.data.PcGts.Page;\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function fetchPageContentXML({ id }) {\n  const res = await fetch(`https://files.transkribus.eu/Get?id=${id}`, {\n    method: \"GET\",\n  });\n  const xml = await res.text();\n  //console.log(xml)\n  if (res.status === 200) {\n    return parsePageContent(xml);\n  }\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function setPageContentXML({\n  collId,\n  id,\n  page,\n  xml,\n  status,\n  parentTranscriptId,\n}) {\n  const res = await window.$nuxt.$axios(\n    `/collections/${collId}/${id}/${page}/text`,\n    {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"text/xml\" },\n      params: {\n        status: status,\n        // parent: parentTranscriptId,\n        toolName: \"TranskribusLite\" + pkg.version,\n      },\n      data: xml,\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function fetchContent(id) {\n  const res = await fetch(`${CONTENT}/content/${id}`);\n  if (res.status === 200) return res.json();\n  return null;\n}\n\nexport async function fetchImageMeta({ key }) {\n  const res = await window.$nuxt.$axios.get(\n    config.urls.image + \"/\" + key + \"/info.json\",\n    {}\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchFacets({ ...params } = {}) {\n  const res = await client.get(\"/facets\", { params: params });\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function fetchCounts({ type, ...params }) {\n  if (![\"scope\", \"year\"].includes(type)) {\n    console.error(`Unexpected type '${type}'`);\n    return null;\n  }\n\n  const res = await client.get(`/counts/${type}`, { params: params });\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function fetchItems({ path, offset, limit, ...others }) {\n  const res = await client.get(`/items`, {\n    params: {\n      path,\n      offset,\n      limit,\n      ...others,\n    },\n  });\n  if (res.status !== 200) throw new Error(res.status);\n  if (res.status === 401) {\n    logOut();\n  }\n  return res.data;\n}\n\nexport async function fetchScopeLabels({ scope, offset, limit, ...others }) {\n  const res = await client.get(`/levels`, {\n    params: {\n      scope,\n      offset,\n      limit,\n      ...others,\n    },\n  });\n  if (res.status === 200)\n    return res.data.map(({ value, count }) => ({\n      label: value,\n      count: count,\n    }));\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function fetchDocumentInfo({ id }) {\n  const res = await window.$nuxt.$axios.get(`/documents/${id}`);\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function fetchPageInfo({ collId, docId, pageNr }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/\" + docId + \"/\" + pageNr,\n    {}\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchPagesForDocument({ id, offset, limit }) {\n  const res = await client.get(\n    config.searchApiBaseUrl + `/documents/${id}/pages`,\n    {\n      params: {\n        offset,\n        limit,\n      },\n    }\n  );\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function getPublicModels() {\n  const res = await window.$nuxt.$axios.get(\n    \"https://readcoop.eu/wp-json/wp/v2/model\",\n    {\n      params: {\n        per_page: 100,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n}\n\nexport async function getHTRModels({ collId }) {\n  const res = await window.$nuxt.$axios.get(`/recognition/${collId}/list`);\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function startHTR({ collId, htrModelId, docId, pageString }) {\n  const res = await window.$nuxt.$axios(\n    \"/recognition/\" + collId + \"/\" + htrModelId + \"/htrCITlab\",\n    {\n      method: \"POST\",\n      params: {\n        id: docId,\n        pages: pageString,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function startPylaia({ collId, modelId, docId, pageString }) {\n  const res = await window.$nuxt.$axios(\n    \"/pylaia/\" + collId + \"/\" + modelId + \"/recognition\",\n    {\n      method: \"POST\",\n      params: {\n        id: docId,\n        pages: pageString,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function createCollection({ collName }) {\n  const res = await window.$nuxt.$axios(\"/collections/createCollection\", {\n    method: \"POST\",\n    params: {\n      collName: collName,\n    },\n  });\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchJob({ jobId }) {\n  const res = await window.$nuxt.$axios.get(\"/jobs/\" + jobId, {\n    params: {\n      nrOfTranscripts: 1,\n    },\n  });\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchCreditCost() {\n  const res = await window.$nuxt.$axios.get(\"/credits/costs\");\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchCreditCalculation({ collId, modelId, pages }) {\n  const res = await window.$nuxt.$axios(\n    \"/recognition/\" + collId + \"/\" + modelId + \"/costs\",\n    {\n      method: \"GET\",\n      params: {\n        nrOfPages: pages,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  // if (res.status === 401) {\n  //   logOut()\n  // } else throw new Error(res)\n}\n\nexport async function fetchCredits() {\n  const res = await window.$nuxt.$axios.get(\"/credits\");\n  if (res.status === 200) {\n    return res.data;\n  }\n  // if(res.status === 401) {\n  //   // logOut()\n  //   var noCredits = {overallBalance: 0}\n  //   return noCredits\n  // }\n  else throw new Error(res);\n}\n\nexport async function fetchCreditsCollection({ collId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/credits\"\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else throw new Error(res);\n}\n\nexport async function fetchCreditsAssigned({ packageId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/credits/\" + packageId + \"/collections\"\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else throw new Error(res);\n}\n\nexport async function fetchCreditsTransactions({ packageId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/credits/\" + packageId + \"/creditTransactions\"\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else throw new Error(res);\n}\n\nexport async function addCreditsCollection({ collId, packageId }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/credits/\" + packageId,\n    {\n      method: \"POST\",\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function removeCreditsCollection({ collId, packageId }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/credits/\" + packageId,\n    {\n      method: \"DELETE\",\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function splitCredits({ packageId, balance }) {\n  balance = parseFloat(balance);\n  const res = await window.$nuxt.$axios(\"/credits/\", {\n    method: \"POST\",\n    params: {\n      sourcePackageId: packageId,\n    },\n    data: {\n      balance,\n    },\n  });\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function fetchJobs({ offset, limit }) {\n  const res = await window.$nuxt.$axios.get(\"/jobs/list\", {\n    params: {\n      nValues: limit,\n      index: offset,\n      filterByUser: true,\n    },\n  });\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function getXML({ url }) {\n  const res = await window.$nuxt.$axios.get(url, {\n    headers: {\n      Accept: \"application/xml\",\n    },\n  });\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n","import {\n  fetchDocumentsMeta,\n  fetchPageInfo,\n  fetchSearchResults\n} from '@/utils/api.js'\n\nconst DEFAULT = {\n  // document\n  docId: null,\n  title: null,\n  colTitle: null,\n  maxPage: NaN,\n  documentInfo: null,\n  isDocumentReady: false,\n  isDocumentNotFoundError: false,\n  // page\n  pageId: null,\n  pageNum: NaN,\n  pageInfo: null,\n  pageContentId: null,\n  tsList: null,\n  tsKey: null,\n  // content: null,\n  image: null,\n  isPageReady: false,\n  isPageContentReady: false,\n  isPageNotFoundError: false,\n  isPageContentNotFoundError: false,\n  // search\n  term: '',\n  results: [],\n  // shared\n  requestCount: 0,\n  // view\n  view: 'both',\n  tagMode: 'hidetags',\n  changed: false\n}\n\nexport const state = () => Object.assign({}, DEFAULT)\n\nexport const getters = {\n  isLoading: (state, getters, rootState) =>\n    state.requestCount > 0 && state.content.isLoading === true,\n  hasResults: state => state.results.length > 0\n}\n\nexport const mutations = {\n  update(state, params) {\n    for (const key in params) {\n      if (state[key] !== params[key]) {\n        state[key] = params[key]\n        state.changed = true\n      }\n    }\n  },\n  beginRequest(state) {\n    state.requestCount += 1\n  },\n  endRequest(state) {\n    if (state.requestCount > 0) state.requestCount -= 1\n  }\n}\n\nexport const actions = {\n  update({ commit, state }, params = {}) {\n    const o = {}\n    for (const key in params) if (key in state) o[key] = params[key]\n    commit('update', o)\n  },\n  async fetch({ dispatch, state }, routeParams) {\n    dispatch('beginRequest')\n    // if (state.view !== view) await dispatch('update', { view })\n    if (routeParams.docid !== state.docId) {\n      // await dispatch('update', { documentId, pageNum, results: [] })\n      await dispatch('fetchDocumentInfo', {\n        collId: routeParams.collectionid,\n        docId: routeParams.docid\n      })\n      await dispatch('fetchPageInfo', {\n        collId: routeParams.collectionid,\n        docId: routeParams.docid,\n        pageNr: routeParams.pageid\n      })\n      //     if (term) {\n      // dispatch('update', { term })\n      // await dispatch('fetchSearchResults')\n      //     }\n    }\n    // else if (pageNum !== state.pageNum) {\n    else {\n      await dispatch('update', { pageNum, results: [] })\n      await dispatch('fetchPageInfo', {\n        collId: routeParams.collectionid,\n        docId: routeParams.docid,\n        pageNr: routeParams.pageid\n      })\n      if (term) {\n        dispatch('update', { term })\n        await dispatch('fetchSearchResults')\n      }\n    }\n    // else  if (term && state.term !== term) {\n    //   dispatch('update', { term })\n    //   await dispatch('fetchSearchResults')\n    // }\n    dispatch('endRequest')\n  },\n  beginRequest({ commit }) {\n    commit('beginRequest')\n  },\n  endRequest({ commit }) {\n    commit('endRequest')\n  },\n  async fetchDocumentInfo({ state, dispatch }, { collId, docId }) {\n    dispatch('beginRequest')\n    const data = await fetchDocumentsMeta({ collId: collId, docId: docId })\n\n    if (data === null) {\n      dispatch('update', {\n        isDocumentNotFoundError: true\n      })\n    } else {\n      const colTitle = data.collectionList.colList.find(\n        element => element.colId == collId\n      )\n      dispatch('update', {\n        docId: data.docId,\n        maxPage: data.nrOfPages,\n        isDocumentReady: true,\n        title: data.title,\n        colTitle: colTitle\n      })\n    }\n    dispatch('endRequest')\n  },\n  async fetchPageInfo({ state, dispatch }, { collId, docId, pageNr }) {\n    dispatch('beginRequest')\n    const data = await fetchPageInfo({\n      collId: collId,\n      docId: docId,\n      pageNr: pageNr\n    })\n    if (data === null)\n      dispatch('update', {\n        image: null,\n        isPageReady: false,\n        isPageNotFoundError: true\n      })\n    else {\n      let image = { id: data.key, width: data.width, height: data.height }\n      dispatch('update', {\n        ...data.id,\n        image: image,\n        pageNum: data.pageNr,\n        isPageReady: true,\n        tsList: data.tsList,\n        tsKey: data.tsList.transcripts[0].key\n      })\n      // dispatch('content/update', { id: data.content.id })\n      dispatch('fetchPageContent', { id: data.tsList.transcripts[0].key })\n    }\n    dispatch('endRequest')\n  },\n  async fetchPageContent({ state, dispatch }, { id }) {\n    dispatch('update', {\n      tsKey: id\n    })\n    await dispatch('content/fetch', { id })\n  },\n  async fetchSearchResults({ state, dispatch }) {\n    dispatch('beginRequest')\n    const data = await fetchSearchResults(\n      {\n        term: state.term,\n        page: state.pageId\n      },\n      { offset: 0, limit: 100 }\n    )\n\n    if (data === null) {\n      dispatch('update', { results: [] })\n    } else {\n      dispatch('update', {\n        results:\n          data.results.length === 0\n            ? Object.freeze([])\n            : Object.freeze(data.results[0].results)\n      })\n    }\n    dispatch('endRequest')\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions,\n  getters\n};","import deepEqual from 'fast-deep-equal'\nconst tags = require('../../assets/tag-config.json');\n\nexport const state = () => ({\n  docId: null,\n  title: null,\n  colTitle: null,\n  colRole: null,\n  collections: [],\n  tagDefs: tags,\n  documents: [],\n})\n\n\nexport const mutations = {\n  update(state, params) {\n    for (const key in params)\n      if (!deepEqual(state[key], params[key])) state[key] = params[key]\n  }\n}\n\nexport const actions = {\n  update({ commit }, params) {\n    commit('update', params)\n  },\n  setCollections({ dispatch, state }, { collections }) {\n    dispatch('update', { collections: collections })\n  },\n  setTagDefs({ dispatch, state }, { tagDefs }) {\n    dispatch('update', { tagDefs: tagDefs })\n  },\n  setDocuments({ dispatch, state }, { documents }) {\n    dispatch('update', { documents: documents })\n  },\n  setColTitle({ dispatch, state }, { colTitle }) {\n    dispatch('update', { colTitle: colTitle })\n  },\n  setColRole({ dispatch, state }, { colRole }) {\n    dispatch('update', { colRole: colRole })\n  }\n}\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions,\n};","import deepEqual from 'fast-deep-equal'\nimport { fetchPageContent, fetchPageContentXML } from '@/utils/api.js'\n\nexport const state = () => ({\n  id: null,\n  data: null,\n  selected: null,\n  selectedTag: null,\n  highlighted: null,\n  isError: false,\n  isReady: false,\n  isLoading: false,\n  xmlModel : null,\n  wasSaved: false,\n  wasEdited: false,\n  editLayoutHorizontal: true\n})\n\nexport const mutations = {\n  update(state, params) {\n    for (const key in params)\n      if (!deepEqual(state[key], params[key])) state[key] = params[key]\n  }\n}\n\nexport const actions = {\n  update({ commit }, params) {\n    commit('update', params)\n  },\n  reset({ dispatch }) {\n    dispatch('update', {\n      id: null,\n      data: null,\n      selected: null,\n      selectedTag: null,\n      highlighted: null,\n      isError: false,\n      isready: false,\n      isLoading: false,\n      xmlModel : null,\n      wasSaved: false,\n      wasEdited: false,\n      editLayoutHorizontal: true\n    })\n  },\n  select({ dispatch, state }, { origin, target }) {\n    dispatch('update', { selected: { origin, target } })\n  },\n  highlight({ dispatch, state }, { origin, target }) {\n    dispatch('update', { highlighted: { origin, target } })\n  },\n  setSelectedTag({ dispatch, state }, { selectedTag }) {\n    dispatch('update', { selectedTag: selectedTag })\n  },\n  setXmlModel({ dispatch, state }, { xmlModel }) {\n    dispatch('update', { xmlModel: xmlModel })\n  },\n  async fetch({ state, dispatch }, id) {\n    // if (id) dispatch('update', { id })\n    dispatch('update', { isLoading: true, isReady: false })\n    await dispatch('fetchPageContent', id)\n    dispatch('update', { isLoading: false, isReady: true })\n  },\n  async fetchPageContent({ state, dispatch }, id) {\n    if (id) dispatch('update', { id })\n    const data = await fetchPageContentXML(id)\n    if (data === null) dispatch('update', { data: null, isError: true })\n    else {\n      dispatch('update', {\n        data: Object.freeze(data),\n        isError: false\n      })\n    }\n  },\n  findElementById({ state }, id) {\n    const node = state.data\n    const stack = [node]\n    while (stack.length) {\n      const node = stack.pop()\n      if (node.elements) node.elements.forEach(node => stack.push(node))\n      if (node.attributes && node.attributes.id === id) return node\n    }\n    return null\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n};","import Vue from \"vue\";\nimport Vuex from \"vuex\";\n\nimport detail from \"./detail\";\nimport browse from \"./browse\";\nimport content from \"./content\";\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n  modules: {\n    browse,\n    detail,\n    content,\n  },\n  strict: process.env.NODE_ENV !== \"production\",\n  // plugins: debug ? [createLogger()] : []\n});\n","import { Node, mergeAttributes } from \"@tiptap/core\";\nimport { VueNodeViewRenderer } from \"@tiptap/vue-2\";\nimport Component from \"./LineNode.vue\";\nimport { TextSelection } from \"prosemirror-state\";\nimport { Plugin, PluginKey } from \"prosemirror-state\";\nimport store from \"@/store\";\n\nexport default Node.create({\n  name: \"line\",\n\n  group: \"block+\",\n\n  // content: '(inline* | tag*)',\n  content: \"inline* \",\n  addAttributes() {\n    return {\n      line: {\n        default: [],\n      },\n    };\n  },\n  addProseMirrorPlugins() {\n    return [\n      new Plugin({\n        props: {\n          handleKeyDown: (view, event) => {\n            if (event.which === 8 || event.which === 46) {\n              view.state.deleting = true;\n            }\n\n            return false;\n          },\n        },\n\n        filterTransaction: (transaction, state) => {\n          var isDeleting = state.deleting;\n\n          if (!state.deleting) {\n            return true;\n          }\n\n          var result = true;\n\n          transaction.mapping.maps.forEach((map) => {\n            map.forEach((oldStart, oldEnd, newStart, newEnd) => {\n              state.doc.nodesBetween(\n                oldStart,\n                oldEnd,\n                (node, number, pos, parent, index) => {\n                  if (node.type.name === \"line\") {\n                    result = false;\n                  }\n                }\n              );\n            });\n          });\n\n          return result;\n        },\n      }),\n    ];\n  },\n  addKeyboardShortcuts() {\n    return {\n      Enter: (state, dispatch, view) => {\n        this.editor.commands.selectParentNode();\n        var selection = this.editor.view.state.selection;\n        var node = this.editor.view.state.doc.nodeAt(selection.$head.pos);\n        this.editor.chain().selectNodeForward();\n        if (node) {\n          if (node.attrs.line) {\n            this.editor.commands.setTextSelection(\n              this.editor.state.selection.$head.pos + node.content.size + 1\n            );\n            var lineId = node.attrs.line.attributes.id;\n            const el = document.getElementById(lineId);\n            el.scrollIntoView({ behavior: \"smooth\" });\n            store.dispatch(\"content/select\", {\n              target: lineId,\n              origin: \"content\",\n            });\n          }\n        }\n\n        return true;\n      },\n      ArrowDown: (state, dispatch, view) => {\n        console.log(store);\n        this.editor.commands.selectParentNode();\n        var selection = this.editor.view.state.selection;\n        var node = this.editor.view.state.doc.nodeAt(selection.$head.pos);\n        if (node && node.attrs.line) {\n          store.dispatch(\"content/select\", {\n            target: node.attrs.line.attributes.id,\n            origin: \"content\",\n          });\n        }\n      },\n      ArrowUp: (state, dispatch, view) => {\n        this.editor.commands.selectParentNode();\n        var selection = this.editor.view.state.selection;\n        var node = this.editor.view.state.doc.nodeAt(selection.$head.pos);\n        if (node && node.attrs.line) {\n          store.dispatch(\"content/select\", {\n            target: node.attrs.line.attributes.id,\n            origin: \"content\",\n          });\n        }\n      },\n    };\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: \"div\",\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\"div\", mergeAttributes(HTMLAttributes)];\n  },\n\n  addNodeView() {\n    return VueNodeViewRenderer(Component);\n  },\n});\n","import Highlight from \"@tiptap/extension-highlight\";\n\nimport { Node, mergeAttributes } from \"@tiptap/core\";\n\nexport async function tagExtensions(tagDefs) {\n  var tagExtensionArr = [];\n  for (var tagIndex in tagDefs) {\n    var tag = tagDefs[tagIndex];\n    var tempExtension = Highlight.extend({\n      name: tag.name,\n      addKeyboardShortcuts() {\n        return {\n          \"Mod-l\": () => this.editor.commands.toggleBulletList(),\n        };\n      },\n      addCommands() {\n        return {\n          setTag:\n            () =>\n            ({ commands }) => {\n              return commands.setMark(tag.name);\n            },\n          toggleTag:\n            (attributes) =>\n            ({ commands, tr, state, dispatch }) => {\n              return commands.toggleMark(attributes.name, attributes);\n            },\n          unsetTag:\n            () =>\n            ({ commands }) => {\n              return commands.unsetMark(tag.name);\n            },\n        };\n      },\n      addAttributes() {\n        // Return an object with attribute configuration\n        return {\n          tag: {\n            default: {},\n          },\n          annotationId: {\n            default: null,\n          },\n          color: {\n            default: tag.color,\n            parseHTML: (element) => {\n              return [\n                {\n                  color:\n                    element.getAttribute(\"data-color\") ||\n                    element.style.backgroundColor,\n                },\n                {\n                  tag: tag.name,\n                },\n              ];\n            },\n            renderHTML: (attributes) => {\n              if (!attributes.color) {\n                return {};\n              }\n\n              return {\n                \"data-color\": attributes.color,\n                style: `outline-color: ${attributes.color} !important; outline: 2px solid;`,\n                class: \"tag\",\n              };\n            },\n          },\n        };\n      },\n      // parseHTML() {\n      //   return [{ tag: 'a[href]' }]\n      // },\n\n      renderHTML({ HTMLAttributes }) {\n        return [\n          \"a\",\n          mergeAttributes(this.options.HTMLAttributes, HTMLAttributes),\n          0,\n        ];\n      },\n    });\n    tagExtensionArr.push(tempExtension);\n  }\n\n  return tagExtensionArr;\n}\n","import {\n  Command,\n  Mark,\n  markInputRule,\n  markPasteRule,\n  mergeAttributes,\n} from \"@tiptap/core\";\n\nexport const Subscript = Mark.create({\n  name: \"subscript\",\n\n  defaultOptions: {\n    HTMLAttributes: {},\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: \"subscript\",\n      },\n      {\n        tag: \"del\",\n      },\n      {\n        tag: \"subscript\",\n      },\n      {\n        style: \"text-decoration\",\n        consuming: false,\n        getAttrs: (style) => (style.includes(\"line-through\") ? {} : false),\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\n      \"sub\",\n      mergeAttributes(this.options.HTMLAttributes, HTMLAttributes),\n      0,\n    ];\n  },\n\n  addCommands() {\n    return {\n      setSub:\n        () =>\n        ({ commands }) => {\n          return commands.setMark(\"subscript\");\n        },\n      toggleSub:\n        () =>\n        ({ commands }) => {\n          return commands.toggleMark(\"subscript\");\n        },\n      unsetSub:\n        () =>\n        ({ commands }) => {\n          return commands.unsetMark(\"subscript\");\n        },\n    };\n  },\n});\n","import {\n  Command,\n  Mark,\n  markInputRule,\n  markPasteRule,\n  mergeAttributes,\n} from \"@tiptap/core\";\n\nexport const Superscript = Mark.create({\n  name: \"superscript\",\n\n  defaultOptions: {\n    HTMLAttributes: {},\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: \"superscript\",\n      },\n      {\n        tag: \"del\",\n      },\n      {\n        tag: \"superscript\",\n      },\n      {\n        style: \"text-decoration\",\n        consuming: false,\n        getAttrs: (style) => (style.includes(\"line-through\") ? {} : false),\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\n      \"sup\",\n      mergeAttributes(this.options.HTMLAttributes, HTMLAttributes),\n      0,\n    ];\n  },\n\n  addCommands() {\n    return {\n      setSuper:\n        () =>\n        ({ commands }) => {\n          return commands.setMark(\"superscript\");\n        },\n      toggleSuper:\n        () =>\n        ({ commands }) => {\n          return commands.toggleMark(\"superscript\");\n        },\n      unsetSuper:\n        () =>\n        ({ commands }) => {\n          return commands.unsetMark(\"superscript\");\n        },\n    };\n  },\n});\n","<template>\n  <div\n    class=\"editor\"\n    v-if=\"editor\"\n    \n  >\n    <b-loading v-model=\"isLoading\" :active=\"isLoading\" :is-full-page=\"false\" />\n    <div class=\"editor__header\" v-if=\"editor\">\n      <b-navbar style=\"width: 100%; overflow: auto\">\n        <template #start>\n          <b-navbar-item>\n            <b-switch v-model=\"isAnnotation\"> Annotation </b-switch>\n          </b-navbar-item>\n        </template>\n\n        <template #end>\n          <b-navbar-item>\n            <b-button\n              title=\"Increase font size\"\n              icon-left=\"plus\"\n              @click=\"setFontSize(0.1)\"\n            >\n            </b-button>\n            <b-button\n              title=\"Decrease font size\"\n              icon-left=\"minus\"\n              @click=\"setFontSize(-0.1)\"\n            >\n            </b-button>\n          </b-navbar-item>\n          <b-navbar-item>\n            <b-button\n              title=\"Switch view\"\n              :icon-left=\"layoutIcon()\"\n              @click=\"setEditLayout\"\n            >\n            </b-button>\n\n            <b-button\n              title=\"Undo\"\n              icon-left=\"undo\"\n              @click=\"editor.chain().focus().undo().run()\"\n            >\n            </b-button>\n            <b-button\n              title=\"Redo\"\n              icon-left=\"redo\"\n              @click=\"editor.chain().focus().redo().run()\"\n            >\n            </b-button>\n          </b-navbar-item>\n          <b-navbar-item>\n            <b-field>\n              <b-button @click=\"saveContent\" icon-left=\"save\" type=\"is-success\">\n                Save\n              </b-button>\n            </b-field>\n          </b-navbar-item>\n          <!-- <b-navbar-item>\n            <b-button\n              title=\"Advanced\"\n              type=\"is-light\"\n              icon-left=\"toolbox\"\n              @click=\"openAdvancedModal\"\n            />\n          </b-navbar-item> -->\n        </template>\n      </b-navbar>\n    </div>\n    <div class=\"tile editor__content\">\n      <div v-if=\"isAnnotation\" class=\"tile is-parent is-vertical is-3\">\n        <div v-if=\"selectedTag\" class=\"tile is-child box\">\n          <div>\n            <div\n              class=\"tile is-vertical\"\n              style=\"width: 100%\"\n              v-for=\"(tempTag, index) in selectedTag.marks\"\n              :key=\"index\"\n            >\n              <div class=\"tile is-child\" v-if=\"tempTag.attrs.tag\">\n                <b-tag\n                  :style=\"`outline-color: ${tempTag.attrs.color} !important; outline: 2px solid; color : ${tempTag.attrs.color} !important;margin-top: auto;margin-bottom: auto;`\"\n                  icon-left=\"tag\"\n                >\n                  {{ tempTag.attrs.tag.name }}\n                </b-tag>\n              </div>\n              <div\n                class=\"tile is-child\"\n                v-for=\"(attribute, i) in findTagAttributes(tempTag)\"\n                :key=\"i\"\n              >\n                <b-field\n                  v-if=\"tempTag.attrs.tag\"\n                  :label=\"attribute\"\n                  label-position=\"on-border\"\n                >\n                  <b-input\n                    @input=\"\n                      changeContinued(\n                        tempTag,\n                        tempTag.attrs.tag.attributes[attribute],\n                        attribute\n                      )\n                    \"\n                    v-model=\"tempTag.attrs.tag.attributes[attribute]\"\n                  ></b-input>\n                </b-field>\n              </div>\n              <div class=\"tile is-child\" v-if=\"tempTag.attrs.tag\">\n                <b-button\n                  type=\"is-danger\"\n                  icon-left=\"trash\"\n                  @click=\"setAttributes(tempTag)\"\n                >\n                  Delete\n                </b-button>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"tile is-child box\">\n          <div\n            class=\"transkribusEditor-bubble-menu\"\n            style=\"text-align: center\"\n            v-if=\"editor && isAnnotation && tagDefs\"\n          >\n            <b-button\n              title=\"Bold\"\n              type=\"is-primary\"\n              icon-left=\"bold\"\n              @click=\"editor.chain().focus().toggleBold().run()\"\n              :class=\"{ 'is-active': editor.isActive('bold') }\"\n            >\n            </b-button>\n            <b-button\n              title=\"Strike\"\n              type=\"is-primary\"\n              icon-left=\"strikethrough\"\n              @click=\"editor.chain().focus().toggleStrike().run()\"\n              :class=\"{ 'is-active': editor.isActive('strike') }\"\n            >\n            </b-button>\n            <b-button\n              title=\"Underline\"\n              type=\"is-primary\"\n              icon-left=\"underline\"\n              @click=\"editor.chain().focus().toggleUnderline().run()\"\n              :class=\"{ 'is-active': editor.isActive('underline') }\"\n            >\n            </b-button>\n            <b-button\n              title=\"Subscript\"\n              type=\"is-primary\"\n              icon-left=\"subscript\"\n              @click=\"editor.chain().focus().toggleSub().run()\"\n              :class=\"{ 'is-active': editor.isActive('subscript') }\"\n            >\n            </b-button>\n            <b-button\n              title=\"Superscript\"\n              type=\"is-primary\"\n              icon-left=\"superscript\"\n              @click=\"editor.chain().focus().toggleSuper().run()\"\n              :class=\"{ 'is-active': editor.isActive('superscript') }\"\n            >\n            </b-button>\n            <br />\n            <b-button\n              v-for=\"(tag, index) in tagDefs.definitions.annotations\"\n              :key=\"index\"\n              icon-left=\"tag\"\n              :style=\"'background-color:' + tag.color\"\n              @click=\"setAttributes(tag)\"\n              :class=\"{\n                'is-active': editor.isActive(tag.name, {\n                  color: tag.color,\n                }),\n              }\"\n            >\n              {{ tag.label }}\n            </b-button>\n          </div>\n        </div>\n      </div>\n      <div class=\"tile is-parent box\">\n        <editor-content\n          class=\"editor__content\"\n          v-bind:style=\"{ fontSize: fontSize + 'rem' }\"\n          :editor=\"editor\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n//  http://localhost:5000/collection/62267/doc/425931/detail/1?view=edit\n// http://localhost:5000/collection/100402/doc/512221/detail/2\n//  http://localhost:5000/collection/100402/doc/642576/detail/3\n\n//TODO adding continued tag and set attributes to continued tags\nimport {\n  generateHTML,\n  Editor,\n  EditorContent,\n  NodeViewWrapper,\n  NodeViewContent,\n  BubbleMenu,\n} from \"@tiptap/vue-2\";\nimport { defaultExtensions } from \"@tiptap/starter-kit\";\nimport TextAlign from \"@tiptap/extension-text-align\";\nimport Focus from \"@tiptap/extension-focus\";\nimport Text from \"@tiptap/extension-text\";\nimport Region from \"../Editor/RegionExtension.js\";\nimport Line from \"../Editor/LineExtension.js\";\nimport Table from \"@tiptap/extension-table\";\nimport TableRow from \"@tiptap/extension-table-row\";\nimport TableCell from \"@tiptap/extension-table-cell\";\nimport TableHeader from \"@tiptap/extension-table-header\";\nimport Underline from \"@tiptap/extension-underline\";\nimport { tagExtensions } from \"../Editor/TagExtension.js\";\n\nimport { Subscript } from \"../Editor/SubscriptExtension.js\";\nimport { Superscript } from \"../Editor/SuperscriptExtension.js\";\n\nimport { NodeSelection } from \"prosemirror-state\";\nimport { Plugin, PluginKey } from \"prosemirror-state\";\n\nimport { mapState } from \"vuex\";\n\nimport { fetchTagDef, setPageContentXML } from \"../../utils/api.js\";\n\nimport { parseToXML, parseEditorOutput } from \"../../utils/xml.js\";\n\nvar groupBy = require(\"json-groupby\");\n\nexport default {\n  filters: {\n    text(item) {\n      return item.elements && item.elements[0] ? item.elements[0].text : \"\";\n    },\n    clean(s) {\n      if (typeof s !== \"string\") return \"\";\n      return s.trim().replace(/¬$/, \"\\u2010\");\n    },\n  },\n  watch: {\n    selected: {\n      handler: function (newValue, oldValue) {\n        if (newValue === null || newValue === oldValue) return;\n        if (newValue.origin === \"image\") {\n          var lineId = newValue.target;\n          var content = this.editor.state.doc.content.content;\n          this.editor.chain().focus();\n          var nodes = this.editor.view.docView.node;\n\n          nodes.descendants((node, pos) => {\n            if (node.attrs.line) {\n              if (node.attrs.line.attributes.id === lineId) {\n                var tr = this.editor.state.tr;\n                const transaction = tr.setSelection(\n                  NodeSelection.create(tr.doc, pos)\n                );\n                this.editor.view.dispatch(transaction);\n                const el = document.getElementById(lineId);\n                el.scrollIntoView({ behavior: \"smooth\" });\n              }\n            }\n          });\n        }\n      },\n      deep: true,\n    },\n    tagDefs: {\n      handler: function (newValue, oldValue) {\n        console.log(\"tagdef changed\");\n        this.setup()\n      },\n      deep: true,\n    },\n  },\n  components: {\n    TextAlign,\n    EditorContent,\n    BubbleMenu,\n  },\n  props: {\n    xmlJson: {\n      type: Object,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      editorContentJson: {},\n      editor: null,\n      isAnnotation: false,\n      selectedTag: null,\n      status: \"IN_PROGRESS\",\n      isLoading: false,\n      annotationCounter: 0,\n      lastTag: {},\n      fontSize: 1,\n    };\n  },\n  computed: {\n    ...mapState(\"content\", [\n      \"data\",\n      \"selected\",\n      \"highlighted\",\n      \"isReady\",\n      \"xmlModel\",\n      \"wasSaved\",\n      \"wasEdited\",\n      \"editLayoutHorizontal\",\n    ]),\n    ...mapState(\"detail\", [\"tagMode\", \"tsKey\"]),\n    ...mapState(\"browse\", [\"tagDefs\"]),\n    hasContent() {\n      return this.content.elements.length !== 0;\n    },\n    contentData() {\n      if (!this.xmlJson || !this.xmlJson.elements) return { elements: [] };\n      else {\n        for (var element in this.xmlJson.elements) {\n          var temp = this.xmlJson.elements[element];\n          for (var line in temp.elements) {\n            var linetemp = temp.elements[line];\n\n            if (linetemp.type == \"TextLine\") {\n              linetemp.hasTag = this.hasTag(linetemp.attributes.custom);\n              linetemp.tags = this.getTags(linetemp.attributes.custom);\n            } else if (linetemp.type == \"TableCell\" && linetemp.elements[0]) {\n              linetemp.hasTag = this.hasTag(\n                linetemp.elements[0].attributes.custom\n              );\n              linetemp.tags = this.getTags(\n                linetemp.elements[0].attributes.custom\n              );\n            }\n          }\n        }\n\n        return this.xmlJson;\n      }\n    },\n  },\n  async mounted() {\n    this.setup();\n  },\n  methods: {\n    async setup() {\n      console.log(this.tagDefs);\n      var tagArray = await tagExtensions(this.tagDefs.definitions.annotations);\n      console.log(tagArray);\n      var that = this;\n      this.editor = new Editor({\n        content: \"\",\n        extensions: [\n          Text,\n          Region,\n          Line,\n          ...defaultExtensions(),\n          ...tagArray,\n          Focus.configure({\n            className: \"is-selected\",\n            nested: true,\n          }),\n          Underline,\n          Table,\n          TableRow,\n          TableHeader,\n          TableCell,\n          Subscript,\n          Superscript,\n        ],\n        onSelectionUpdate({ editor }) {\n          var selectedLine = editor.getAttributes(\"line\");\n          var head = editor.view.state.selection.$head.pos;\n          var anchor = editor.view.state.selection.$anchor.pos;\n          var node = editor.view.state.doc.nodeAt(head);\n          if (node && anchor == head) {\n            var marks = node.marks;\n            if (marks.length > 0) {\n              that.selectedTag = node;\n            } else {\n              that.selectedTag = null;\n            }\n          } else {\n            that.selectedTag = null;\n          }\n        },\n        onUpdate({ editor }) {\n          that.$store.dispatch(\"content/update\", { wasEdited: true });\n        },\n      });\n      this.setEditorContentJSON();\n    },\n    select(id) {\n      this.$store.dispatch(\"content/select\", {\n        target: id,\n        origin: \"content\",\n      });\n    },\n    setEditLayout() {\n      this.$store.dispatch(\"content/update\", {\n        editLayoutHorizontal: !this.editLayoutHorizontal,\n      });\n    },\n    layoutIcon() {\n      if (this.editLayoutHorizontal) {\n        return \"columns\";\n      }\n      return \"bars\";\n    },\n    changeContinued(tag, value, attribute) {\n      if (tag.attrs.tag.attributes.continued) {\n        var continuedTags = this.findMarkByUid(0, 1000, tag.attrs.annotationId);\n        for (var index in continuedTags) {\n          var tempTag = continuedTags[index];\n          tempTag.attrs.tag.attributes[attribute] = value;\n        }\n      }\n    },\n    setFontSize(value) {\n      this.fontSize += value;\n    },\n    findMarkByUid(from, to, uid) {\n      const { doc } = this.editor.state;\n      let found = [];\n      doc.nodesBetween(from, to, (node) => {\n        found.push(\n          node.marks.find((mark) => mark.attrs[\"annotationId\"] === uid)\n        );\n      });\n      return found.filter(Boolean);\n    },\n    findTagAttributes(tag) {\n      var found = {};\n      found = this.tagDefs.definitions.annotations.find(\n        (element) => element.name === tag.type.name\n      );\n      if (found) {\n        return found.attributes;\n      } else {\n        return found;\n      }\n    },\n\n    async saveContent() {\n      const json = this.editor.getJSON();\n      var js = JSON.parse(JSON.stringify(json));\n\n      var modelCopy = JSON.parse(JSON.stringify(this.xmlModel));\n\n      var parsedResult = parseEditorOutput(js, modelCopy);\n      console.log(parsedResult);\n      var xmlResult = parseToXML(parsedResult);\n      console.log(xmlResult);\n      var output = { xml: xmlResult, xmlJson: parsedResult };\n      this.$root.$emit(\"save\", output);\n    },\n    setAttributes(tag) {\n      var attributes = {};\n      var contentObj = this.editor.state.selection.content();\n\n      if (\n        contentObj.content.content[0] &&\n        contentObj.content.content[0].content.content.length > 1\n      ) {\n        attributes = { continued: true };\n      }\n      var tagObj;\n      var tagName;\n      var tagColor;\n      if (tag.name) {\n        tagObj = { name: tag.name, attributes: attributes };\n        tagName = tag.name;\n        tagColor = tag.color;\n      } else {\n        tagName = tag.attrs.tag.name;\n        tagColor = tag.attrs.color;\n        tagObj = { name: tagName, attributes: attributes };\n      }\n      this.editor\n        .chain()\n        .focus()\n        .toggleTag({ color: tagColor, tag: tagObj, name: tagName })\n        .run();\n\n      var selectedLine = this.editor.getAttributes(\"line\");\n      var anchor = this.editor.state.selection.$anchor.pos;\n      var node = this.editor.state.doc.nodeAt(anchor);\n      if (node && node.marks) {\n        var marks = node.marks;\n        if (marks.length > 0) {\n          this.selectedTag = node;\n        } else {\n          this.selectedTag = null;\n        }\n      } else {\n        this.selectedTag = null;\n      }\n    },\n    openToast(message, type) {\n      this.$buefy.toast.open({\n        duration: 4000,\n        message: message,\n        position: \"is-top\",\n        type: type,\n      });\n    },\n    async loadTagDefs() {\n      let data;\n      try {\n        data = await fetchTagDef({\n          collId: this.$route.params.collectionid,\n        });\n      } catch (err) {\n        console.log(err);\n      }\n      this.$store.dispatch(\"browse/setTagDefs\", { tagDefs: data });\n    },\n    groupByRow(table) {\n      var result = groupBy(table, [\"attributes.row\"]);\n      return result;\n    },\n    getTagDef(tag) {\n      if (tag) {\n        var found = this.tagDefs.definitions.annotations.find(\n          (x) => x.name === tag.name\n        );\n      }\n\n      return found;\n    },\n    beforeDestroy() {\n      if (this.editor) {\n        this.editor.destroy();\n      }\n    },\n    setEditorContentJSON() {\n      let editorContent = {\n        type: \"doc\",\n        content: [],\n      };\n      if (!this.contentData || !this.contentData.elements)\n        return { elements: [] };\n      else {\n        for (var element in this.contentData.elements) {\n          var temp = this.contentData.elements[element];\n          var content = [];\n          if (temp.type == \"TextRegion\") {\n            for (var line in temp.elements) {\n              var linetemp = temp.elements[line];\n              if (linetemp.type == \"TextLine\") {\n                if (linetemp.elements[0]) {\n                  var id = linetemp.attributes.id;\n                  var text = \" \";\n                  if (\n                    linetemp.elements[0].elements[0][0] &&\n                    linetemp.elements[0].elements[0][0][0]\n                  ) {\n                    text = linetemp.elements[0].elements[0][0][0].text;\n                  }\n                  if (linetemp.hasTag) {\n                    var tagContent = this.setTagContent(linetemp, text, false);\n                    content.push({\n                      type: \"line\",\n                      attrs: {\n                        line: linetemp,\n                      },\n                      content: tagContent,\n                    });\n                  } else {\n                    content.push({\n                      type: \"line\",\n                      attrs: {\n                        line: linetemp,\n                      },\n                      content: [\n                        {\n                          type: \"text\",\n                          text: text,\n                        },\n                      ],\n                    });\n                  }\n                }\n              }\n            }\n            editorContent.content.push({\n              type: \"region\",\n              attrs: {\n                lines: temp,\n              },\n              content: content,\n            });\n          } else if (temp.type == \"TableRegion\") {\n            var groupedRows = this.groupByRow(temp.elements);\n            var rowContent = [];\n            for (var row in groupedRows) {\n              var cellContent = [];\n              var rowtemp = groupedRows[row];\n              for (var cell in rowtemp) {\n                var celltemp = rowtemp[cell];\n                var text = \" \";\n                var lineObjects = [];\n                for (line in celltemp.elements) {\n                  var linetemp = celltemp.elements[line];\n                  if (linetemp && linetemp.elements[0][0][0].elements[0]) {\n                    text = linetemp.elements[0][0][0].elements[0].text;\n                  }\n                  var lineContent = [];\n                  if (celltemp.hasTag) {\n                    lineContent = this.setTagContent(celltemp, text, true);\n                  } else {\n                    lineContent.push({\n                      type: \"text\",\n                      text: text,\n                    });\n                  }\n                  var lineObj = {\n                    type: \"line\",\n                    attrs: {\n                      line: linetemp,\n                    },\n                    content: lineContent,\n                  };\n                  lineObjects.push(lineObj);\n                }\n                cellContent.push({\n                  type: \"tableCell\",\n                  content: lineObjects,\n                });\n              }\n              rowContent.push({\n                type: \"tableRow\",\n                content: cellContent,\n              });\n            }\n            var regionObj = {\n              type: \"region\",\n              content: rowContent,\n            };\n\n            editorContent.content.push({\n              type: \"table\",\n              content: [regionObj],\n            });\n          }\n        }\n        this.editorContentJson = editorContent;\n        this.editor.commands.setContent(editorContent);\n      }\n    },\n    getTags(attributes) {\n      var tags = [];\n      for (var i = 0; i < attributes.length; i++) {\n        if (\n          \"offset\" in attributes[i].attributes &&\n          \"length\" in attributes[i].attributes\n        ) {\n          tags.push(attributes[i]);\n        }\n      }\n      return tags;\n    },\n    hasTag(attributes) {\n      for (var i = 0; i < attributes.length; i++) {\n        if (\n          \"offset\" in attributes[i].attributes &&\n          \"length\" in attributes[i].attributes\n        ) {\n          return true;\n        }\n      }\n      return false;\n    },\n    setTagContent(linetemp, text, table) {\n      var tagContent = [];\n      var arrText = this.stringOffset(text, linetemp.tags);\n      for (var split in arrText) {\n        var marks = [];\n        var text = \" \";\n        if (!arrText[split] == \"\") {\n          text = arrText[split];\n        }\n        var offset = 0;\n        for (var i = 0; i < split; i++) {\n          offset += arrText[i].length;\n        }\n        var tags = this.findTags(linetemp, text, table, offset);\n        if (tags.length > 0) {\n          for (var tagTemp in tags) {\n            var tag = tags[tagTemp];\n            if (tag.name == \"textStyle\") {\n              var textStyles = this.setTextStyles(tag);\n              for (var index in textStyles) {\n                var textStyle = textStyles[index];\n                marks.push(textStyle);\n              }\n            }\n            var tagDef = this.getTagDef(tag);\n            var color = \"#ffff\";\n            var name = \"mark\";\n            if (tagDef) {\n              color = tagDef.color;\n              name = tagDef.name;\n              if (\n                !tag.attributes.continued ||\n                this.lastTag.name !== name ||\n                this.lastTag.continued !== tag.attributes.continued\n              ) {\n                this.annotationCounter++;\n              }\n              var tagMark = {\n                type: name,\n                attrs: {\n                  color: color,\n                  tag: tag,\n                  annotationId: this.annotationCounter,\n                },\n              };\n              this.lastTag = {\n                name: tag.name,\n                lineId: linetemp.attributes.id,\n                tag: tag,\n                continued: tag.attributes.continued,\n              };\n              marks.push(tagMark);\n            }\n          }\n          var obj = {\n            type: \"text\",\n            marks: marks,\n            text: text,\n          };\n          tagContent.push(obj);\n        } else {\n          var obj = {\n            type: \"text\",\n            marks: marks,\n            text: text,\n          };\n          tagContent.push(obj);\n        }\n      }\n      return tagContent;\n    },\n    setTextStyles(tag) {\n      var name = [];\n      if (tag.attributes.strikethrough) {\n        name.push(\"strike\");\n      }\n      if (tag.attributes.subscript) {\n        name.push(\"subscript\");\n      }\n      if (tag.attributes.superscript) {\n        name.push(\"superscript\");\n      }\n      if (tag.attributes.underlined) {\n        name.push(\"underline\");\n      }\n      if (tag.attributes.bold) {\n        name.push(\"bold\");\n      }\n      var textStyleArr = [];\n      for (var i = 0; i < name.length; i++) {\n        textStyleArr.push({\n          type: name[i],\n        });\n      }\n      return textStyleArr;\n    },\n    stringOffset(str, tags) {\n      if (!tags.length) return [];\n\n      const results = [],\n        indexes = [];\n\n      tags.forEach((options) => {\n        indexes.push(\n          options.attributes.offset,\n          options.attributes.offset + options.attributes.length\n        );\n      });\n\n      indexes.sort((i1, i2) => i1 - i2);\n\n      if (indexes.indexOf(0) < 0) indexes.unshift(0);\n\n      if (indexes[indexes.length - 1] < str.length) indexes.push(str.length);\n\n      for (let i = 0, len = indexes.length; i < len - 1; i++) {\n        results.push(str.substring(indexes[i], indexes[i + 1]));\n      }\n\n      return results;\n    },\n    findTags(element, text, table, offset) {\n      var lineText;\n      if (table) {\n        lineText = element.elements[0].elements[0][0][0].elements[0].text;\n      } else {\n        lineText = element.elements[0].elements[0][0][0].text;\n      }\n      if (text == \" \") {\n        return [];\n      }\n      var index = lineText.indexOf(text);\n      return element.tags.filter((x) => {\n        var tagtext = lineText.substr(x.attributes.offset, x.attributes.length);\n        if (\n          tagtext.includes(text) &&\n          offset >= x.attributes.offset &&\n          offset <= x.attributes.offset + x.attributes.length\n        ) {\n          return x;\n        }\n      });\n    },\n    textStyleClass(label) {\n      var classString = \"\";\n      if (label.includes(\"superscript = true\")) {\n        classString += \"is-superscript\";\n      }\n      if (label.includes(\"subscript = true\")) {\n        classString += \"is-subscript\";\n      }\n      if (label.includes(\"italic = true\")) {\n        classString += \"is-italic\";\n      }\n      if (label.includes(\"underlined = true\")) {\n        classString += \"is-underlined\";\n      }\n      if (label.includes(\"strikethrough = true\")) {\n        classString += \"is-strikethrough\";\n      }\n      if (label.includes(\"bold = true\")) {\n        classString += \"is-bold\";\n      }\n\n      return classString;\n    },\n    highlight(id) {\n      this.$store.dispatch(\"content/highlight\", {\n        target: id,\n        origin: \"content\",\n      });\n    },\n    scrollIntoView(id) {\n      if (!this.$refs[id]) return;\n      const [element] = this.$refs[id];\n      if (element)\n        element.scrollIntoView({\n          block: \"center\",\n          inline: \"center\",\n          behavior: \"smooth\",\n        });\n    },\n  },\n};\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailContentTextEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailContentTextEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailContentTextEdit.vue?vue&type=template&id=232dbb7f&\"\nimport script from \"./DetailContentTextEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailContentTextEdit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <Layout>\n    <template #header> </template>\n    <template>\n      <ContentTextEdit :xmlJson=\"xmlJson\"/>\n    </template>\n    <template #footer> </template>\n  </Layout>\n</template>\n\n<script>\nimport Layout from \"./DetailContentLayout.vue\";\nimport ContentTextEdit from \"./DetailContentTextEdit.vue\";\n\nimport { mapState } from \"vuex\";\n\nexport default {\n  props: {\n    xmlJson: {\n      type: Object,\n      required: true,\n    },\n  },\n  components: {\n    Layout,\n    ContentTextEdit,\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailContentEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailContentEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailContentEdit.vue?vue&type=template&id=44433fd0&\"\nimport script from \"./DetailContentEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailContentEdit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('OpenSeadragon',{key:'penseadragon',ref:\"openseadragon\",staticClass:\"has-background-dark\",staticStyle:{\"width\":\"100%\",\"height\":\"100%\"},attrs:{\"id\":\"imageViewer\",\"options\":_vm.options},on:{\"open\":_vm.onOpen}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import config from \"../config\";\nimport round from \"lodash/round\";\n\nexport default {\n  data() {\n    return { imageBaseUrl: config.urls.image };\n  },\n  methods: {\n    getPaddedRect({ x, y, width, height }, padding = 5) {\n      return {\n        x: x - padding,\n        y: y - padding,\n        width: width + 2 * padding,\n        height: height + 2 * padding,\n      };\n    },\n    getImageInfo(id) {\n      return `${this.imageBaseUrl}/${id}/info.json`;\n    },\n    getImageSource(id, options = {}) {\n      const { x = 0, y = 0, width = \"\", height = \"\" } = options;\n      if (x === 0 && y === 0 && width === \"\" && height === \"\") {\n        return `${this.imageBaseUrl}/${id}/full/full/0/default.jpg`;\n      }\n      return `${this.imageBaseUrl}/${id}/${x},${y},${width},${height}/full/0/default.jpg`;\n    },\n    getScaledSource(id, { width = \"\", height = \"\" }) {\n      return `${this.imageBaseUrl}/${id}/full/${width},${height}/0/default.jpg`;\n    },\n    getThumbnailSource(id, params) {\n      return this.getScaledSource(id, params);\n    },\n    getContextImageSource(id, { x, y, width, height }, toRect) {\n      return `${this.imageBaseUrl}/${id}/${x},${y},${width},${height}/${toRect.width},${toRect.height}/0/default.jpg`;\n    },\n    getRoundedRect(rect, n = 2) {\n      return {\n        x: round(rect.x, 2),\n        y: round(rect.y, 2),\n        width: round(rect.width, 2),\n        height: round(rect.height, 2),\n      };\n    },\n    getIntersectionRatio(r1, r2) {\n      // https://stackoverflow.com/a/27162334\n      const dx =\n        Math.min(r1.x + r1.width, r2.x + r2.width) - Math.max(r1.x, r2.x);\n      const dy =\n        Math.min(r1.y + r1.height, r2.y + r2.height) - Math.max(r1.y, r2.y);\n      return Math.max(0, dx) * Math.max(0, dy);\n    },\n    getScaledRect({ x, y, width, height }) {\n      const rounded = (x) => Math.round(x * 1000000) / 1000000;\n      const w = this.width;\n      return {\n        x: rounded(x / w),\n        y: rounded(y / w),\n        width: rounded(width / w),\n        height: rounded(height / w),\n      };\n    },\n    getScaledPoints(points, width) {\n    \n      const rounded = (x) => Math.round(x * 1000) / 1000;\n      const w = width;\n      return points.map(({ x, y }) => ({\n        x: rounded(x / w),\n        y: rounded(y / w),\n      }));\n    },\n  \n    getPaddedRect({ x, y, width, height }, padding = 5) {\n      return {\n        x: x - padding,\n        y: y - padding,\n        width: width + 2 * padding,\n        height: height + 2 * padding,\n      };\n    },\n    parseNumber(value) {\n      if (typeof value === \"number\") return value;\n      if (typeof value === \"string\" && /\\d+/.test(value))\n        return parseInt(value);\n      return null;\n    },\n    roundNumber(value, n) {\n      return round(value, n);\n    },\n  },\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":_vm.id}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/* ** Based on https://github.com/braceslab/vue-openseadragon */\n\n<template>\n  <div :id=\"id\" />\n</template>\n\n<script>\nimport omit from \"lodash/omit\";\n\nexport default {\n  props: {\n    id: {\n      type: String,\n      default: \"openseadragon-editor\",\n    },\n    options: {\n      type: Object,\n    },\n    i18n: {\n      type: Object,\n    },\n    messages: {\n      type: Object,\n      default: () => ({\n        \"Tooltips.FullPage\": \"\",\n        \"Tooltips.Home\": \"\",\n        \"Tooltips.ZoomIn\": \"\",\n        \"Tooltips.ZoomOut\": \"\",\n        \"Tooltips.NextPage\": \"\",\n        \"Tooltips.PreviousPage\": \"\",\n        \"Tooltips.RotateLeft\": \"\",\n        \"Tooltips.RotateRight\": \"\",\n        \"Errors.Dzc\": \"\",\n        \"Errors.Dzi\": \"\",\n        \"Errors.Xml\": \"\",\n        \"Errors.ImageFormat\": \"\",\n        \"Errors.Security\": \"\",\n        \"Errors.Status\": \"\",\n        \"Errors.OpenFailed\": \"\",\n      }),\n    },\n  },\n  data() {\n    return {\n      viewer: null,\n    };\n  },\n\n  mounted() {\n    this.$nextTick(() => this.setup());\n  },\n  methods: {\n    setup() {\n      if (!this.viewer && this.options) {\n        this.translate();\n        const _options = this.options;\n        const OpenSeadragon = require(\"openseadragon\");\n        _options.id = this.id;\n        this.viewer = OpenSeadragon(omit(_options, \"tileSources\"));\n        this.viewer.open(_options.tileSources);\n        this.viewer.zoomPerClick = 1\n        this.viewer.addOnceHandler(\"open\", () => {\n          this.$emit(\"open\");\n        });\n      }\n    },\n    resolve(object, key) {\n      try {\n        const _keys = key.split(\".\");\n        let _cursor = object;\n        for (const _key of _keys) {\n          _cursor = _cursor[_key];\n        }\n        return _cursor;\n      } catch (e) {\n        return null;\n      }\n    },\n    /**\n\t@see https://openseadragon.github.io/examples/ui-customize-tooltips/\n      */\n    translate() {\n      if (!this.i18n || !this.messages) {\n        return;\n      }\n\n      const _messages = this.i18n.messages[this.i18n.locale];\n      const OpenSeadragon = require(\"openseadragon\");\n      for (const label in this.messages) {\n        OpenSeadragon.setString(\n          label,\n          this.resolve(_messages, this.messages[label])\n        );\n      }\n    },\n    panTo({ x, y }, immediate) {\n      const { Point } = require(\"openseadragon\");\n      this.viewer.viewport\n        .panTo(new Point(x, y), immediate)\n        .applyConstraints(immediate);\n    },\n    fitBoundsWithConstraints({ x, y, width, height }, immediate) {\n      const { Rect } = require(\"openseadragon\");\n      this.viewer.viewport\n        .fitBounds(new Rect(x, y, width, height), immediate)\n        .applyConstraints(immediate);\n    },\n    addOverlay({ element, location }) {\n      const { Overlay } = require(\"openseadragon\");\n      this.viewer.addOverlay(new Overlay({ element, location }));\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./vue-openseadragon.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./vue-openseadragon.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./vue-openseadragon.vue?vue&type=template&id=76016373&\"\nimport script from \"./vue-openseadragon.vue?vue&type=script&lang=js&\"\nexport * from \"./vue-openseadragon.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <OpenSeadragon\n    id=\"imageViewer\"\n    :key=\"'penseadragon'\"\n    ref=\"openseadragon\"\n    class=\"has-background-dark\"\n    :options=\"options\"\n    style=\"width: 100%; height: 100%\"\n    @open=\"onOpen\"\n  />\n</template>\n\n<script>\n// const svgOverlay = require(\"svg-overlay\");\n\nimport { mapState } from \"vuex\";\n\nimport imageMixin from \"../../mixins/image.js\";\n\nimport OpenSeadragon from \"../vue-openseadragon.vue\";\n\nimport { svgOverlay } from \"../../utils/openseadragon-svg-overlay.js\";\n\nexport default {\n  components: {\n    OpenSeadragon,\n  },\n  mixins: [imageMixin],\n  props: {\n    source: {\n      type: String,\n      required: true,\n    },\n    width: {\n      type: Number,\n      required: true,\n      default: 100,\n    },\n    height: {\n      type: Number,\n      required: true,\n    },\n    xmlJson: {\n      type: Object,\n      required: true,\n    },\n    results: {\n      type: Array,\n      required: true,\n    },\n  },\n\n  data: () => ({\n    overlays: null,\n    selectedOverlayIndex: null,\n    layoutElements: {},\n    selectedLayoutElement: null,\n    highlightedLayoutElement: null,\n    selectedOverlayIndex: null,\n  }),\n  watch: {\n    /*\n     ** FIXME: use reactive style everywhere, i.e. change variable in methods,\n     **        then watch this variable, perform action when it has changed\n     */\n    data: {\n      handler: function (newValue, oldValue) {\n        console.log(newValue);\n        // if (newValue) this.layoutElements = this.renderLayout(newValue);\n      },\n      deep: true,\n    },\n    selected: {\n      handler: function (newValue, oldValue) {\n        if (newValue !== null && newValue.origin !== \"image\") {\n          this.selectLayoutElement(newValue.target);\n          this.fitBounds(newValue.target, true);\n        }\n      },\n      deep: true,\n    },\n    highlighted: {\n      handler: function (newValue, oldValue) {\n        if (newValue !== null && newValue.origin !== \"image\")\n          this.highlightLayoutElement(newValue.target);\n      },\n      deep: true,\n    },\n  },\n  computed: {\n    ...mapState(\"content\", [\"data\", \"selected\", \"highlighted\"]),\n    options() {\n      const baseUrl =\n        \"https://cdnjs.cloudflare.com/ajax/libs/openseadragon/2.4.0\";\n      return {\n        tileSources: this.source,\n        zoomPerClick: 1.2,\n        prefixUrl: `${baseUrl}/images/`,\n        maxZoomLevel: 5,\n        showZoomControl: false,\n        showHomeControl: false,\n        showFullPageControl: false,\n        visibilityRatio: 0.2,\n      };\n    },\n  },\n  destroyed() {\n    // clear svg node's content\n    if (this.$refs.openseadragon) {\n      const viewer = this.$refs.openseadragon.viewer;\n      const overlay = viewer.svgOverlay();\n      const svgNode = overlay.node();\n\n      if (svgNode) svgNode.innerHTML = \"\";\n    }\n  },\n  methods: {\n    onOpen() {\n      this.fitToWidth();\n\n      if (this.xmlJson) this.layoutElements = this.renderLayout(this.xmlJson);\n\n      if (this.overlays === null)\n        this.overlays = Object.freeze(this.createOverlays());\n\n      // const index = this.parseNumber(this.$route.query.result);\n      // if (index !== null && this.results.length > 0)\n      //   this.selectedOverlayIndex = index;\n\n      if (this.selectedOverlayIndex !== null)\n        this.selectWithPan(this.selectedOverlayIndex, false);\n    },\n    fitToWidth() {\n      /*\n       ** as seen on https://github.com/openseadragon/openseadragon/issues/839#issuecomment-181968800\n       */\n      const viewer = this.$refs.openseadragon.viewer;\n      const viewportBounds = viewer.viewport.getBounds();\n      const viewportAspect = viewportBounds.height / viewportBounds.width;\n      const newBounds = viewer.world.getHomeBounds();\n      newBounds.height = newBounds.width * viewportAspect;\n      viewer.viewport.fitBounds(newBounds, false);\n    },\n    setHome() {\n      if (!this.$refs.openseadragon) return;\n      const viewer = this.$refs.openseadragon.viewer;\n      // disables zoom on click\n      viewer.gestureSettingsMouse.clickToZoom = false;\n\n      /*\n       ** as seen on https://github.com/openseadragon/openseadragon/issues/839#issuecomment-181968800\n       */\n      const viewportBounds = viewer.viewport.getBounds();\n      const viewportAspect = viewportBounds.height / viewportBounds.width;\n      const newBounds = viewer.world.getHomeBounds();\n      newBounds.height = newBounds.width * viewportAspect;\n      viewer.viewport.fitBounds(newBounds, true);\n    },\n    panTo(index, isAnimated = false) {\n      if (this.results.length > 0) {\n        const { rect } = this.results[index];\n        const point = {\n          x: (rect.x + rect.width / 2) / this.width,\n          y: (rect.y + rect.height / 2) / this.width,\n        };\n        this.$refs.openseadragon.panTo(point, !isAnimated);\n      }\n    },\n    zoom(delta) {\n      if (!this.$refs.openseadragon) return;\n\n      const viewer = this.$refs.openseadragon.viewer;\n\n      if (delta > 0) {\n        viewer.viewport.zoomBy(1.5)\n      } else {\n        viewer.viewport.zoomBy(1 / 1.5)\n      }\n      viewer.viewport.applyConstraints();\n    },\n    async fitBounds(id, isAnimated = false) {\n      const data = await this.$store.dispatch(\"content/findElementById\", id);\n      if (data === null) return;\n\n      const toRect = (points) => {\n        const x = Math.min.apply(\n          null,\n          data.geometry.coords.map((p) => p.x)\n        );\n        const y = Math.min.apply(\n          null,\n          data.geometry.coords.map((p) => p.y)\n        );\n        const width =\n          Math.max.apply(\n            null,\n            data.geometry.coords.map((p) => p.x)\n          ) - x;\n        const height =\n          Math.max.apply(\n            null,\n            data.geometry.coords.map((p) => p.y)\n          ) - y;\n        return { x, y, width, height };\n      };\n\n      const rect = this.getScaledRect(\n        this.getPaddedRect(toRect(data.geometry.coords), 75)\n      );\n\n      const point = {\n        x: rect.x + rect.width / 2,\n        y: rect.y + rect.height / 2,\n      };\n\n      this.$refs.openseadragon.panTo(point, !isAnimated);\n    },\n    select(index, isAnimated) {\n      if (this.overlays.length === 0) return;\n      if (!(index < this.overlays.length)) return;\n\n      const activeNode =\n        this.selectedOverlayIndex === null\n          ? null\n          : this.overlays[this.selectedOverlayIndex].element;\n\n      const node = this.overlays[index].element;\n\n      if (activeNode && node !== activeNode)\n        activeNode.classList.remove(\"is-selected\");\n\n      node.classList.add(\"is-selected\");\n\n      this.selectedOverlayIndex = index;\n    },\n    selectWithPan(index) {\n      this.select(index, false);\n      this.panTo(index, false);\n    },\n    renderLayout(data) {\n      if (!this.$refs.openseadragon) return [];\n      //  FIXME openseadragon viewer and editor use same refernece -> collision\n      const viewer = this.$refs.openseadragon.viewer;\n      // const svgOverlay = require(\"svg-overlay\");\n\n      const d3 = require(\"d3\");\n      const overlay = viewer.svgOverlay();\n      const svg = d3.select(overlay.node());\n      svg.attr(\"class\", \"layout\");\n\n      const contentGroup = svg.append(\"g\");\n      return data.elements.reduce((m, element) => {\n        if (!element.geometry) return [];\n        const pointsTemp = element.geometry.coords;\n        if (pointsTemp)\n          this.renderPolygon({\n            parent: contentGroup,\n            points: pointsTemp,\n            className: \"content\",\n          });\n\n        const vm = this;\n\n        const elementGroup = contentGroup.append(\"g\");\n\n        return element.elements.reduce((m, element) => {\n          var points = element.geometry.coords;\n          var id = element.attributes.id;\n\n          if (element.type == \"TableCell\") {\n            return element.elements.reduce((m, element) => {\n              var points = element.geometry.coords;\n              var id = element.attributes.id;\n\n              const polygon = this.renderPolygon({\n                parent: elementGroup,\n                points: this.getScaledPoints(points, this.width),\n                className: \"element\",\n              })\n                .on(\"click\", () => {\n                  this.selectLayoutElement(id);\n                  this.$store.dispatch(\"content/select\", {\n                    target: id,\n                    origin: \"image\",\n                  });\n                })\n                .on(\"mouseover\", () => this.highlightLayoutElement(id), true)\n                .on(\"mouseout\", () => this.highlightLayoutElement(id), true)\n                .node();\n              return Object.assign(m, { [id]: polygon });\n            }, m);\n          }\n          const polygon = this.renderPolygon({\n            parent: elementGroup,\n            points: this.getScaledPoints(points, this.width),\n            className: \"element\",\n          })\n            .on(\"click\", () => {\n              this.selectLayoutElement(id);\n              this.$store.dispatch(\"content/select\", {\n                target: id,\n                origin: \"image\",\n              });\n            })\n            .on(\"mouseover\", () => this.highlightLayoutElement(id), true)\n            .on(\"mouseout\", () => this.highlightLayoutElement(id), true)\n            .node();\n          return Object.assign(m, { [id]: polygon });\n        }, m);\n      }, {});\n    },\n    async selectLayoutElement(id) {\n      const element = this.layoutElements[id];\n      if (!element) return;\n\n      if (\n        this.selectedLayoutElement !== null &&\n        element !== this.selectedLayoutElement &&\n        this.selectedLayoutElement.classList.contains(\"is-selected\")\n      )\n        this.selectedLayoutElement.classList.remove(\"is-selected\");\n\n      if (!element.classList.contains(\"is-selected\")) {\n        element.classList.add(\"is-selected\");\n      }\n\n      if (element !== this.selectedLayoutElement)\n        this.selectedLayoutElement = element;\n    },\n    highlightLayoutElement(id) {\n      const element = this.layoutElements[id];\n      if (!element) return;\n      if (this.highlightedLayoutElement === element) {\n        if (element.classList.contains(\"is-highlighted\"))\n          element.classList.remove(\"is-highlighted\");\n      } else {\n        this.highlightedLayoutElement = element;\n\n        if (!element.classList.contains(\"is-highlighted\"))\n          element.classList.add(\"is-highlighted\");\n      }\n\n      this.$store.dispatch(\"content/highlight\", {\n        target: id,\n        origin: \"image\",\n      });\n    },\n    renderPolygon({ parent, points, className }) {\n      return parent\n        .append(\"polygon\")\n        .attr(\n          \"points\",\n          points.map(({ x, y }) => {\n            return `${x},${y}`;\n          })\n        )\n        .attr(\"class\", className)\n        .attr(\"tabindex\", 0);\n    },\n    createOverlays() {\n      if (!this.$refs.openseadragon) return [];\n\n      const viewer = this.$refs.openseadragon.viewer;\n      // const svgOverlay = require(\"svg-overlay\");\n\n      const d3 = require(\"d3\");\n\n      const overlay = viewer.svgOverlay();\n\n      const svg = d3.select(overlay.node());\n\n      return this.results.map(({ score, label, ...result }, index) => {\n        const rect = this.getScaledRect(\n          this.getPaddedRect(result.rect, this.height / 100)\n        );\n\n        const d3Rect = svg\n          .append(\"rect\")\n          .attr(\"x\", rect.x)\n          .attr(\"y\", rect.y)\n          .attr(\"width\", rect.width)\n          .attr(\"height\", rect.height)\n          .attr(\"title\", `${label} (${this.sanitizeScore(score)})`)\n          .attr(\"class\", \"highlight is-primary\")\n          .on(\"click\", () => {\n            this.select(index, true);\n          });\n\n        return {\n          d3: d3Rect,\n          element: d3Rect.node(),\n        };\n      });\n    },\n    clear() {\n      if (this.overlays.length === 0) return;\n      const index = this.selectedOverlayIndex;\n\n      if (!(this.index < this.overlays.length)) return;\n\n      const node = this.overlays[index].element;\n      if (node) node.classList.remove(\"is-selected\");\n      this.selectedOverlayIndex = null;\n      this.setHome();\n    },\n    sanitizeScore(score) {\n      return score === 1 || score === 0\n        ? score + \".0\"\n        : Math.round(score * 100) / 100;\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailImageEditViewer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailImageEditViewer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailImageEditViewer.vue?vue&type=template&id=75d7c5c3&\"\nimport script from \"./DetailImageEditViewer.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailImageEditViewer.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-field',{staticClass:\"has-background-white\",staticStyle:{\"flex-direction\":\"column\"}},[_c('p',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"position\":\"is-left\",\"label\":\"Increase zoom level\"}},[_c('b-button',{on:{\"click\":_vm.increaseZoom}},[_c('b-icon',{attrs:{\"icon\":\"plus\"}})],1)],1)],1),_c('p',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"position\":\"is-left\",\"label\":\"Decrease zoom level\"}},[_c('b-button',{on:{\"click\":_vm.decreaseZoom}},[_c('b-icon',{attrs:{\"icon\":\"minus\"}})],1)],1)],1),_c('p',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"position\":\"is-left\",\"label\":\"Fit to width\"}},[_c('b-button',{on:{\"click\":_vm.fitToWidth}},[_c('b-icon',{attrs:{\"icon\":\"compress\"}})],1)],1)],1),_c('p',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"position\":\"is-left\",\"label\":\"Fullscreen\"}},[_c('b-button',{on:{\"click\":_vm.fullscreen}},[_c('b-icon',{attrs:{\"icon\":\"expand\"}})],1)],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <b-field class=\"has-background-white\" style=\"flex-direction: column;\">\n    <p class=\"control\">\n      <b-tooltip position=\"is-left\" label=\"Increase zoom level\">\n        <b-button @click=\"increaseZoom\">\n          <b-icon icon=\"plus\"></b-icon>\n        </b-button>\n      </b-tooltip>\n    </p>\n    <p class=\"control\">\n      <b-tooltip position=\"is-left\" label=\"Decrease zoom level\">\n        <b-button @click=\"decreaseZoom\">\n          <b-icon icon=\"minus\"></b-icon>\n        </b-button>\n      </b-tooltip>\n    </p>\n    <p class=\"control\">\n      <b-tooltip position=\"is-left\" label=\"Fit to width\">\n        <b-button @click=\"fitToWidth\">\n          <b-icon  icon=\"compress\"></b-icon>\n        </b-button>\n      </b-tooltip>\n    </p>\n    <p class=\"control\">\n      <b-tooltip position=\"is-left\" label=\"Fullscreen\">\n        <b-button @click=\"fullscreen\">\n          <b-icon  icon=\"expand\"></b-icon>\n        </b-button>\n      </b-tooltip>\n    </p>\n  </b-field>\n</template>\n<style >\n.field.has-addons {\n\tdisplay: flex;\n  justify-content: flex-start;\n\tflex-direction: column;\n}\n\n</style>\n\n<script>\n\nexport default {\n  methods: {\n    increaseZoom() {\n      this.$emit(\"input\", { type: \"zoom\", delta: 1 });\n    },\n    decreaseZoom() {\n      this.$emit(\"input\", { type: \"zoom\", delta: -1 });\n    },\n    home() {\n      this.$emit(\"input\", { type: \"home\" });\n    },\n    fitToWidth() {\n      this.$emit(\"input\", { type: \"fit\" });\n    },\n    fullscreen() {\n      this.$fullscreen.toggle();\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailImageControls.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailImageControls.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailImageControls.vue?vue&type=template&id=3cee92df&\"\nimport script from \"./DetailImageControls.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailImageControls.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DetailImageControls.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <section class=\"hero is-fullheight-with-navbar\">\n    <DetailEditLayout :name=\"view\">\n      <template v-slot:image>\n        <ImageViewer\n          v-if=\"imageInfo\"\n          ref=\"viewer\"\n          :source=\"iiifUrl\"\n          :width=\"imageInfo.width\"\n          :height=\"imageInfo.height\"\n          :xmlJson=\"parsedJson\"\n          :results=\"results\"\n        />\n        <aside class=\"detail-image-controls-wrapper\">\n          <ImageControls @input=\"handleControlEvent\" />\n        </aside>\n      </template>\n\n      <template v-slot:content>\n        <Content id=\"textEditor\" :xmlJson=\"parsedJson\" />\n      </template>\n    </DetailEditLayout>\n  </section>\n</template>\n<style lang=\"scss\">\n// .detail-image-controls-wrapper {\n//   position: absolute;\n//   right: 1.25rem;\n//   top: 1.25rem;\n// }\n</style>\n\n<script>\nimport DetailEditLayout from \"./DetailEditLayout.vue\";\nimport Content from \"./DetailContentEdit.vue\";\nimport ImageViewer from \"./DetailImageEditViewer.vue\";\nimport ImageControls from \"./DetailImageControls.vue\";\n\nimport { parseJsonContent } from \"../../utils/xml.js\";\nimport imageMixin from \"../../mixins/image.js\";\nimport { getImageSize } from \"../../utils/api.js\";\n\nimport { mapState, mapGetters } from \"vuex\";\n\nvar WindowObjectReference; // global variable\n\nexport default {\n  components: {\n    DetailEditLayout,\n    Content,\n    ImageViewer,\n    ImageControls,\n  },\n  props: {\n    iiifUrl: {\n      type: String,\n      required: true,\n    },\n    xmlJson: {\n      type: Object,\n      required: true,\n    },\n  },\n  mixins: [imageMixin],\n  data() {\n    return {\n      imageInfo: null,\n    };\n  },\n  computed: {\n    ...mapState(\"detail\", [\n      // document\n      \"docId\",\n      \"title\",\n      \"colTitle\",\n      \"pageNum\",\n      \"maxPage\",\n      \"isDocumentReady\",\n      \"tsList\",\n      // page\n      \"image\",\n      \"isPageReady\",\n      \"isPageContentReady\",\n      // search\n      \"results\",\n      \"view\",\n      \"tagMode\",\n    ]),\n    ...mapState(\"content\", [\n      \"data\",\n      \"selected\",\n      \"highlighted\",\n      \"fetchPageContent\",\n    ]),\n    ...mapGetters(\"detail\", [\"isLoading\"]),\n    source() {\n      return this.getImageInfo(this.image.id);\n    },\n    parsedJson() {\n      return parseJsonContent(this.xmlJson);\n    },\n  },\n  async mounted() {\n    const response = await fetch(this.iiifUrl);\n    const data = await response.json();\n    this.imageInfo = data;\n    this.$store.dispatch(\"content/setXmlModel\", {\n      xmlModel: this.xmlJson,\n    });\n    this.$store.dispatch(\"content/update\", { data: this.parsedJson });\n  },\n  async destroyed() {\n    // reset state\n    this.$store.dispatch(\"content/reset\");\n  },\n  methods: {\n    async update() {\n      await this.$store.dispatch(\"detail/fetch\", this.$route.params);\n    },\n    handleControlEvent(event) {\n      if (event.type.toLowerCase() === \"zoom\") {\n        this.$refs.viewer.zoom(event.delta);\n      }\n      if (event.type.toLowerCase() === \"home\") {\n        this.$refs.viewer.setHome();\n      }\n      if (event.type.toLowerCase() === \"fit\") {\n        this.$refs.viewer.fitToWidth();\n      }\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TranscriptionInterfaceLocal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TranscriptionInterfaceLocal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TranscriptionInterfaceLocal.vue?vue&type=template&id=0fa15eee&\"\nimport script from \"./TranscriptionInterfaceLocal.vue?vue&type=script&lang=js&\"\nexport * from \"./TranscriptionInterfaceLocal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TranscriptionInterfaceLocal.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <section >\n    <TranscriptionInterfaceLocal :iiifUrl=\"iiifUrl\" :xmlJson=\"xmlJson\" :tags=\"tags\"/>\n  </section>\n</template>\n\n<script>\nimport TranscriptionInterfaceLocal from \"../components/DetailView/TranscriptionInterfaceLocal.vue\";\n\nimport { mapState, mapGetters } from \"vuex\";\n\nimport imageMixin from \"../mixins/image.js\";\n\nconst json = require(\"../assets/page1.json\");\n\nexport default {\n  components: {\n    TranscriptionInterfaceLocal,\n  },\n  mixins: [imageMixin],\n  props: {\n    iiifUrl: {\n      type: String,\n      required: true,\n    },\n    xmlJson: {\n      type: Object,\n      required: true,\n    },\n  },\n  data() {\n    return {\n    };\n  },\n  methods: {},\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Editor.vue?vue&type=template&id=76be7d11&\"\nimport script from \"./Editor.vue?vue&type=script&lang=js&\"\nexport * from \"./Editor.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"transkribusEditor\">\n    <Editor v-if=\"xmlJsonString\" :iiifUrl=\"iiifUrl\" :xmlJson=\"toJsonObject\" />\n    <Editor v-else :iiifUrl=\"iiifUrl\" :xmlJson=\"xmlJson\" />\n  </div>\n</template>\n\n<script>\n// Test page : http://localhost:5000/collection/76950/doc/497355/detail/1\n\nimport Editor from \"./views/Editor.vue\";\n\nconst json = require(\"./assets/page1.json\");\n\nexport default {\n  name: \"transkribusEditor\",\n  props: {\n    iiifUrl: {\n      type: String,\n      default: () =>\n        \"https://rhus-209.man.poznan.pl/fcgi-bin/iipsrv.fcgi?IIIF=11/8//2020601/https___1914_1918_europeana_eu_contributions_21890/21890.261095.original.tif/info.json\",\n    },\n    xmlJson: {\n      type: Object,\n      default: () => json,\n    },\n    xmlJsonString: {\n      type: String,\n    },\n    tags: {\n      type: String,\n    },\n  },\n  methods: {\n    escapeSpecialChars(string) {\n      return string\n        .replace(/\\\\n/g, \"\\\\n\")\n        .replace(/\\\\'/g, \"\\\\'\")\n        .replace(/\\\\\"/g, '\\\\\"')\n        .replace(/\\\\&/g, \"\\\\&\")\n        .replace(/\\\\r/g, \"\\\\r\")\n        .replace(/\\\\t/g, \"\\\\t\")\n        .replace(/\\\\b/g, \"\\\\b\")\n        .replace(/\\\\f/g, \"\\\\f\");\n    },\n  },\n  components: {\n    Editor,\n  },\n  computed: {\n    toJsonObject() {\n      var cleanedString = this.escapeSpecialChars(this.xmlJsonString);\n      const obj = JSON.parse(cleanedString);\n      return obj;\n    },\n  },\n  mounted() {\n    if (this.tags) {\n      var cleanedString = this.escapeSpecialChars(this.tags);\n      const obj = JSON.parse(cleanedString);\n      this.$store.dispatch(\"browse/setTagDefs\", { tagDefs: obj });\n    }\n  },\n};\n</script>\n<style lang=\"scss\">\n\n\n@import \"~bulma/sass/utilities/_all\";\n@import \"assets/variables.scss\";\n@import \"assets/styles.scss\";\n\n@import \"bulma\";\n@import \"buefy/src/scss/buefy\";\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=4017cd6e&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { library } from \"@fortawesome/fontawesome-svg-core\";\nimport {\n  faSearch,\n  faAngleRight,\n  faAngleLeft,\n  faAngleUp,\n  faAngleDown,\n  faMinusSquare,\n  faPlusSquare,\n  faChevronLeft,\n  faChevronRight,\n  faChevronUp,\n  faChevronDown,\n  faFileAlt,\n  faTimes,\n  faArrowUp,\n  faArrowDown,\n  faPlus,\n  faMinus,\n  faTrash,\n  faDesktop,\n  faColumns,\n  faImage,\n  faCode,\n  faEye,\n  faPaperPlane,\n  faCheck,\n  faShoppingCart,\n  faDownload,\n  faEyeSlash,\n  faTags,\n  faCaretDown,\n  faCaretUp,\n  faImages,\n  faAlignLeft,\n  faObjectGroup,\n  faQuestion,\n  faQuestionCircle,\n  faExternalLinkAlt,\n  faUndo,\n  faRedo,\n  faBars,\n  faSave,\n  faBold,\n  faCompress,\n  faExpand,\n  faStrikethrough,\n  faUnderline,\n  faSubscript,\n  faSuperscript,\n  faTag,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\n\nexport default {\n  install(Vue, options = {}) {\n    library.add(\n      faSearch,\n      faAngleRight,\n      faAngleLeft,\n      faAngleUp,\n      faAngleDown,\n      faMinusSquare,\n      faPlusSquare,\n      faChevronLeft,\n      faChevronRight,\n      faChevronUp,\n      faChevronDown,\n      faFileAlt,\n      faTimes,\n      faArrowUp,\n      faCompress,\n      faExpand,\n      faArrowDown,\n      faPlus,\n      faMinus,\n      faTrash,\n      faDesktop,\n      faColumns,\n      faImage,\n      faCode,\n      faEye,\n      faPaperPlane,\n      faCheck,\n      faShoppingCart,\n      faDownload,\n      faEyeSlash,\n      faTags,\n      faCaretDown,\n      faCaretUp,\n      faAlignLeft,\n      faImages,\n      faObjectGroup,\n      faQuestion,\n      faQuestionCircle,\n      faExternalLinkAlt,\n      faUndo,\n      faRedo,\n      faBars,\n      faSave,\n      faBold,\n      faStrikethrough,\n      faUnderline,\n      faSubscript,\n      faSuperscript,\n      faTag\n    );\n\n    Vue.component(\"font-awesome-icon\", FontAwesomeIcon);\n  },\n};\n","import Vue from \"vue\";\nimport App from \"./App.vue\";\nimport Vuex from \"vuex\";\nimport Buefy from \"buefy\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport fontawesome from \"@/plugins/fontawesome.js\";\nimport VueFullscreen from \"vue-fullscreen\";\nimport banner from \"rollup-plugin-banner\";\nimport store from \"@/store\";\n\nVue.config.productionTip = false;\n\nVue.use(Vuex);\nVue.use(fontawesome);\n\nVue.use(Buefy, {\n  defaultIconComponent: FontAwesomeIcon,\n  defaultIconPack: \"fas\",\n});\nVue.use(VueFullscreen);\n\nconst root_element = document.getElementById(\"transkribusEditor\");\n\nconst AppRoot = Vue.extend(App);\nwindow.eventBus = new AppRoot({\n  store,\n  el: root_element,\n  propsData: { ...root_element.dataset },\n  mounted() {\n    this.$root.$on(\"save\", this.save);\n  },\n  methods: {\n    save(value) {\n      window.output = value;\n      root_element.dataset.output = JSON.stringify(value);\n      window.eventBus.$emit(\"dataSaved\", value);\n    },\n    escapeSpecialChars(string) {\n      return string\n        .replace(/\\\\n/g, \"\\\\n\")\n        .replace(/\\\\'/g, \"\\\\'\")\n        .replace(/\\\\\"/g, '\\\\\"')\n        .replace(/\\\\&/g, \"\\\\&\")\n        .replace(/\\\\r/g, \"\\\\r\")\n        .replace(/\\\\t/g, \"\\\\t\")\n        .replace(/\\\\b/g, \"\\\\b\")\n        .replace(/\\\\f/g, \"\\\\f\");\n    },\n  },\n}).$mount(\"#transkribusEditor\");\n\nexport default AppRoot;\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailImageControls.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TranscriptionInterfaceLocal.vue?vue&type=style&index=0&lang=scss&\"","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = \"a3ea\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RegionNode.vue?vue&type=style&index=0&id=90ae8d76&lang=scss&scoped=true&\""],"sourceRoot":""}