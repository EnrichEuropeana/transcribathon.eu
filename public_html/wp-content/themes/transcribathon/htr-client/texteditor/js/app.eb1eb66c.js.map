{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/openseadragon-svg-overlay.js","webpack:///./src/App.vue?f333","webpack:///./src/views/Editor.vue?bfa1","webpack:///./src/components/DetailView/TranscriptionInterfaceLocal.vue?e409","webpack:///./src/components/DetailView/DetailEditLayout.vue?8323","webpack:///src/components/DetailView/DetailEditLayout.vue","webpack:///./src/components/DetailView/DetailEditLayout.vue?dd19","webpack:///./src/components/DetailView/DetailEditLayout.vue","webpack:///./src/components/DetailView/DetailContentEdit.vue?f59d","webpack:///./src/components/DetailView/DetailContentLayout.vue?3c83","webpack:///./src/components/DetailView/DetailContentLayout.vue","webpack:///./src/components/DetailView/DetailContentTextEdit.vue?48d9","webpack:///./src/components/Editor/RegionNode.vue?fd41","webpack:///src/components/Editor/RegionNode.vue","webpack:///./src/components/Editor/RegionNode.vue?05ea","webpack:///./src/components/Editor/RegionNode.vue","webpack:///./src/components/Editor/RegionExtension.js","webpack:///./src/components/Editor/LineNode.vue?1a21","webpack:///src/components/Editor/LineNode.vue","webpack:///./src/components/Editor/LineNode.vue?3fc7","webpack:///./src/components/Editor/LineNode.vue","webpack:///./src/config/index.js","webpack:///./src/store/content/index.js","webpack:///./src/utils/xml.js","webpack:///./src/utils/api.js","webpack:///./src/store/detail/index.js","webpack:///./src/store/browse/index.js","webpack:///./src/store/index.js","webpack:///./src/components/Editor/LineExtension.js","webpack:///./src/components/Editor/TagExtension.js","webpack:///./src/components/Editor/SubscriptExtension.js","webpack:///./src/components/Editor/SuperscriptExtension.js","webpack:///src/components/DetailView/DetailContentTextEdit.vue","webpack:///./src/components/DetailView/DetailContentTextEdit.vue?7c02","webpack:///./src/components/DetailView/DetailContentTextEdit.vue","webpack:///src/components/DetailView/DetailContentEdit.vue","webpack:///./src/components/DetailView/DetailContentEdit.vue?389d","webpack:///./src/components/DetailView/DetailContentEdit.vue","webpack:///./src/components/DetailView/DetailImageEditViewer.vue?e61b","webpack:///./src/mixins/image.js","webpack:///./src/components/vue-openseadragon.vue?5f63","webpack:///src/components/vue-openseadragon.vue","webpack:///./src/components/vue-openseadragon.vue?f2f4","webpack:///./src/components/vue-openseadragon.vue","webpack:///src/components/DetailView/DetailImageEditViewer.vue","webpack:///./src/components/DetailView/DetailImageEditViewer.vue?0808","webpack:///./src/components/DetailView/DetailImageEditViewer.vue","webpack:///./src/components/DetailView/DetailImageControls.vue?6622","webpack:///src/components/DetailView/DetailImageControls.vue","webpack:///./src/components/DetailView/DetailImageControls.vue?8c77","webpack:///./src/components/DetailView/DetailImageControls.vue?2687","webpack:///src/components/DetailView/TranscriptionInterfaceLocal.vue","webpack:///./src/components/DetailView/TranscriptionInterfaceLocal.vue?8f55","webpack:///./src/components/DetailView/TranscriptionInterfaceLocal.vue","webpack:///src/views/Editor.vue","webpack:///./src/views/Editor.vue?115f","webpack:///./src/views/Editor.vue","webpack:///src/App.vue","webpack:///./src/App.vue?a37b","webpack:///./src/App.vue?180a","webpack:///./src/plugins/fontawesome.js","webpack:///./src/main.js","webpack:///./src/App.vue?df62","webpack:///./src/components/DetailView/DetailImageControls.vue?4c95","webpack:///./src/components/DetailView/TranscriptionInterfaceLocal.vue?6a20","webpack:///./node_modules/rollup-plugin-banner/dist sync","webpack:///./src/components/Editor/RegionNode.vue?4ffd"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","$","OpenSeadragon","require","Error","svgNS","Viewer","svgOverlay","this","_svgOverlayInfo","Overlay","viewer","self","_viewer","_containerWidth","_containerHeight","_svg","document","createElementNS","style","position","left","top","width","height","canvas","appendChild","_node","addHandler","resize","evt","node","container","clientWidth","setAttribute","clientHeight","viewport","pixelFromPoint","Point","zoom","getZoom","rotation","getRotation","scale","_containerInnerSize","x","y","onClick","handler","MouseTracker","element","clickHandler","setTracking","render","_vm","_h","$createElement","_c","_self","attrs","iiifUrl","toJsonObject","xmlJson","staticRenderFns","tags","staticClass","view","scopedSlots","_u","fn","ref","imageInfo","results","_e","on","handleControlEvent","proxy","_t","components","Splitpanes","Pane","computed","mapState","props","type","validator","includes","component","staticStyle","script","isLoading","model","callback","$$v","expression","isAnnotation","_v","$event","setFontSize","layoutIcon","setEditLayout","editor","chain","focus","undo","run","redo","saveContent","_l","selectedTag","tempTag","index","_s","tag","findTagAttributes","attribute","changeContinued","attributes","$set","deleteTag","tagDefs","class","isActive","toggleBold","toggleStrike","toggleUnderline","toggleSub","toggleSuper","definitions","color","setAttributes","label","fontSize","NodeViewWrapper","NodeViewContent","selectable","Node","group","content","addAttributes","lines","default","number","addProseMirrorPlugins","Plugin","handleKeyDown","event","which","state","deleting","filterTransaction","transaction","count","mapping","maps","forEach","map","oldStart","oldEnd","newStart","newEnd","doc","nodesBetween","pos","parent","parseHTML","renderHTML","HTMLAttributes","mergeAttributes","addNodeView","VueNodeViewRenderer","Component","line","onMouseClick","id","onMouseOut","onMouseOver","methods","highlight","$store","dispatch","target","origin","select","urls","image","xml","hashidsSecret","token","transcriptionURL","searchApiBaseUrl","apiBaseUrl","contactEmail","bugEmail","bugtrackerUrl","repo","consentCookie","recordSession","selected","highlighted","isError","isReady","xmlModel","parseXML","wasSaved","wasEdited","editLayoutHorizontal","parsePageContent","mutations","update","params","deepEqual","actions","commit","reset","isready","setSelectedTag","setIIIF","setXmlJson","setXml","json","pageJson","setXmlModel","fetch","fetchPageContent","fetchPageContentXML","freeze","findElementById","stack","pop","elements","namespaced","xml2js","json2xml","jp","XML2JS","DEFAULT","compact","trim","alwaysArray","alwaysChildren","attributeValueFn","parseAttributeValue","TEST","parsePointsAttribute","string","split","parseInt","reverseParsePointsAttribute","values","pointString","point","points","temp","replace","parseCustomAttribute","reduce","indexOf","concat","decodeURIComponent","JSON","parse","Boolean","reverseParseparseCustomAttribute","customString","custom","stringify","replaceAll","reverseParseAttributeValue","imgUrl","getObjects","obj","val","objects","lastIndexOf","replaceLine","textString","customObjArr","elementArr","text","lineTagIndex","filter","el","lineTag","parseEditorOutput","editorJson","globalJson","editorLineArr","lineIndex","contentIndex","undefined","lineContent","marks","markIndex","mark","offset","strikethrough","underlined","subscript","superscript","parseToXML","options","ignoreComment","spaces","sanitize","attributesFn","js","search","PcGts","Page","logOut","$auth","loginWith","fetchSearchResults","term","documents","titles","page","fuzziness","limit","$nuxt","$axios","method","body","collections","collection","headers","CONTENT_TYPE","Accept","res","status","fetchTagDef","collId","fetchDocumentsMeta","docId","nrOfTranscripts","fetchPageInfo","pageNr","title","colTitle","maxPage","NaN","documentInfo","isDocumentReady","isDocumentNotFoundError","pageId","pageNum","pageInfo","pageContentId","tsList","tsKey","isPageReady","isPageContentReady","isPageNotFoundError","isPageContentNotFoundError","requestCount","tagMode","changed","assign","getters","rootState","hasResults","beginRequest","endRequest","routeParams","docid","collectionid","pageid","fetchDocumentInfo","collectionList","colList","find","colId","nrOfPages","transcripts","colRole","setCollections","setTagDefs","setDocuments","setColTitle","setColRole","Vue","use","Vuex","Store","browse","detail","strict","process","addKeyboardShortcuts","Enter","commands","selectParentNode","selection","nodeAt","$head","selectNodeForward","setTextSelection","size","lineId","getElementById","scrollIntoView","behavior","store","ArrowDown","ArrowUp","tagExtensions","tagIndex","tagExtensionArr","tempExtension","Highlight","extend","toggleBulletList","addCommands","setTag","setMark","toggleTag","tr","toggleMark","unsetTag","unsetMark","annotationId","getAttribute","backgroundColor","Subscript","Mark","defaultOptions","consuming","getAttrs","setSub","unsetSub","Superscript","setSuper","unsetSuper","groupBy","filters","item","clean","watch","newValue","oldValue","nodes","docView","NodeSelection","deep","setup","contentData","setEditorContentJSON","TextAlign","EditorContent","BubbleMenu","editorContentJson","annotationCounter","lastTag","hasContent","linetemp","mounted","tagArray","that","extensions","Text","Region","Line","StarterKit","Focus","className","nested","Underline","Table","TableRow","TableHeader","TableCell","onSelectionUpdate","onUpdate","continued","continuedTags","findMarkByUid","from","to","uid","found","modelCopy","parsedResult","console","xmlResult","output","tagObj","tagName","tagColor","contentObj","getAttributes","anchor","$anchor","openToast","message","$buefy","toast","open","duration","loadTagDefs","groupByRow","table","getTagDef","annotations","beforeDestroy","destroy","hasTag","tagContent","setTagContent","editorContent","groupedRows","rowContent","row","cellContent","rowtemp","cell","celltemp","lineObjects","lineObj","regionObj","setContent","getTags","arrText","stringOffset","findTags","tagTemp","textStyles","setTextStyles","textStyle","tagDef","tagMark","bold","textStyleArr","str","indexes","unshift","lineText","tagtext","substr","textStyleClass","classString","$refs","block","inline","required","Layout","ContentTextEdit","onOpen","imageBaseUrl","config","getPaddedRect","padding","getImageInfo","getImageSource","getScaledSource","getThumbnailSource","getContextImageSource","toRect","getRoundedRect","rect","round","getIntersectionRatio","r1","r2","dx","Math","min","max","dy","getScaledRect","rounded","w","getScaledPoints","test","i18n","messages","$nextTick","translate","_options","tileSources","zoomPerClick","addOnceHandler","resolve","_keys","_cursor","panTo","immediate","applyConstraints","fitBoundsWithConstraints","fitBounds","addOverlay","location","mixins","overlays","selectedOverlayIndex","layoutElements","selectedLayoutElement","highlightedLayoutElement","selectLayoutElement","prefixUrl","maxZoomLevel","showZoomControl","showHomeControl","showFullPageControl","visibilityRatio","destroyed","openseadragon","svgNode","innerHTML","fitToWidth","renderLayout","newBounds","setHome","isAnimated","delta","activeNode","selectWithPan","svg","geometry","pointsTemp","coords","highlightLayoutElement","classList","contains","renderPolygon","append","attr","createOverlays","d3","clear","remove","sanitizeScore","score","increaseZoom","decreaseZoom","fullscreen","$emit","home","$fullscreen","toggle","DetailEditLayout","Content","ImageViewer","ImageControls","mapGetters","source","response","toLowerCase","TranscriptionInterfaceLocal","xmlJsonString","cleanedString","escapeSpecialChars","Editor","install","library","add","faSearch","faAngleRight","faAngleLeft","faAngleUp","faAngleDown","faMinusSquare","faPlusSquare","faChevronLeft","faChevronRight","faChevronUp","faChevronDown","faFileAlt","faTimes","faArrowUp","faCompress","faExpand","faArrowDown","faPlus","faMinus","faTrash","faDesktop","faColumns","faImage","faCode","faEye","faPaperPlane","faCheck","faShoppingCart","faDownload","faEyeSlash","faTags","faCaretDown","faCaretUp","faAlignLeft","faImages","faObjectGroup","faQuestion","faQuestionCircle","faExternalLinkAlt","faUndo","faRedo","faBars","faSave","faBold","faStrikethrough","faUnderline","faSubscript","faSuperscript","faTag","FontAwesomeIcon","productionTip","fontawesome","Buefy","defaultIconComponent","defaultIconPack","VueFullscreen","root_element","AppRoot","App","eventBus","propsData","dataset","$root","$on","save","payLoad","$mount","webpackEmptyContext","req","e","code","keys"],"mappings":"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","file":"js/app.eb1eb66c.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// OpenSeadragon SVG Overlay plugin 0.0.5\n\n(function() {\n\n    var $ = window.OpenSeadragon;\n    \n    if (!$) {\n        $ = require('openseadragon');\n        if (!$) {\n            throw new Error('OpenSeadragon is missing.');\n        }\n    }\n\n    var svgNS = 'http://www.w3.org/2000/svg';\n\n    // ----------\n    $.Viewer.prototype.svgOverlay = function() {\n        if (this._svgOverlayInfo) {\n            return this._svgOverlayInfo;\n        }\n\n        this._svgOverlayInfo = new Overlay(this);\n        return this._svgOverlayInfo;\n    };\n\n    // ----------\n    var Overlay = function(viewer) {\n        var self = this;\n\n        this._viewer = viewer;\n        this._containerWidth = 0;\n        this._containerHeight = 0;\n\n        this._svg = document.createElementNS(svgNS, 'svg');\n        this._svg.style.position = 'absolute';\n        this._svg.style.left = 0;\n        this._svg.style.top = 0;\n        this._svg.style.width = '100%';\n        this._svg.style.height = '100%';\n        this._viewer.canvas.appendChild(this._svg);\n\n        this._node = document.createElementNS(svgNS, 'g');\n        this._svg.appendChild(this._node);\n\n        this._viewer.addHandler('animation', function() {\n            self.resize();\n        });\n\n        this._viewer.addHandler('open', function() {\n            self.resize();\n        });\n\n        this._viewer.addHandler('rotate', function(evt) {\n            self.resize();\n        });\n\n        this._viewer.addHandler('resize', function() {\n            self.resize();\n        });\n\n        this.resize();\n    };\n\n    // ----------\n    Overlay.prototype = {\n        // ----------\n        node: function() {\n            return this._node;\n        },\n\n        // ----------\n        resize: function() {\n            if (this._containerWidth !== this._viewer.container.clientWidth) {\n                this._containerWidth = this._viewer.container.clientWidth;\n                this._svg.setAttribute('width', this._containerWidth);\n            }\n\n            if (this._containerHeight !== this._viewer.container.clientHeight) {\n                this._containerHeight = this._viewer.container.clientHeight;\n                this._svg.setAttribute('height', this._containerHeight);\n            }\n\n            var p = this._viewer.viewport.pixelFromPoint(new $.Point(0, 0), true);\n            var zoom = this._viewer.viewport.getZoom(true);\n            var rotation = this._viewer.viewport.getRotation();\n            // TODO: Expose an accessor for _containerInnerSize in the OSD API so we don't have to use the private variable.\n            var scale = this._viewer.viewport._containerInnerSize.x * zoom;\n            this._node.setAttribute('transform',\n                'translate(' + p.x + ',' + p.y + ') scale(' + scale + ') rotate(' + rotation + ')');\n        },\n\n        // ----------\n        onClick: function(node, handler) {\n            // TODO: Fast click for mobile browsers\n\n            new $.MouseTracker({\n                element: node,\n                clickHandler: handler\n            }).setTracking(true);\n        }\n    };\n\n})();\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"transkribusEditor\"}},[(_vm.xmlJsonString)?_c('Editor',{attrs:{\"iiifUrl\":_vm.iiifUrl,\"xmlJson\":_vm.toJsonObject}}):_c('Editor',{attrs:{\"iiifUrl\":_vm.iiifUrl,\"xmlJson\":_vm.xmlJson}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',[_c('b-loading',{attrs:{\"active\":!_vm.iiifUrl && !_vm.xmlJson}}),_c('TranscriptionInterfaceLocal',{attrs:{\"iiifUrl\":_vm.iiifUrl,\"xmlJson\":_vm.xmlJson,\"tags\":_vm.tags}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"hero is-fullheight-with-navbar\"},[_c('DetailEditLayout',{attrs:{\"name\":_vm.view},scopedSlots:_vm._u([{key:\"image\",fn:function(){return [(_vm.imageInfo)?_c('ImageViewer',{ref:\"viewer\",attrs:{\"source\":_vm.iiifUrl,\"width\":_vm.imageInfo.width,\"height\":_vm.imageInfo.height,\"xmlJson\":_vm.xmlJson,\"results\":_vm.results}}):_vm._e(),_c('aside',{staticClass:\"detail-image-controls-wrapper\"},[_c('ImageControls',{on:{\"input\":_vm.handleControlEvent}})],1)]},proxy:true},{key:\"content\",fn:function(){return [_c('Content',{attrs:{\"id\":\"textEditor\",\"xmlJson\":_vm.xmlJson}})]},proxy:true}])})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"is-covering\"},[(_vm.editLayoutHorizontal)?_c('Splitpanes',{staticClass:\"default-theme\",attrs:{\"horizontal\":\"\"}},[_c('Pane',{attrs:{\"id\":\"imageHorizontal\"}},[_vm._t(\"image\")],2),_c('Pane',{attrs:{\"id\":\"contentHorizontal\"}},[_vm._t(\"content\")],2)],1):_c('Splitpanes',{staticClass:\"default-theme\"},[_c('Pane',{attrs:{\"id\":\"imageVertical\"}},[_vm._t(\"image\")],2),_c('Pane',{attrs:{\"id\":\"contentVertical\"}},[_vm._t(\"content\")],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"is-covering\">\n    <Splitpanes v-if=\"editLayoutHorizontal\" horizontal class=\"default-theme\">\n      <Pane\n        id=\"imageHorizontal\"\n      >\n        <slot name=\"image\"></slot>\n      </Pane>\n      <Pane id=\"contentHorizontal\">\n        <slot name=\"content\"></slot>\n      </Pane>\n    </Splitpanes>\n    <Splitpanes v-else class=\"default-theme\">\n      <Pane id=\"imageVertical\" style=\"\">\n        <slot name=\"image\"></slot>\n      </Pane>\n      <Pane id=\"contentVertical\" style=\"\">\n        <slot name=\"content\"></slot>\n      </Pane>\n    </Splitpanes>\n  </div>\n</template>\n\n<script>\nimport { Splitpanes, Pane } from \"splitpanes\";\nimport \"splitpanes/dist/splitpanes.css\";\n\nimport { mapState } from \"vuex\";\n\nexport default {\n  components: { Splitpanes, Pane },\n  computed: {\n    ...mapState(\"content\", [\"editLayoutHorizontal\"]),\n  },\n  props: {\n    name: {\n      type: String,\n      validator: (value) => {\n        return [\"both\", \"image\", \"content\", \"edit\"].includes(value);\n      },\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailEditLayout.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailEditLayout.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailEditLayout.vue?vue&type=template&id=35ad93c0&\"\nimport script from \"./DetailEditLayout.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailEditLayout.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Layout',{scopedSlots:_vm._u([{key:\"header\",fn:function(){return undefined},proxy:true},{key:\"footer\",fn:function(){return undefined},proxy:true}])},[[_c('ContentTextEdit',{attrs:{\"xmlJson\":_vm.xmlJson}})]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"display\":\"flex\",\"flex-flow\":\"column nowrap\",\"height\":\"100%\",\"overflow\":\"hidden\",\"width\":\"100%\"}},[_c('div',[_vm._t(\"header\")],2),_vm._t(\"default\"),_vm._t(\"footer\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./DetailContentLayout.vue?vue&type=template&id=1d20946a&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.editor)?_c('div',{staticClass:\"editor\"},[_c('b-loading',{attrs:{\"active\":_vm.isLoading,\"is-full-page\":false},model:{value:(_vm.isLoading),callback:function ($$v) {_vm.isLoading=$$v},expression:\"isLoading\"}}),(_vm.editor)?_c('div',{staticClass:\"editor__header\"},[_c('b-navbar',{staticStyle:{\"width\":\"100%\",\"overflow\":\"auto\"},scopedSlots:_vm._u([{key:\"start\",fn:function(){return [_c('b-navbar-item',[_c('b-switch',{model:{value:(_vm.isAnnotation),callback:function ($$v) {_vm.isAnnotation=$$v},expression:\"isAnnotation\"}},[_vm._v(\" Annotation \")])],1)]},proxy:true},{key:\"end\",fn:function(){return [_c('b-navbar-item',[_c('b-button',{attrs:{\"title\":\"Increase font size\",\"icon-left\":\"plus\"},on:{\"click\":function($event){return _vm.setFontSize(0.1)}}}),_c('b-button',{attrs:{\"title\":\"Decrease font size\",\"icon-left\":\"minus\"},on:{\"click\":function($event){return _vm.setFontSize(-0.1)}}})],1),_c('b-navbar-item',[_c('b-button',{attrs:{\"title\":\"Switch view\",\"icon-left\":_vm.layoutIcon()},on:{\"click\":_vm.setEditLayout}}),_c('b-button',{attrs:{\"title\":\"Undo\",\"icon-left\":\"undo\"},on:{\"click\":function($event){_vm.editor.chain().focus().undo().run()}}}),_c('b-button',{attrs:{\"title\":\"Redo\",\"icon-left\":\"redo\"},on:{\"click\":function($event){_vm.editor.chain().focus().redo().run()}}})],1),_c('b-navbar-item',[_c('b-field',[_c('b-button',{attrs:{\"icon-left\":\"save\",\"type\":\"is-success\"},on:{\"click\":_vm.saveContent}},[_vm._v(\"\\n              Save\\n            \")])],1)],1)]},proxy:true}],null,false,916800163)})],1):_vm._e(),_c('div',{staticClass:\"tile editor__content\"},[(_vm.isAnnotation)?_c('div',{staticClass:\"tile is-parent is-vertical is-3\"},[(_vm.selectedTag)?_c('div',{staticClass:\"tile is-child box\"},[_c('div',_vm._l((_vm.selectedTag.marks),function(tempTag,index){return _c('div',{key:index,staticClass:\"tile is-vertical\",staticStyle:{\"width\":\"100%\"}},[(tempTag.attrs.tag)?_c('div',{staticClass:\"tile is-child\"},[_c('b-tag',{style:((\"outline-color: \" + (tempTag.attrs.color) + \" !important; outline: 2px solid; color : \" + (tempTag.attrs.color) + \" !important;margin-top: auto;margin-bottom: auto;\")),attrs:{\"icon-left\":\"tag\"}},[_vm._v(\"\\n                \"+_vm._s(tempTag.attrs.tag.name)+\"\\n              \")])],1):_vm._e(),_vm._l((_vm.findTagAttributes(tempTag)),function(attribute,i){return _c('div',{key:i,staticClass:\"tile is-child\"},[(tempTag.attrs.tag)?_c('b-field',{attrs:{\"label\":attribute,\"label-position\":\"on-border\"}},[_c('b-input',{on:{\"input\":function($event){return _vm.changeContinued(\n                      tempTag,\n                      tempTag.attrs.tag.attributes[attribute],\n                      attribute\n                    )}},model:{value:(tempTag.attrs.tag.attributes[attribute]),callback:function ($$v) {_vm.$set(tempTag.attrs.tag.attributes, attribute, $$v)},expression:\"tempTag.attrs.tag.attributes[attribute]\"}})],1):_vm._e()],1)}),(tempTag.attrs.tag)?_c('div',{staticClass:\"tile is-child\"},[_c('b-button',{attrs:{\"type\":\"is-danger\",\"icon-left\":\"trash\"},on:{\"click\":function($event){return _vm.deleteTag()}}},[_vm._v(\"\\n                Delete\\n              \")])],1):_vm._e()],2)}),0)]):_vm._e(),_c('div',{staticClass:\"tile is-child box\"},[(_vm.editor && _vm.isAnnotation && _vm.tagDefs)?_c('div',{staticClass:\"transkribusEditor-bubble-menu\",staticStyle:{\"text-align\":\"center\"}},[_c('b-button',{class:{ 'is-active': _vm.editor.isActive('bold') },attrs:{\"title\":\"Bold\",\"type\":\"is-primary\",\"icon-left\":\"bold\"},on:{\"click\":function($event){_vm.editor.chain().focus().toggleBold().run()}}}),_c('b-button',{class:{ 'is-active': _vm.editor.isActive('strike') },attrs:{\"title\":\"Strike\",\"type\":\"is-primary\",\"icon-left\":\"strikethrough\"},on:{\"click\":function($event){_vm.editor.chain().focus().toggleStrike().run()}}}),_c('b-button',{class:{ 'is-active': _vm.editor.isActive('underline') },attrs:{\"title\":\"Underline\",\"type\":\"is-primary\",\"icon-left\":\"underline\"},on:{\"click\":function($event){_vm.editor.chain().focus().toggleUnderline().run()}}}),_c('b-button',{class:{ 'is-active': _vm.editor.isActive('subscript') },attrs:{\"title\":\"Subscript\",\"type\":\"is-primary\",\"icon-left\":\"subscript\"},on:{\"click\":function($event){_vm.editor.chain().focus().toggleSub().run()}}}),_c('b-button',{class:{ 'is-active': _vm.editor.isActive('superscript') },attrs:{\"title\":\"Superscript\",\"type\":\"is-primary\",\"icon-left\":\"superscript\"},on:{\"click\":function($event){_vm.editor.chain().focus().toggleSuper().run()}}}),_c('br'),_vm._l((_vm.tagDefs.definitions.annotations),function(tag,index){return _c('b-button',{key:index,class:{\n              'is-active': _vm.editor.isActive(tag.name, {\n                color: tag.color,\n              }),\n            },style:('background-color:' + tag.color),attrs:{\"icon-left\":\"tag\"},on:{\"click\":function($event){return _vm.setAttributes(tag)}}},[_vm._v(\"\\n            \"+_vm._s(tag.label)+\"\\n          \")])})],2):_vm._e()])]):_vm._e(),_c('div',{staticClass:\"tile is-parent box\"},[_c('editor-content',{staticClass:\"editor__content\",style:({ fontSize: _vm.fontSize + 'rem' }),attrs:{\"editor\":_vm.editor}})],1)])],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('node-view-wrapper',{staticClass:\"region\"},[_c('node-view-content',{staticClass:\"content\"})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <node-view-wrapper class=\"region\">\n    <!-- <span v-if=\"this.node.attrs.lines.attributes.id\" class=\"label\">Region {{ this.node.attrs.lines.attributes.id }}</span> -->\n    <node-view-content class=\"content\"> </node-view-content>\n  </node-view-wrapper>\n</template>\n\n<script>\nimport { NodeViewWrapper, NodeViewContent, nodeViewProps } from \"@tiptap/vue-2\";\n\nexport default {\n  components: {\n    NodeViewWrapper,\n    NodeViewContent,\n  },\n\n  props: nodeViewProps,\n\n  selectable: false,\n};\n</script>\n\n<style lang=\"scss\" scoped>\n// .region {\n//   background: #e1ebee;\n//   border: 1px solid #0d0d0d;\n//   border-radius: 0.5rem;\n//   margin: 1rem 0;\n//   position: relative;\n// }\n\n// .label {\n//   margin-left: 1rem;\n//   background-color: #0d0d0d;\n//   font-size: 0.6rem;\n//   letter-spacing: 1px;\n//   font-weight: bold;\n//   text-transform: uppercase;\n//   color: #fff;\n//   position: absolute;\n//   top: 0;\n//   padding: 0.25rem 0.75rem;\n//   border-radius: 0 0 0.5rem 0.5rem;\n// }\n\n// .content {\n//   // margin-top: 1.5rem;\n//   padding: 0.3rem;\n// }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RegionNode.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RegionNode.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RegionNode.vue?vue&type=template&id=90ae8d76&scoped=true&\"\nimport script from \"./RegionNode.vue?vue&type=script&lang=js&\"\nexport * from \"./RegionNode.vue?vue&type=script&lang=js&\"\nimport style0 from \"./RegionNode.vue?vue&type=style&index=0&id=90ae8d76&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"90ae8d76\",\n  null\n  \n)\n\nexport default component.exports","import { Node, mergeAttributes } from '@tiptap/core'\nimport { VueNodeViewRenderer } from '@tiptap/vue-2'\nimport Component from './RegionNode.vue'\nimport { Plugin, PluginKey } from 'prosemirror-state'\n\n\nexport default Node.create({\n  name: 'region',\n\n  group: 'block',\n  selectable: false,\n  content: '(line+ | table+)',  \n\n  addAttributes() {\n    return {\n      lines: {\n        default: [],\n      },\n      number: {\n        default: 0,\n      },\n    }\n  },\n  addProseMirrorPlugins() {\n    return [\n      new Plugin({\n        props: {\n          handleKeyDown: (view, event) => {\n            if (event.which === 8 || event.which === 46) {\n              view.state.deleting = true\n            }\n            return false\n          }\n        },\n\n        filterTransaction: (transaction, state) => {\n          if (!state.deleting) {\n            return true\n          }\n\n          var result = true\n          let count = 0\n          transaction.mapping.maps.forEach(map => {\n            map.forEach((oldStart, oldEnd, newStart, newEnd) => {\n              state.doc.nodesBetween(\n                oldStart,\n                oldEnd,\n                (node, number, pos, parent, index) => {\n                  if (node.type.name === 'region') {\n                    count++\n                  }\n                }\n              )\n            })\n          })\n          if (count > 1) {\n            result = false\n          }\n          return result\n        }\n      })\n    ]\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: 'div',\n      },\n    ]\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return ['div', mergeAttributes(HTMLAttributes)]\n  },\n\n  addNodeView() {\n    return VueNodeViewRenderer(Component)\n  },\n})","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (this.node.attrs.line.attributes)?_c('node-view-wrapper',{staticClass:\"line\"},[_c('div',{on:{\"click\":function($event){return _vm.onMouseClick(_vm.node.attrs.line.attributes.id)},\"mouseout\":function($event){return _vm.onMouseOut(_vm.node.attrs.line.attributes.id)},\"mouseover\":function($event){return _vm.onMouseOver(_vm.node.attrs.line.attributes.id)}}},[_c('node-view-content',{attrs:{\"id\":this.node.attrs.line.attributes.id}})],1)]):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <node-view-wrapper v-if=\"this.node.attrs.line.attributes\" class=\"line\">\n    <!-- <div\n    @mouseout=\"onMouseOut(node.attrs.line.attributes.id)\" @mouseover=\"onMouseOver(node.attrs.line.attributes.id)\"\n      class=\"drag-handle\"\n      contenteditable=\"false\"\n      draggable=\"true\"\n      data-drag-handle\n    /> -->\n    <div\n      @click=\"onMouseClick(node.attrs.line.attributes.id)\"\n      @mouseout=\"onMouseOut(node.attrs.line.attributes.id)\"\n      @mouseover=\"onMouseOver(node.attrs.line.attributes.id)\"\n    >\n      <node-view-content :id=\"this.node.attrs.line.attributes.id\">\n      </node-view-content>\n    </div>\n  </node-view-wrapper>\n</template>\n\n<script>\nimport { NodeViewWrapper, NodeViewContent, nodeViewProps } from '@tiptap/vue-2'\nimport { mapState } from 'vuex'\n\nexport default {\n  components: {\n    NodeViewWrapper,\n    NodeViewContent\n  },\n  methods: {\n    highlight(id) {\n      this.$store.dispatch('content/highlight', {\n        target: id,\n        origin: 'content'\n      })\n    },\n    select(id) {\n      this.$store.dispatch('content/select', {\n        target: id,\n        origin: 'content'\n      })\n    },\n    onMouseOver(id) {\n      this.highlight(id)\n    },\n    onMouseOut(id) {\n      this.highlight(id)\n    },\n    onMouseClick(id) {\n      this.select(id)\n    }\n  },\n\n  props: nodeViewProps\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LineNode.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LineNode.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LineNode.vue?vue&type=template&id=3a71c82c&\"\nimport script from \"./LineNode.vue?vue&type=script&lang=js&\"\nexport * from \"./LineNode.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default {\n  // imageBaseUrl: 'https://dbis-thure.uibk.ac.at/iiif/2',\n  // imageBaseUrl: 'https://files-test.transkribus.eu/iiif/2',\n  urls: {\n    image: \"https://files.transkribus.eu/iiif/2\",\n    xml: \"https://files.transkribus.eu/Get?id=\",\n  },\n  hashidsSecret: \"1234\",\n  token: \"\",\n  transcriptionURL: \"https://transkribus.eu/r/testing/sandbox/application/\",\n  searchApiBaseUrl: \"https://transkribus.eu/r/zQPlDb1ZvVWJuiBU/api/v0\",\n  apiBaseUrl: \"https://transkribus.eu/TrpServerTesting/rest\",\n  contactEmail: \"info@readcoop.eu\",\n  bugEmail: \"bugs@readcoop.eu\",\n  bugtrackerUrl:\n    \"incoming+readcoop-webdev-public-transkribuslite-25175868-issue-@incoming.gitlab.com\",\n  repo: \"https://gitlab.com/readcoop/webdev/public/transkribuslite\",\n  consentCookie: \"cookieaccepted\",\n  recordSession: true,\n};\n","import deepEqual from \"fast-deep-equal\";\nimport { fetchPageContent, fetchPageContentXML } from \"@/utils/api.js\";\nconst json = require(\"../../assets/page1.json\");\nconst xml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><PcGts xmlns=\"http://schema.primaresearch.org/PAGE/gts/pagecontent/2013-07-15\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://schema.primaresearch.org/PAGE/gts/pagecontent/2013-07-15 http://schema.primaresearch.org/PAGE/gts/pagecontent/2013-07-15/pagecontent.xsd\">    <Metadata>        <Creator>Transkribus Processing API</Creator>        <Created>2022-09-16T11:33:20.628+02:00</Created>        <LastChange>2022-09-16T11:33:30.707+02:00</LastChange>    </Metadata>    <Page imageFilename=\"orig_proc-api-a8731fcb-c81e-445d-8cc8-4fc852a1b79e.jpg\" imageWidth=\"1500\" imageHeight=\"2212\">        <ReadingOrder>            <OrderedGroup id=\"ro_1663320826176\" caption=\"Regions reading order\">                <RegionRefIndexed index=\"0\" regionRef=\"r1\"/>                <RegionRefIndexed index=\"1\" regionRef=\"r2\"/>            </OrderedGroup>        </ReadingOrder>        <TextRegion orientation=\"0.0\" id=\"r1\" custom=\"readingOrder {index:0}\">            <Coords points=\"59,437 59,2153 1453,2153 1453,437\"/>            <TextLine id=\"r1l1\" custom=\"readingOrder {index:0}\">                <Coords points=\"352,493 361,493 372,504 378,499 398,500 422,521 452,533 456,434 435,437 416,424 409,428 399,420 384,425 355,417\"/>                <Baseline points=\"361,490 389,493 417,495 445,492\"/>                <TextEquiv>                    <Unicode> </Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l2\" custom=\"readingOrder {index:1}\">                <Coords points=\"982,517 1046,509 1066,527 1090,516 1102,527 1173,530 1209,520 1227,529 1240,418 1221,425 1182,415 1159,431 1104,372 1070,366 1024,382 999,374\"/>                <Baseline points=\"995,488 1020,486 1045,485 1070,485 1095,487 1120,491 1145,495 1170,500 1195,507 1221,514\"/>                <Word id=\"r1l2_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>6</Unicode>                    <TextEquiv>                        <Unicode>6</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>6</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l3\" custom=\"readingOrder {index:2}\">                <Coords points=\"735,589 749,586 755,582 760,572 768,569 732,472 723,478 717,476 710,483 704,481 696,484\"/>                <Baseline points=\"740,578 759,571\"/>                <TextEquiv>                    <Unicode> </Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l4\" custom=\"readingOrder {index:3}\">                <Coords points=\"693,716 702,716 752,689 775,693 787,683 801,685 802,616 794,616 782,606 777,609 765,605 746,594 715,609 696,607\"/>                <Baseline points=\"703,674 732,673 762,675 792,675\"/>                <TextEquiv>                    <Unicode> </Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l5\" custom=\"readingOrder {index:4}\">                <Coords points=\"871,748 881,745 890,748 897,738 923,734 905,576 851,577\"/>                <Baseline points=\"875,712 911,708\"/>                <TextEquiv>                    <Unicode> </Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l6\" custom=\"readingOrder {index:5}\">                <Coords points=\"65,788 79,785 97,800 100,799 106,804 116,803 110,714 101,715 90,726 83,725 80,721 71,729 61,730\"/>                <Baseline points=\"74,782 106,780\"/>                <Word id=\"r1l6_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>1</Unicode>                    <TextEquiv>                        <Unicode>1</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>1</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l7\" custom=\"readingOrder {index:6}\">                <Coords points=\"670,964 1050,934 1346,949 1364,875 1244,801 1156,801 1064,852 963,799 914,831 765,797 671,834\"/>                <Baseline points=\"679,931 712,929 746,928 780,927 814,926 848,925 881,925 915,924 949,924 983,925 1017,925 1050,925 1084,926 1118,927 1152,928 1185,929 1219,930 1253,931 1287,932 1321,934 1355,935\"/>                <Word id=\"r1l7_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>Tutti Frutti</Unicode>                    <TextEquiv>                        <Unicode>Alli</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l7_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"956,887 956,947 1314,947 1314,887\"/>                    <TextEquiv>                        <Unicode>Frulli</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>Alli Frulli</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l8\" custom=\"readingOrder {index:7}\">                <Coords points=\"59,1099 76,1096 83,1101 93,1092 100,1097 121,1098 117,1005 103,1004 71,1035 56,1035\"/>                <Baseline points=\"67,1067 111,1065\"/>                <TextEquiv>                    <Unicode> </Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l9\" custom=\"readingOrder {index:8}\">                <Coords points=\"661,1124 793,1075 904,1106 1030,1082 1149,1111 1241,1081 1395,1107 1442,1097 1444,1008 1026,1036 966,1002 746,993 663,1032\"/>                <Baseline points=\"671,1067 709,1067 747,1067 785,1067 823,1067 861,1068 899,1068 937,1069 975,1069 1013,1070 1052,1071 1090,1071 1128,1072 1166,1073 1204,1074 1242,1075 1280,1076 1318,1077 1356,1078 1394,1080 1433,1082\"/>                <Word id=\"r1l9_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>EGekookle ef geconsijle vrucht en doet men</Unicode>                    <TextEquiv>                        <Unicode>EGekookle</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l9_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"916,1028 916,1088 943,1088 943,1028\"/>                    <TextEquiv>                        <Unicode>ef</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l9_w3\" custom=\"readingOrder {index:2}\">                    <Coords points=\"964,1030 964,1090 1118,1090 1118,1030\"/>                    <TextEquiv>                        <Unicode>geconsijle</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l9_w4\" custom=\"readingOrder {index:3}\">                    <Coords points=\"1139,1033 1139,1093 1230,1093 1230,1033\"/>                    <TextEquiv>                        <Unicode>vrucht</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l9_w5\" custom=\"readingOrder {index:4}\">                    <Coords points=\"1237,1035 1237,1095 1264,1095 1264,1035\"/>                    <TextEquiv>                        <Unicode>en</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l9_w6\" custom=\"readingOrder {index:5}\">                    <Coords points=\"1293,1037 1293,1097 1362,1097 1362,1037\"/>                    <TextEquiv>                        <Unicode>doet</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l9_w7\" custom=\"readingOrder {index:6}\">                    <Coords points=\"1377,1040 1377,1100 1432,1100 1432,1040\"/>                    <TextEquiv>                        <Unicode>men</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>EGekookle ef geconsijle vrucht en doet men</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l10\" custom=\"readingOrder {index:9}\">                <Coords points=\"613,1168 627,1168 641,1175 644,1171 661,1171 661,1054 653,1054 639,1044 632,1051 613,1054\"/>                <Baseline points=\"622,1164 652,1164\"/>                <TextEquiv>                    <Unicode> </Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l11\" custom=\"readingOrder {index:10}\">                <Coords points=\"656,1196 1280,1220 1389,1175 1456,1187 1437,1127 657,1125\"/>                <Baseline points=\"665,1164 704,1164 743,1164 782,1165 821,1165 860,1165 899,1165 939,1165 978,1166 1017,1166 1056,1166 1095,1167 1134,1167 1173,1167 1213,1168 1252,1168 1291,1169 1330,1169 1369,1170 1408,1170 1448,1171\"/>                <Word id=\"r1l11_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>een scholel, hodal zeeersl goed kous zijn gewwr¬</Unicode>                    <TextEquiv>                        <Unicode>een</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l11_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"733,1125 733,1185 847,1185 847,1125\"/>                    <TextEquiv>                        <Unicode>scholel,</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l11_w3\" custom=\"readingOrder {index:2}\">                    <Coords points=\"864,1125 864,1185 957,1185 957,1125\"/>                    <TextEquiv>                        <Unicode>hodal</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l11_w4\" custom=\"readingOrder {index:3}\">                    <Coords points=\"973,1126 973,1186 1077,1186 1077,1126\"/>                    <TextEquiv>                        <Unicode>zeeersl</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l11_w5\" custom=\"readingOrder {index:4}\">                    <Coords points=\"1088,1127 1088,1187 1159,1187 1159,1127\"/>                    <TextEquiv>                        <Unicode>goed</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l11_w6\" custom=\"readingOrder {index:5}\">                    <Coords points=\"1181,1128 1181,1188 1258,1188 1258,1128\"/>                    <TextEquiv>                        <Unicode>kous</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l11_w7\" custom=\"readingOrder {index:6}\">                    <Coords points=\"1279,1129 1279,1189 1334,1189 1334,1129\"/>                    <TextEquiv>                        <Unicode>zijn</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l11_w8\" custom=\"readingOrder {index:7}\">                    <Coords points=\"1361,1130 1361,1190 1459,1190 1459,1130\"/>                    <TextEquiv>                        <Unicode>gewwr¬</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>een scholel, hodal zeeersl goed kous zijn gewwr¬</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l12\" custom=\"readingOrder {index:11}\">                <Coords points=\"585,1306 635,1314 715,1268 858,1293 1400,1282 1400,1229 1247,1206 1063,1235 872,1208 779,1237 586,1175\"/>                <Baseline points=\"594,1260 633,1261 673,1261 713,1261 753,1261 793,1262 833,1262 873,1262 913,1262 953,1263 993,1263 1032,1263 1072,1263 1112,1263 1152,1263 1192,1263 1232,1263 1272,1263 1312,1263 1352,1262 1392,1262\"/>                <Word id=\"r1l12_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>Een daarna belagt men zo mel billerkoeljes el</Unicode>                    <TextEquiv>                        <Unicode>Een</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l12_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"712,1221 712,1281 809,1281 809,1221\"/>                    <TextEquiv>                        <Unicode>daarna</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l12_w3\" custom=\"readingOrder {index:2}\">                    <Coords points=\"825,1222 825,1282 931,1282 931,1222\"/>                    <TextEquiv>                        <Unicode>belagt</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l12_w4\" custom=\"readingOrder {index:3}\">                    <Coords points=\"947,1223 947,1283 1003,1283 1003,1223\"/>                    <TextEquiv>                        <Unicode>men</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l12_w5\" custom=\"readingOrder {index:4}\">                    <Coords points=\"1028,1223 1028,1283 1052,1283 1052,1223\"/>                    <TextEquiv>                        <Unicode>zo</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l12_w6\" custom=\"readingOrder {index:5}\">                    <Coords points=\"1076,1223 1076,1283 1133,1283 1133,1223\"/>                    <TextEquiv>                        <Unicode>mel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l12_w7\" custom=\"readingOrder {index:6}\">                    <Coords points=\"1149,1223 1149,1283 1353,1283 1353,1223\"/>                    <TextEquiv>                        <Unicode>billerkoeljes</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l12_w8\" custom=\"readingOrder {index:7}\">                    <Coords points=\"1369,1222 1369,1282 1401,1282 1401,1222\"/>                    <TextEquiv>                        <Unicode>el</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>Een daarna belagt men zo mel billerkoeljes el</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l13\" custom=\"readingOrder {index:12}\">                <Coords points=\"66,1365 119,1356 159,1376 206,1356 226,1371 286,1362 355,1386 388,1363 426,1367 428,1269 392,1270 333,1313 267,1306 238,1323 180,1300 160,1317 120,1318 68,1294\"/>                <Baseline points=\"74,1351 100,1350 126,1350 153,1351 179,1351 205,1352 232,1353 258,1354 285,1355 311,1356 337,1357 364,1357 390,1357 417,1357\"/>                <Word id=\"r1l13_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>biseris de Bargge</Unicode>                    <TextEquiv>                        <Unicode>biseris</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l13_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"214,1312 214,1372 247,1372 247,1312\"/>                    <TextEquiv>                        <Unicode>de</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l13_w3\" custom=\"readingOrder {index:2}\">                    <Coords points=\"267,1316 267,1376 394,1376 394,1316\"/>                    <TextEquiv>                        <Unicode>Bargge</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>biseris de Bargge</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l14\" custom=\"readingOrder {index:13}\">                <Coords points=\"650,1364 877,1368 917,1395 1341,1370 1461,1394 1462,1336 1408,1323 651,1312\"/>                <Baseline points=\"659,1356 698,1357 738,1357 778,1358 817,1359 857,1359 897,1360 936,1361 976,1361 1016,1362 1056,1362 1095,1363 1135,1363 1175,1364 1214,1364 1254,1364 1294,1365 1333,1365 1373,1365 1413,1365 1453,1366\"/>                <Word id=\"r1l14_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>Boel dan in een pan 1½ lopel sijne wille suiker,</Unicode>                    <TextEquiv>                        <Unicode>Boel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l14_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"778,1318 778,1378 832,1378 832,1318\"/>                    <TextEquiv>                        <Unicode>dan</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l14_w3\" custom=\"readingOrder {index:2}\">                    <Coords points=\"858,1319 858,1379 879,1379 879,1319\"/>                    <TextEquiv>                        <Unicode>in</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l14_w4\" custom=\"readingOrder {index:3}\">                    <Coords points=\"901,1320 901,1380 948,1380 948,1320\"/>                    <TextEquiv>                        <Unicode>een</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l14_w5\" custom=\"readingOrder {index:4}\">                    <Coords points=\"970,1321 970,1381 1024,1381 1024,1321\"/>                    <TextEquiv>                        <Unicode>pan</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l14_w6\" custom=\"readingOrder {index:5}\">                    <Coords points=\"1050,1322 1050,1382 1076,1382 1076,1322\"/>                    <TextEquiv>                        <Unicode>1½</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l14_w7\" custom=\"readingOrder {index:6}\">                    <Coords points=\"1098,1323 1098,1383 1178,1383 1178,1323\"/>                    <TextEquiv>                        <Unicode>lopel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l14_w8\" custom=\"readingOrder {index:7}\">                    <Coords points=\"1199,1324 1199,1384 1263,1384 1263,1324\"/>                    <TextEquiv>                        <Unicode>sijne</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l14_w9\" custom=\"readingOrder {index:8}\">                    <Coords points=\"1285,1325 1285,1385 1359,1385 1359,1325\"/>                    <TextEquiv>                        <Unicode>wille</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l14_w10\" custom=\"readingOrder {index:9}\">                    <Coords points=\"1375,1325 1375,1385 1466,1385 1466,1325\"/>                    <TextEquiv>                        <Unicode>suiker,</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>Boel dan in een pan 1½ lopel sijne wille suiker,</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l15\" custom=\"readingOrder {index:14}\">                <Coords points=\"65,1474 225,1484 298,1459 401,1487 443,1474 466,1497 561,1516 562,1429 525,1420 411,1418 389,1402 328,1427 232,1403 130,1425 66,1414\"/>                <Baseline points=\"75,1452 100,1452 125,1452 150,1452 175,1453 201,1453 226,1454 251,1454 276,1455 301,1455 327,1456 352,1456 377,1457 402,1457 427,1458 453,1458 478,1458 503,1459 528,1459 554,1459\"/>                <Word id=\"r1l15_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>een lepel bloem een halt pijpje</Unicode>                    <TextEquiv>                        <Unicode>een</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l15_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"139,1413 139,1473 216,1473 216,1413\"/>                    <TextEquiv>                        <Unicode>lepel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l15_w3\" custom=\"readingOrder {index:2}\">                    <Coords points=\"231,1414 231,1474 301,1474 301,1414\"/>                    <TextEquiv>                        <Unicode>bloem</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l15_w4\" custom=\"readingOrder {index:3}\">                    <Coords points=\"339,1416 339,1476 385,1476 385,1416\"/>                    <TextEquiv>                        <Unicode>een</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l15_w5\" custom=\"readingOrder {index:4}\">                    <Coords points=\"401,1418 401,1478 463,1478 463,1418\"/>                    <TextEquiv>                        <Unicode>halt</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l15_w6\" custom=\"readingOrder {index:5}\">                    <Coords points=\"471,1419 471,1479 563,1479 563,1419\"/>                    <TextEquiv>                        <Unicode>pijpje</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>een lepel bloem een halt pijpje</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l16\" custom=\"readingOrder {index:15}\">                <Coords points=\"590,1482 684,1498 781,1468 991,1502 1179,1470 1354,1500 1423,1486 1424,1436 1035,1411 841,1434 756,1397 643,1429 590,1397\"/>                <Baseline points=\"598,1457 638,1458 679,1458 720,1459 761,1459 802,1460 842,1460 883,1460 924,1461 965,1461 1006,1461 1046,1462 1087,1462 1128,1462 1169,1463 1210,1463 1250,1463 1291,1464 1332,1464 1373,1465 1414,1465\"/>                <Word id=\"r1l16_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>vannille ende Doyers van drie cieren; roer</Unicode>                    <TextEquiv>                        <Unicode>vannille</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l16_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"842,1420 842,1480 915,1480 915,1420\"/>                    <TextEquiv>                        <Unicode>ende</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l16_w3\" custom=\"readingOrder {index:2}\">                    <Coords points=\"933,1421 933,1481 1031,1481 1031,1421\"/>                    <TextEquiv>                        <Unicode>Doyers</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l16_w4\" custom=\"readingOrder {index:3}\">                    <Coords points=\"1049,1422 1049,1482 1098,1482 1098,1422\"/>                    <TextEquiv>                        <Unicode>van</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l16_w5\" custom=\"readingOrder {index:4}\">                    <Coords points=\"1129,1422 1129,1482 1177,1482 1177,1422\"/>                    <TextEquiv>                        <Unicode>drie</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l16_w6\" custom=\"readingOrder {index:5}\">                    <Coords points=\"1208,1423 1208,1483 1342,1483 1342,1423\"/>                    <TextEquiv>                        <Unicode>cieren;</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l16_w7\" custom=\"readingOrder {index:6}\">                    <Coords points=\"1354,1425 1354,1485 1415,1485 1415,1425\"/>                    <TextEquiv>                        <Unicode>roer</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>vannille ende Doyers van drie cieren; roer</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l17\" custom=\"readingOrder {index:16}\">                <Coords points=\"53,1589 1447,1605 1448,1534 1285,1513 218,1530 55,1489\"/>                <Baseline points=\"62,1545 130,1548 199,1550 268,1552 337,1554 406,1555 475,1557 543,1558 612,1559 681,1560 750,1561 819,1561 888,1562 957,1563 1025,1564 1094,1564 1163,1565 1232,1566 1301,1567 1370,1568 1439,1570\"/>                <Word id=\"r1l17_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>dit alles goed booreen; menghe Thel aan mel drie hierglazen koude melk of room</Unicode>                    <TextEquiv>                        <Unicode>dit</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"125,1508 125,1568 193,1568 193,1508\"/>                    <TextEquiv>                        <Unicode>alles</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w3\" custom=\"readingOrder {index:2}\">                    <Coords points=\"224,1511 224,1571 286,1571 286,1511\"/>                    <TextEquiv>                        <Unicode>goed</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w4\" custom=\"readingOrder {index:3}\">                    <Coords points=\"322,1514 322,1574 467,1574 467,1514\"/>                    <TextEquiv>                        <Unicode>booreen;</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w5\" custom=\"readingOrder {index:4}\">                    <Coords points=\"478,1517 478,1577 581,1577 581,1517\"/>                    <TextEquiv>                        <Unicode>menghe</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w6\" custom=\"readingOrder {index:5}\">                    <Coords points=\"628,1519 628,1579 701,1579 701,1519\"/>                    <TextEquiv>                        <Unicode>Thel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w7\" custom=\"readingOrder {index:6}\">                    <Coords points=\"716,1520 716,1580 757,1580 757,1520\"/>                    <TextEquiv>                        <Unicode>aan</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w8\" custom=\"readingOrder {index:7}\">                    <Coords points=\"783,1521 783,1581 835,1581 835,1521\"/>                    <TextEquiv>                        <Unicode>mel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w9\" custom=\"readingOrder {index:8}\">                    <Coords points=\"861,1522 861,1582 918,1582 918,1522\"/>                    <TextEquiv>                        <Unicode>drie</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w10\" custom=\"readingOrder {index:9}\">                    <Coords points=\"944,1523 944,1583 1105,1583 1105,1523\"/>                    <TextEquiv>                        <Unicode>hierglazen</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w11\" custom=\"readingOrder {index:10}\">                    <Coords points=\"1136,1525 1136,1585 1229,1585 1229,1525\"/>                    <TextEquiv>                        <Unicode>koude</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w12\" custom=\"readingOrder {index:11}\">                    <Coords points=\"1245,1526 1245,1586 1307,1586 1307,1526\"/>                    <TextEquiv>                        <Unicode>melk</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w13\" custom=\"readingOrder {index:12}\">                    <Coords points=\"1327,1527 1327,1587 1354,1587 1354,1527\"/>                    <TextEquiv>                        <Unicode>of</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l17_w14\" custom=\"readingOrder {index:13}\">                    <Coords points=\"1374,1528 1374,1588 1431,1588 1431,1528\"/>                    <TextEquiv>                        <Unicode>room</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>dit alles goed booreen; menghe Thel aan mel drie hierglazen koude melk of room</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l18\" custom=\"readingOrder {index:17}\">                <Coords points=\"49,1666 1395,1672 1380,1617 50,1602\"/>                <Baseline points=\"59,1652 125,1654 191,1655 258,1656 324,1657 390,1658 457,1659 523,1660 589,1661 656,1661 722,1662 788,1662 855,1662 921,1663 987,1663 1054,1664 1120,1664 1186,1665 1253,1665 1319,1666 1386,1667\"/>                <Word id=\"r1l18_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>zel hel op het vuur, voer hel goet volsal hel korkl en giet hel warm op de</Unicode>                    <TextEquiv>                        <Unicode>zel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"118,1614 118,1674 165,1674 165,1614\"/>                    <TextEquiv>                        <Unicode>hel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w3\" custom=\"readingOrder {index:2}\">                    <Coords points=\"191,1615 191,1675 213,1675 213,1615\"/>                    <TextEquiv>                        <Unicode>op</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w4\" custom=\"readingOrder {index:3}\">                    <Coords points=\"240,1616 240,1676 287,1676 287,1616\"/>                    <TextEquiv>                        <Unicode>het</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w5\" custom=\"readingOrder {index:4}\">                    <Coords points=\"303,1617 303,1677 393,1677 393,1617\"/>                    <TextEquiv>                        <Unicode>vuur,</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w6\" custom=\"readingOrder {index:5}\">                    <Coords points=\"409,1618 409,1678 467,1678 467,1618\"/>                    <TextEquiv>                        <Unicode>voer</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w7\" custom=\"readingOrder {index:6}\">                    <Coords points=\"493,1619 493,1679 546,1679 546,1619\"/>                    <TextEquiv>                        <Unicode>hel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w8\" custom=\"readingOrder {index:7}\">                    <Coords points=\"568,1621 568,1681 636,1681 636,1621\"/>                    <TextEquiv>                        <Unicode>goet</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w9\" custom=\"readingOrder {index:8}\">                    <Coords points=\"668,1621 668,1681 774,1681 774,1621\"/>                    <TextEquiv>                        <Unicode>volsal</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w10\" custom=\"readingOrder {index:9}\">                    <Coords points=\"801,1622 801,1682 848,1682 848,1622\"/>                    <TextEquiv>                        <Unicode>hel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w11\" custom=\"readingOrder {index:10}\">                    <Coords points=\"874,1622 874,1682 965,1682 965,1622\"/>                    <TextEquiv>                        <Unicode>korkl</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w12\" custom=\"readingOrder {index:11}\">                    <Coords points=\"996,1623 996,1683 1018,1683 1018,1623\"/>                    <TextEquiv>                        <Unicode>en</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w13\" custom=\"readingOrder {index:12}\">                    <Coords points=\"1044,1624 1044,1684 1103,1684 1103,1624\"/>                    <TextEquiv>                        <Unicode>giet</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w14\" custom=\"readingOrder {index:13}\">                    <Coords points=\"1124,1624 1124,1684 1166,1684 1166,1624\"/>                    <TextEquiv>                        <Unicode>hel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w15\" custom=\"readingOrder {index:14}\">                    <Coords points=\"1187,1625 1187,1685 1267,1685 1267,1625\"/>                    <TextEquiv>                        <Unicode>warm</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w16\" custom=\"readingOrder {index:15}\">                    <Coords points=\"1304,1625 1304,1685 1325,1685 1325,1625\"/>                    <TextEquiv>                        <Unicode>op</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l18_w17\" custom=\"readingOrder {index:16}\">                    <Coords points=\"1351,1626 1351,1686 1377,1686 1377,1626\"/>                    <TextEquiv>                        <Unicode>de</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>zel hel op het vuur, voer hel goet volsal hel korkl en giet hel warm op de</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l19\" custom=\"readingOrder {index:18}\">                <Coords points=\"55,1766 768,1812 1383,1773 1284,1711 55,1704\"/>                <Baseline points=\"64,1755 129,1757 195,1758 260,1759 326,1760 391,1761 457,1762 522,1762 588,1763 653,1763 719,1763 784,1764 850,1764 915,1764 981,1764 1046,1765 1112,1765 1177,1765 1243,1765 1308,1766 1374,1766\"/>                <Word id=\"r1l19_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>billerkoekjes waarmete de vruchten belegd zijn. Een lepel Rhun er door</Unicode>                    <TextEquiv>                        <Unicode>billerkoekjes</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l19_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"283,1720 283,1780 471,1780 471,1720\"/>                    <TextEquiv>                        <Unicode>waarmete</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l19_w3\" custom=\"readingOrder {index:2}\">                    <Coords points=\"505,1722 505,1782 539,1782 539,1722\"/>                    <TextEquiv>                        <Unicode>de</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l19_w4\" custom=\"readingOrder {index:3}\">                    <Coords points=\"568,1723 568,1783 693,1783 693,1723\"/>                    <TextEquiv>                        <Unicode>vruchten</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l19_w5\" custom=\"readingOrder {index:4}\">                    <Coords points=\"715,1723 715,1783 812,1783 812,1723\"/>                    <TextEquiv>                        <Unicode>belegd</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l19_w6\" custom=\"readingOrder {index:5}\">                    <Coords points=\"840,1724 840,1784 920,1784 920,1724\"/>                    <TextEquiv>                        <Unicode>zijn.</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l19_w7\" custom=\"readingOrder {index:6}\">                    <Coords points=\"931,1724 931,1784 989,1784 989,1724\"/>                    <TextEquiv>                        <Unicode>Een</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l19_w8\" custom=\"readingOrder {index:7}\">                    <Coords points=\"1011,1725 1011,1785 1097,1785 1097,1725\"/>                    <TextEquiv>                        <Unicode>lepel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l19_w9\" custom=\"readingOrder {index:8}\">                    <Coords points=\"1119,1725 1119,1785 1205,1785 1205,1725\"/>                    <TextEquiv>                        <Unicode>Rhun</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l19_w10\" custom=\"readingOrder {index:9}\">                    <Coords points=\"1244,1725 1244,1785 1278,1785 1278,1725\"/>                    <TextEquiv>                        <Unicode>er</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l19_w11\" custom=\"readingOrder {index:10}\">                    <Coords points=\"1301,1726 1301,1786 1364,1786 1364,1726\"/>                    <TextEquiv>                        <Unicode>door</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>billerkoekjes waarmete de vruchten belegd zijn. Een lepel Rhun er door</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l20\" custom=\"readingOrder {index:19}\">                <Coords points=\"59,1887 264,1866 629,1907 738,1882 991,1920 971,1813 819,1834 733,1796 590,1831 459,1800 311,1837 60,1807\"/>                <Baseline points=\"68,1859 113,1860 159,1860 205,1861 251,1861 296,1862 342,1863 388,1863 434,1864 479,1864 525,1864 571,1865 617,1865 662,1865 708,1866 754,1866 800,1866 845,1866 891,1866 937,1866 983,1866\"/>                <Word id=\"r1l20_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>verhoogt den smank. Hel wordt kand gegeten.</Unicode>                    <TextEquiv>                        <Unicode>verhoogt</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l20_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"234,1821 234,1881 288,1881 288,1821\"/>                    <TextEquiv>                        <Unicode>den</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l20_w3\" custom=\"readingOrder {index:2}\">                    <Coords points=\"309,1823 309,1883 448,1883 448,1823\"/>                    <TextEquiv>                        <Unicode>smank.</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l20_w4\" custom=\"readingOrder {index:3}\">                    <Coords points=\"479,1824 479,1884 544,1884 544,1824\"/>                    <TextEquiv>                        <Unicode>Hel</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l20_w5\" custom=\"readingOrder {index:4}\">                    <Coords points=\"559,1825 559,1885 666,1885 666,1825\"/>                    <TextEquiv>                        <Unicode>wordt</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l20_w6\" custom=\"readingOrder {index:5}\">                    <Coords points=\"692,1826 692,1886 772,1886 772,1826\"/>                    <TextEquiv>                        <Unicode>kand</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l20_w7\" custom=\"readingOrder {index:6}\">                    <Coords points=\"799,1826 799,1886 953,1886 953,1826\"/>                    <TextEquiv>                        <Unicode>gegeten.</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>verhoogt den smank. Hel wordt kand gegeten.</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l21\" custom=\"readingOrder {index:20}\">                <Coords points=\"919,2097 989,2076 1122,2090 1161,2071 1218,2093 1365,2070 1427,2110 1454,2103 1454,2020 1359,2001 1259,2019 1227,1995 1153,2030 1092,1994 1029,2020 918,2009\"/>                <Baseline points=\"927,2072 952,2071 978,2070 1004,2069 1030,2069 1056,2068 1082,2068 1108,2068 1134,2068 1160,2068 1186,2068 1211,2068 1237,2068 1263,2068 1289,2069 1315,2068 1341,2068 1367,2068 1393,2068 1419,2067 1445,2066\"/>                <Word id=\"r1l21_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>Arnaldine Swaving</Unicode>                    <TextEquiv>                        <Unicode>Arnaldine</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l21_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"1207,2028 1207,2088 1437,2088 1437,2028\"/>                    <TextEquiv>                        <Unicode>Swaving</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>Arnaldine Swaving</Unicode>                </TextEquiv>            </TextLine>            <TextLine id=\"r1l22\" custom=\"readingOrder {index:21}\">                <Coords points=\"1146,2165 1175,2165 1205,2142 1222,2149 1274,2137 1294,2156 1317,2152 1325,2159 1353,2149 1353,2087 1330,2090 1298,2078 1241,2108 1222,2096 1184,2101 1168,2089 1146,2092\"/>                <Baseline points=\"1155,2134 1182,2136 1209,2137 1236,2137 1263,2135 1290,2135 1317,2135 1344,2137\"/>                <Word id=\"r1l22_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>Pr. H.</Unicode>                    <TextEquiv>                        <Unicode>Pr.</Unicode>                    </TextEquiv>                </Word>                <Word id=\"r1l22_w2\" custom=\"readingOrder {index:1}\">                    <Coords points=\"1288,2095 1288,2155 1355,2155 1355,2095\"/>                    <TextEquiv>                        <Unicode>H.</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>Pr. H.</Unicode>                </TextEquiv>            </TextLine>            <TextEquiv>                <Unicode/>            </TextEquiv>        </TextRegion>        <TextRegion orientation=\"0.0\" id=\"r2\" custom=\"readingOrder {index:1}\">            <Coords points=\"1364,0 1364,129 1420,129 1420,0\"/>            <TextLine id=\"r2l1\" custom=\"readingOrder {index:0}\">                <Coords points=\"1356,86 1375,91 1385,84 1406,98 1428,98 1428,28 1414,31 1400,26 1381,40 1356,43\"/>                <Baseline points=\"1364,78 1392,79 1420,78\"/>                <Word id=\"r2l1_w1\" custom=\"readingOrder {index:0}\">                    <Unicode>2</Unicode>                    <TextEquiv>                        <Unicode>2</Unicode>                    </TextEquiv>                </Word>                <TextEquiv>                    <Unicode>2</Unicode>                </TextEquiv>            </TextLine>            <TextEquiv>                <Unicode/>            </TextEquiv>        </TextRegion>    </Page></PcGts>';\n\nimport { parsePageContent, parseXML } from \"@/utils/xml.js\";\n\nexport const state = () => ({\n  id: null,\n  data: null,\n  selected: null,\n  selectedTag: null,\n  highlighted: null,\n  isError: false,\n  isReady: false,\n  isLoading: false,\n  xmlModel: parseXML(xml),\n  wasSaved: false,\n  wasEdited: false,\n  editLayoutHorizontal: true,\n  iiifUrl:\n    \"https://files.transkribus.eu/iiif/2/XITIHIQXRRBAHPZDHDPHWHMP/info.json\",\n  xmlJson: parsePageContent(xml),\n  // iiifUrl: \"\",\n  // xmlJson: null,\n  xml: xml,\n});\n\nexport const mutations = {\n  update(state, params) {\n    for (const key in params)\n      if (!deepEqual(state[key], params[key])) state[key] = params[key];\n  },\n};\n\nexport const actions = {\n  update({ commit }, params) {\n    commit(\"update\", params);\n  },\n  reset({ dispatch }) {\n    dispatch(\"update\", {\n      id: null,\n      data: null,\n      selected: null,\n      selectedTag: null,\n      highlighted: null,\n      isError: false,\n      isready: false,\n      isLoading: false,\n      xmlModel: parseXML(xml),\n      wasSaved: false,\n      wasEdited: false,\n      editLayoutHorizontal: true,\n      iiifUrl:\n        \"https://files.transkribus.eu/iiif/2/XITIHIQXRRBAHPZDHDPHWHMP/info.json\",\n      xmlJson: parsePageContent(xml),\n      // iiifUrl: \"\",\n      // xmlJson: null,\n      xml: xml,\n    });\n  },\n  select({ dispatch, state }, { origin, target }) {\n    dispatch(\"update\", { selected: { origin, target } });\n  },\n  highlight({ dispatch, state }, { origin, target }) {\n    dispatch(\"update\", { highlighted: { origin, target } });\n  },\n  setSelectedTag({ dispatch, state }, { selectedTag }) {\n    dispatch(\"update\", { selectedTag: selectedTag });\n  },\n  setIIIF({ dispatch, state }, { iiifUrl }) {\n    dispatch(\"update\", { iiifUrl: iiifUrl });\n  },\n  setXmlJson({ dispatch, state }, { xmlJson }) {\n    dispatch(\"update\", { xmlJson: xmlJson });\n  },\n  setXml({ dispatch, state }, { xml }) {\n    let json = parseXML(xml);\n\n    dispatch(\"update\", { xmlModel: json });\n\n    let pageJson = parsePageContent(xml);\n\n    dispatch(\"update\", { xmlJson: pageJson });\n  },\n  setXmlModel({ dispatch, state }, { xmlModel }) {\n    dispatch(\"update\", { xmlModel: xmlModel });\n  },\n  async fetch({ state, dispatch }, id) {\n    // if (id) dispatch('update', { id })\n    dispatch(\"update\", { isLoading: true, isReady: false });\n    await dispatch(\"fetchPageContent\", id);\n    dispatch(\"update\", { isLoading: false, isReady: true });\n  },\n  async fetchPageContent({ state, dispatch }, id) {\n    if (id) dispatch(\"update\", { id });\n    const data = await fetchPageContentXML(id);\n    if (data === null) dispatch(\"update\", { data: null, isError: true });\n    else {\n      dispatch(\"update\", {\n        data: Object.freeze(data),\n        isError: false,\n      });\n    }\n  },\n  findElementById({ state }, id) {\n    const node = state.xmlJson;\n    const stack = [node];\n    while (stack.length) {\n      const node = stack.pop();\n      if (node.elements) node.elements.forEach((node) => stack.push(node));\n      if (node.attributes && node.attributes.id === id) return node;\n    }\n    return null;\n  },\n};\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions,\n};\n","const { xml2js, json2xml } = require(\"xml-js\");\nconst jp = require(\"jmespath\");\nconst simplify = require(\"simplify-js\");\nimport store from \"../store/content/index.js\";\n\nconst XML2JS = {\n  DEFAULT: {\n    compact: false,\n    trim: false,\n    alwaysArray: true,\n    alwaysChildren: true,\n    attributeValueFn: parseAttributeValue,\n  },\n  TEST: {\n    compact: false,\n    attributeValueFn: parseAttributeValue,\n  },\n};\n\nconst SIMPLIFY_TOLERANCE = 25; // pixels\n\nfunction parsePointsAttribute(string = \"\") {\n  return string\n    .split(/\\s+/)\n    .map((string) => string.split(/\\s*,\\s*/).map((x) => parseInt(x)))\n    .map(([x, y]) => ({ x, y }));\n  // return simplify(\n  //   string\n  //     .split(/\\s+/)\n  //     .map((string) => string.split(/\\s*,\\s*/).map((x) => parseInt(x)))\n  //     .map(([x, y]) => ({ x, y })),\n  //   SIMPLIFY_TOLERANCE\n  // );\n}\n\nfunction reverseParsePointsAttribute(values) {\n  var pointString = \"\";\n  for (var point in values.points) {\n    var temp = values.points[point];\n    pointString += temp.x + \",\" + temp.y + \" \";\n  }\n  values.points = pointString.replace(/\\s*$/, \"\");\n}\n\nfunction parseCustomAttribute(string) {\n  if (string === \"\") return [];\n\n  return string.split(\"} \").reduce((results, string) => {\n    const name = string.split(\" {\")[0];\n    let attrs = string.split(\" {\")[1];\n    if (attrs) {\n      if (attrs.indexOf(\"}\")) attrs = attrs.replace(\"}\", \"\");\n\n      var key, value;\n\n      return results.concat({\n        name: name.trim(),\n        attributes: attrs.split(\";\").reduce((attrs, string) => {\n          string = string.trim();\n          if (string) {\n            key = string.split(\":\")[0].trim();\n            value = decodeURIComponent(\n              JSON.parse(\n                '\"' + string.split(\":\")[1].trim().replace('\"', '\\\\\"') + '\"'\n              )\n            );\n            if (key === \"index\" || key === \"offset\" || key === \"length\") {\n              attrs[key] = parseInt(value);\n            } else if (\n              key === \"continued\" ||\n              key === \"superscript\" ||\n              key === \"bold\" ||\n              key === \"italic\" ||\n              key === \"subscript\"\n            ) {\n              attrs[key] = Boolean(value);\n            } else attrs[key] = value;\n          }\n          return attrs;\n        }, {}),\n      });\n    }\n  }, []);\n}\n\nfunction reverseParseparseCustomAttribute(value) {\n  var customString = \"\";\n  for (var custom in value.custom) {\n    var temp = value.custom[custom];\n    customString +=\n      temp.name +\n      \" \" +\n      JSON.stringify(temp.attributes).replaceAll('\"', \"\").replaceAll(\",\", \";\") +\n      \" \";\n  }\n  customString = customString.trim()\n  value.custom = customString;\n}\n\nfunction parseAttributeValue(value, name) {\n  switch (name) {\n    case \"points\":\n      return parsePointsAttribute(value);\n    case \"custom\":\n      return parseCustomAttribute(value);\n    default:\n      return value;\n  }\n}\n\nfunction reverseParseAttributeValue(values, name) {\n  if (values.points) {\n    reverseParsePointsAttribute(values);\n  }\n  if (values.custom) {\n    reverseParseparseCustomAttribute(values);\n  }\n  if (values.imgUrl) {\n    values.imgUrl = values.imgUrl.replaceAll(\"&\", \"&amp;\");\n  }\n  switch (name) {\n    case \"points\":\n      return reverseParsePointsAttribute(values);\n    case \"custom\":\n      return reverseParseparseCustomAttribute(values);\n    default:\n      return values;\n  }\n}\n\nexport function getObjects(obj, key, val) {\n  var objects = [];\n  for (var i in obj) {\n    if (!obj.hasOwnProperty(i)) continue;\n    if (typeof obj[i] == \"object\") {\n      objects = objects.concat(getObjects(obj[i], key, val));\n    } else if ((i == key && obj[i] == val) || (i == key && val == \"\")) {\n      objects.push(obj);\n    } else if (obj[i] == val && key == \"\") {\n      if (objects.lastIndexOf(obj) == -1) {\n        objects.push(obj);\n      }\n    }\n  }\n  return objects;\n}\n\nfunction replaceLine(obj, key, val, textString, customObjArr) {\n  for (var i in obj) {\n    if (!obj.hasOwnProperty(i)) continue;\n\n    if (typeof obj[i] == \"object\") {\n      if (obj[i] && obj[i].name == \"TextLine\" && obj[i].attributes) {\n        if (obj[i].attributes.id == val) {\n          obj[i].attributes.custom = customObjArr;\n          var elementArr = {\n            elements: [{ text: \"\", type: \"text\" }],\n            name: \"Unicode\",\n            type: \"element\",\n          };\n          obj[i].elements = obj[i].elements.filter(function (el) {\n            return el.name != \"Word\";\n          });\n          for (var lineTagIndex in obj[i].elements) {\n            var lineTag = obj[i].elements[lineTagIndex];\n\n            if (lineTag.name == \"TextEquiv\") {\n              lineTag.elements[0] = elementArr;\n              lineTag.elements[0].elements[0].text = textString;\n            }\n          }\n          return obj[i];\n        }\n      }\n\n      replaceLine(obj[i], key, val, textString, customObjArr);\n    } else if ((i == key && obj[i] == val) || (i == key && val == \" \")) {\n      obj[i].attributes.custom = customObjArr;\n      obj[i].elements[2].elements[0].elements[0].text = textString;\n      return obj[i];\n    }\n  }\n}\n\nexport function getValues(obj, key) {\n  var objects = [];\n  for (var i in obj) {\n    if (!obj.hasOwnProperty(i)) continue;\n    if (typeof obj[i] == \"object\") {\n      objects = objects.concat(getValues(obj[i], key));\n    } else if (i == key) {\n      objects.push(obj[i]);\n    }\n  }\n  return objects;\n}\n\nexport function getKeys(obj, val) {\n  var objects = [];\n  for (var i in obj) {\n    if (!obj.hasOwnProperty(i)) continue;\n    if (typeof obj[i] == \"object\") {\n      objects = objects.concat(getKeys(obj[i], val));\n    } else if (obj[i] == val) {\n      objects.push(i);\n    }\n  }\n  return objects;\n}\n\nexport function parseEditorOutput(editorJson, globalJson) {\n  var editorLineArr = getObjects(editorJson, \"type\", \"line\");\n  for (var lineIndex in editorLineArr) {\n    var line = editorLineArr[lineIndex];\n    var customObjArr = [];\n    customObjArr.push(line.attrs.line.attributes.custom[0]);\n    var textString = \"\";\n    if (line.content == undefined) {\n      replaceLine(\n        globalJson,\n        \"id\",\n        line.attrs.line.attributes.id,\n        \"\",\n        customObjArr\n      );\n    }\n    for (var contentIndex in line.content) {\n      var lineContent = line.content[contentIndex];\n      var text = lineContent.text;\n      if (lineContent.marks) {\n        for (var markIndex in lineContent.marks) {\n          var mark = lineContent.marks[markIndex];\n          var attributes = {};\n          var name = mark.type;\n          var offset = textString.length;\n          var length = text.length;\n          if (mark.attrs) {\n            attributes = mark.attrs.tag.attributes;\n          }\n\n          if (attributes.offset === undefined) {\n            //TODO check for continued\n            attributes.offset = offset;\n            attributes.length = length;\n          }\n\n          switch (name) {\n            case \"strike\":\n              name = \"textStyle\";\n              attributes.strikethrough = true;\n              break;\n            case \"underline\":\n              name = \"textStyle\";\n              attributes.underlined = true;\n              break;\n            case \"subscript\":\n              name = \"textStyle\";\n              attributes.subscript = true;\n              break;\n\n            case \"superscript\":\n              name = \"textStyle\";\n              attributes.superscript = true;\n              break;\n          }\n\n          customObjArr.push({ name: name, attributes: attributes });\n        }\n      }\n      textString += text;\n      replaceLine(\n        globalJson,\n        \"id\",\n        line.attrs.line.attributes.id,\n        textString,\n        customObjArr\n      );\n    }\n  }\n  return globalJson;\n}\n\nexport function parseToXML(json) {\n  var options = {\n    compact: false,\n    ignoreComment: true,\n    spaces: 4,\n    sanitize: false,\n    attributesFn: reverseParseAttributeValue,\n  };\n  var result = json2xml(json, options);\n  return result;\n}\n\nexport function parseJsonContent(json) {\n  const result = jp.search(\n    json,\n    \"{ declaration: declaration,PcGts: elements[?name == 'PcGts'].{type: name,attributes: attributes,Page: elements[?name == 'Page'].{type: name,attributes: attributes,elements: elements[?name == 'TextRegion' || name == 'TableRegion'].{type: name,attributes: attributes,geometry: {coords: elements[?name == 'Coords'].attributes.points | [0]},elements: elements[?name == 'TextLine' || name == 'TableCell'].{type: name,attributes: attributes,geometry: {coords: elements[?name == 'Coords'].attributes.points | [0],baseline: elements[?name == 'Baseline'].attributes.points | [0]},elements: [elements[?name == 'TextEquiv' || name == 'TextLine'].{ elements:[elements[?name == 'Unicode' || name == 'TextEquiv'].[elements[?type == 'text' || name == 'Unicode']] | []], attributes : attributes, geometry: {coords: elements[?name == 'Coords'].attributes.points | [0]}}] | [] | [] | []} | []} } | [0]} | [0]}\"\n  );\n  return result.PcGts.Page;\n}\nexport function parseXML(xml, type = \"DEFAULT\") {\n  const js = xml2js(xml, XML2JS[type]);\n  var json = JSON.parse(JSON.stringify(js));\n  return json;\n}\n\nexport function parsePageContent(xml, type = \"DEFAULT\") {\n  const js = xml2js(xml, XML2JS[type]);\n  var json = JSON.parse(JSON.stringify(js));\n\n  const result = jp.search(\n    js,\n    \"{ declaration: declaration,PcGts: elements[?name == 'PcGts'].{type: name,attributes: attributes,Page: elements[?name == 'Page'].{type: name,attributes: attributes,elements: elements[?name == 'TextRegion' || name == 'TableRegion'].{type: name,attributes: attributes,geometry: {coords: elements[?name == 'Coords'].attributes.points | [0]},elements: elements[?name == 'TextLine' || name == 'TableCell'].{type: name,attributes: attributes,geometry: {coords: elements[?name == 'Coords'].attributes.points | [0],baseline: elements[?name == 'Baseline'].attributes.points | [0]},elements: [elements[?name == 'TextEquiv' || name == 'TextLine'].{ elements:[elements[?name == 'Unicode' || name == 'TextEquiv'].[elements[?type == 'text' || name == 'Unicode']] | []], attributes : attributes, geometry: {coords: elements[?name == 'Coords'].attributes.points | [0]}}] | [] | [] | []} | []} } | [0]} | [0]}\"\n  );\n  return result.PcGts.Page;\n}\n","import config from \"../config\";\nimport { parsePageContent } from \"./xml.js\";\nimport pkg from \"../../package.json\";\n\nconst fetch = require(\"node-fetch\");\n\nconst CONTENT = \"https://transkribus.eu/r/zQPlDb1ZvVWJuiBU/api/v0\";\n\nasync function logOut() {\n  const response = await this.$auth.loginWith(\"keycloak\");\n}\n\nexport function getImageSize(imageUrl) {\n  \n}\n\nexport async function fetchSearchResults(\n  { term, documents, titles, page, fuzziness },\n  { offset = 0, limit = 10 }\n) {\n  const res = await window.$nuxt.$axios(\n    \"https://transkribus.eu/r/search/search\",\n    {\n      method: \"POST\",\n      body: JSON.stringify({\n        term,\n        collections: [collection],\n        documents,\n        titles,\n        page,\n        fuzziness,\n        offset,\n        limit,\n      }),\n      headers: {\n        \"Content-Type\": CONTENT_TYPE,\n        Accept: CONTENT_TYPE,\n      },\n    }\n  );\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchSearchFacets({\n  term,\n  documents,\n  titles,\n  fuzziness,\n}) {\n  const res = await window.$nuxt.$axios(\n    \"https://transkribus.eu/r/search/facets\",\n    {\n      method: \"POST\",\n      body: JSON.stringify({\n        term,\n        collections: [collection],\n        documents,\n        titles,\n        fuzziness,\n      }),\n      headers: {\n        \"Content-Type\": CONTENT_TYPE,\n        Accept: CONTENT_TYPE,\n      },\n    }\n  );\n  const data = await res.json();\n  if (res.status === 401) {\n    logOut();\n  }\n  const { total, facets, params } = data;\n  return {\n    total,\n    facets,\n    params,\n  };\n}\n\nexport async function fetchSearchFulltext({ term, start, rows, filter }) {\n  const res = await window.$nuxt.$axios.get(\"/search/fulltext\", {\n    params: {\n      query: term,\n      type: \"LinesLc\",\n      start: start,\n      rows: rows,\n      filter: filter,\n    },\n  });\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function uploadImageJSON({ data, colId }) {\n  const res = await window.$nuxt.$axios(\"/uploads\", {\n    method: \"post\",\n    params: {\n      collId: colId,\n    },\n    data: data,\n  });\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function uploadImageData({ uploadId, formData }) {\n  const res = await window.$nuxt.$axios(\"/uploads/\" + uploadId, {\n    method: \"PUT\",\n    headers: {\n      \"Content-Type\": \"multipart/form-data\",\n    },\n    data: formData,\n    // onUploadProgress: e => {\n    //   // updating progress indicator\n    //   // progress(e.lengthComputable, e.loaded, e.total)\n    // }\n  });\n  if (res.status === 200) return res.data;\n  if (res.status === 401) return this.$auth.loginWith(\"keycloak\");\n  else throw new Error(res);\n}\n\nexport async function uploadPDFData({ collId, formData }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/createDocFromPdf\",\n    {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"multipart/form-data\",\n      },\n      data: formData,\n    }\n  );\n  if (res.status === 200) return res.data;\n  else throw new Error(res);\n}\n\nexport async function fetchCollections({ offset, limit }) {\n  const res = await window.$nuxt.$axios.get(\"/collections/list\", {\n    params: {\n      nValues: limit,\n      index: offset,\n    },\n  });\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchCollectionsForUser({ userid }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + userid + \"/listCols\",\n    {}\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchUsersForCollection({ collId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/userlist\",\n    {}\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\n// Get tag def from https://transkribus.eu/r/storage/collections/{colId}\n\nexport async function fetchStorageTagDef({ collId }) {\n  const res = await window.$nuxt.$axios\n    .get(\"https://transkribus.eu/r/storage/collections/\" + collId)\n    .catch(function (error) {\n      console.log(error);\n      throw new Error(res);\n    });\n\n  if (res.status === 200) {\n    return res.data;\n  }\n}\n\nexport async function saveStorageTagDef({ data, collId }) {\n  const res = await window.$nuxt.$axios.post(\n    \"https://transkribus.eu/r/storage/collections/\",\n    {\n      data: data,\n      id: collId,\n    },\n    {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  // if (res.status === 401) {\n  //   logOut()\n  // } else throw new Error(res)\n}\n\nexport async function fetchTagDef({ collId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/listTagDefs\",\n    {}\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function saveTagDef({ def, collId }) {\n\n  const json = JSON.stringify(def);\n  const res = await window.$nuxt.$axios.post(\n    \"/collections/\" + collId + \"/tagDefs\",\n    json,\n    {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function findUser({ mail, firstName, lastName }) {\n  const res = await window.$nuxt.$axios.get(\"/user/findUser\", {\n    params: {\n      user: mail,\n      firstName: firstName,\n      lastName: lastName,\n    },\n  });\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function addModifyUserCollection({ collId, userId, role }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/addOrModifyUserInCollection\",\n    {\n      method: \"POST\",\n      params: {\n        userid: userId,\n        role: role,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function removeUserCollection({ collId, userId }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/removeUserFromCollection\",\n    {\n      method: \"POST\",\n      params: {\n        userid: userId,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function deleteDocument({ collId, docId }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/\" + docId,\n    {\n      method: \"DELETE\",\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function removeDocumentCollection({ collId, docId }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/removeDocFromCollection\",\n    {\n      method: \"POST\",\n      params: {\n        id: docId,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function addDocumentCollection({ collId, docId }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/addDocToCollection\",\n    {\n      method: \"POST\",\n      params: {\n        id: docId,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function fetchCollectionsMeta({ collId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/metadata\",\n    {\n      params: {\n        stats: true,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchDocuments({ collId, offset, limit }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/list\",\n    {\n      params: {\n        nValues: limit,\n        index: offset,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchDocumentsMeta({ collId, docId, limit }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/\" + docId + \"/metadata\",\n    {\n      params: {\n        nrOfTranscripts: limit,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchPages({ collId, docId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/\" + docId + \"/fulldoc\",\n    {\n      params: {\n        nrOfTranscripts: 1,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchPagesString({ collId, docId, offset, limit }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/\" + docId + \"/pages\",\n    {\n      params: {\n        pages: offset + \"-\" + limit,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchPageContent({ id }) {\n  const res = await window.$nuxt.$axios.get(\n    config.searchApiBaseUrl + \"/content/\" + id,\n    {\n      method: \"GET\",\n    }\n  );\n  if (res.status === 200) return res.data.PcGts.Page;\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function fetchPageContentXML({ id }) {\n  const res = await fetch(`https://files.transkribus.eu/Get?id=${id}`, {\n    method: \"GET\",\n  });\n  const xml = await res.text();\n  if (res.status === 200) {\n    return parsePageContent(xml);\n  }\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function setPageContentXML({\n  collId,\n  id,\n  page,\n  xml,\n  status,\n  parentTranscriptId,\n}) {\n  const res = await window.$nuxt.$axios(\n    `/collections/${collId}/${id}/${page}/text`,\n    {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"text/xml\" },\n      params: {\n        status: status,\n        // parent: parentTranscriptId,\n        toolName: \"TranskribusLite\" + pkg.version,\n      },\n      data: xml,\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function fetchContent(id) {\n  const res = await fetch(`${CONTENT}/content/${id}`);\n  if (res.status === 200) return res.json();\n  return null;\n}\n\nexport async function fetchImageMeta({ key }) {\n  const res = await window.$nuxt.$axios.get(\n    config.urls.image + \"/\" + key + \"/info.json\",\n    {}\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchFacets({ ...params } = {}) {\n  const res = await client.get(\"/facets\", { params: params });\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function fetchCounts({ type, ...params }) {\n  if (![\"scope\", \"year\"].includes(type)) {\n    console.error(`Unexpected type '${type}'`);\n    return null;\n  }\n\n  const res = await client.get(`/counts/${type}`, { params: params });\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function fetchItems({ path, offset, limit, ...others }) {\n  const res = await client.get(`/items`, {\n    params: {\n      path,\n      offset,\n      limit,\n      ...others,\n    },\n  });\n  if (res.status !== 200) throw new Error(res.status);\n  if (res.status === 401) {\n    logOut();\n  }\n  return res.data;\n}\n\nexport async function fetchScopeLabels({ scope, offset, limit, ...others }) {\n  const res = await client.get(`/levels`, {\n    params: {\n      scope,\n      offset,\n      limit,\n      ...others,\n    },\n  });\n  if (res.status === 200)\n    return res.data.map(({ value, count }) => ({\n      label: value,\n      count: count,\n    }));\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function fetchDocumentInfo({ id }) {\n  const res = await window.$nuxt.$axios.get(`/documents/${id}`);\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function fetchPageInfo({ collId, docId, pageNr }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/\" + docId + \"/\" + pageNr,\n    {}\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchPagesForDocument({ id, offset, limit }) {\n  const res = await client.get(\n    config.searchApiBaseUrl + `/documents/${id}/pages`,\n    {\n      params: {\n        offset,\n        limit,\n      },\n    }\n  );\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n\nexport async function getPublicModels() {\n  const res = await window.$nuxt.$axios.get(\n    \"https://readcoop.eu/wp-json/wp/v2/model\",\n    {\n      params: {\n        per_page: 100,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n}\n\nexport async function getHTRModels({ collId }) {\n  const res = await window.$nuxt.$axios.get(`/recognition/${collId}/list`);\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function startHTR({ collId, htrModelId, docId, pageString }) {\n  const res = await window.$nuxt.$axios(\n    \"/recognition/\" + collId + \"/\" + htrModelId + \"/htrCITlab\",\n    {\n      method: \"POST\",\n      params: {\n        id: docId,\n        pages: pageString,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function startPylaia({ collId, modelId, docId, pageString }) {\n  const res = await window.$nuxt.$axios(\n    \"/pylaia/\" + collId + \"/\" + modelId + \"/recognition\",\n    {\n      method: \"POST\",\n      params: {\n        id: docId,\n        pages: pageString,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function createCollection({ collName }) {\n  const res = await window.$nuxt.$axios(\"/collections/createCollection\", {\n    method: \"POST\",\n    params: {\n      collName: collName,\n    },\n  });\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchJob({ jobId }) {\n  const res = await window.$nuxt.$axios.get(\"/jobs/\" + jobId, {\n    params: {\n      nrOfTranscripts: 1,\n    },\n  });\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchCreditCost() {\n  const res = await window.$nuxt.$axios.get(\"/credits/costs\");\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function fetchCreditCalculation({ collId, modelId, pages }) {\n  const res = await window.$nuxt.$axios(\n    \"/recognition/\" + collId + \"/\" + modelId + \"/costs\",\n    {\n      method: \"GET\",\n      params: {\n        nrOfPages: pages,\n      },\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  }\n  // if (res.status === 401) {\n  //   logOut()\n  // } else throw new Error(res)\n}\n\nexport async function fetchCredits() {\n  const res = await window.$nuxt.$axios.get(\"/credits\");\n  if (res.status === 200) {\n    return res.data;\n  }\n  // if(res.status === 401) {\n  //   // logOut()\n  //   var noCredits = {overallBalance: 0}\n  //   return noCredits\n  // }\n  else throw new Error(res);\n}\n\nexport async function fetchCreditsCollection({ collId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/collections/\" + collId + \"/credits\"\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else throw new Error(res);\n}\n\nexport async function fetchCreditsAssigned({ packageId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/credits/\" + packageId + \"/collections\"\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else throw new Error(res);\n}\n\nexport async function fetchCreditsTransactions({ packageId }) {\n  const res = await window.$nuxt.$axios.get(\n    \"/credits/\" + packageId + \"/creditTransactions\"\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else throw new Error(res);\n}\n\nexport async function addCreditsCollection({ collId, packageId }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/credits/\" + packageId,\n    {\n      method: \"POST\",\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function removeCreditsCollection({ collId, packageId }) {\n  const res = await window.$nuxt.$axios(\n    \"/collections/\" + collId + \"/credits/\" + packageId,\n    {\n      method: \"DELETE\",\n    }\n  );\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function splitCredits({ packageId, balance }) {\n  balance = parseFloat(balance);\n  const res = await window.$nuxt.$axios(\"/credits/\", {\n    method: \"POST\",\n    params: {\n      sourcePackageId: packageId,\n    },\n    data: {\n      balance,\n    },\n  });\n  if (res.status === 200) {\n    return res.data;\n  } else if (res.status === 304) {\n    throw new Error(\"304\");\n  } else throw new Error(res);\n}\n\nexport async function fetchJobs({ offset, limit }) {\n  const res = await window.$nuxt.$axios.get(\"/jobs/list\", {\n    params: {\n      nValues: limit,\n      index: offset,\n      filterByUser: true,\n    },\n  });\n  if (res.status === 200) {\n    return res.data;\n  }\n  if (res.status === 401) {\n    logOut();\n  } else throw new Error(res);\n}\n\nexport async function getXML({ url }) {\n  const res = await window.$nuxt.$axios.get(url, {\n    headers: {\n      Accept: \"application/xml\",\n    },\n  });\n  if (res.status === 200) return res.data;\n  if (res.status === 401) {\n    logOut();\n  }\n  return null;\n}\n","import {\n  fetchDocumentsMeta,\n  fetchPageInfo,\n  fetchSearchResults\n} from '@/utils/api.js'\n\nconst DEFAULT = {\n  // document\n  docId: null,\n  title: null,\n  colTitle: null,\n  maxPage: NaN,\n  documentInfo: null,\n  isDocumentReady: false,\n  isDocumentNotFoundError: false,\n  // page\n  pageId: null,\n  pageNum: NaN,\n  pageInfo: null,\n  pageContentId: null,\n  tsList: null,\n  tsKey: null,\n  // content: null,\n  image: null,\n  isPageReady: false,\n  isPageContentReady: false,\n  isPageNotFoundError: false,\n  isPageContentNotFoundError: false,\n  // search\n  term: '',\n  results: [],\n  // shared\n  requestCount: 0,\n  // view\n  view: 'both',\n  tagMode: 'hidetags',\n  changed: false\n}\n\nexport const state = () => Object.assign({}, DEFAULT)\n\nexport const getters = {\n  isLoading: (state, getters, rootState) =>\n    state.requestCount > 0 && state.content.isLoading === true,\n  hasResults: state => state.results.length > 0\n}\n\nexport const mutations = {\n  update(state, params) {\n    for (const key in params) {\n      if (state[key] !== params[key]) {\n        state[key] = params[key]\n        state.changed = true\n      }\n    }\n  },\n  beginRequest(state) {\n    state.requestCount += 1\n  },\n  endRequest(state) {\n    if (state.requestCount > 0) state.requestCount -= 1\n  }\n}\n\nexport const actions = {\n  update({ commit, state }, params = {}) {\n    const o = {}\n    for (const key in params) if (key in state) o[key] = params[key]\n    commit('update', o)\n  },\n  async fetch({ dispatch, state }, routeParams) {\n    dispatch('beginRequest')\n    // if (state.view !== view) await dispatch('update', { view })\n    if (routeParams.docid !== state.docId) {\n      // await dispatch('update', { documentId, pageNum, results: [] })\n      await dispatch('fetchDocumentInfo', {\n        collId: routeParams.collectionid,\n        docId: routeParams.docid\n      })\n      await dispatch('fetchPageInfo', {\n        collId: routeParams.collectionid,\n        docId: routeParams.docid,\n        pageNr: routeParams.pageid\n      })\n      //     if (term) {\n      // dispatch('update', { term })\n      // await dispatch('fetchSearchResults')\n      //     }\n    }\n    // else if (pageNum !== state.pageNum) {\n    else {\n      await dispatch('update', { pageNum, results: [] })\n      await dispatch('fetchPageInfo', {\n        collId: routeParams.collectionid,\n        docId: routeParams.docid,\n        pageNr: routeParams.pageid\n      })\n      if (term) {\n        dispatch('update', { term })\n        await dispatch('fetchSearchResults')\n      }\n    }\n    // else  if (term && state.term !== term) {\n    //   dispatch('update', { term })\n    //   await dispatch('fetchSearchResults')\n    // }\n    dispatch('endRequest')\n  },\n  beginRequest({ commit }) {\n    commit('beginRequest')\n  },\n  endRequest({ commit }) {\n    commit('endRequest')\n  },\n  async fetchDocumentInfo({ state, dispatch }, { collId, docId }) {\n    dispatch('beginRequest')\n    const data = await fetchDocumentsMeta({ collId: collId, docId: docId })\n\n    if (data === null) {\n      dispatch('update', {\n        isDocumentNotFoundError: true\n      })\n    } else {\n      const colTitle = data.collectionList.colList.find(\n        element => element.colId == collId\n      )\n      dispatch('update', {\n        docId: data.docId,\n        maxPage: data.nrOfPages,\n        isDocumentReady: true,\n        title: data.title,\n        colTitle: colTitle\n      })\n    }\n    dispatch('endRequest')\n  },\n  async fetchPageInfo({ state, dispatch }, { collId, docId, pageNr }) {\n    dispatch('beginRequest')\n    const data = await fetchPageInfo({\n      collId: collId,\n      docId: docId,\n      pageNr: pageNr\n    })\n    if (data === null)\n      dispatch('update', {\n        image: null,\n        isPageReady: false,\n        isPageNotFoundError: true\n      })\n    else {\n      let image = { id: data.key, width: data.width, height: data.height }\n      dispatch('update', {\n        ...data.id,\n        image: image,\n        pageNum: data.pageNr,\n        isPageReady: true,\n        tsList: data.tsList,\n        tsKey: data.tsList.transcripts[0].key\n      })\n      // dispatch('content/update', { id: data.content.id })\n      dispatch('fetchPageContent', { id: data.tsList.transcripts[0].key })\n    }\n    dispatch('endRequest')\n  },\n  async fetchPageContent({ state, dispatch }, { id }) {\n    dispatch('update', {\n      tsKey: id\n    })\n    await dispatch('content/fetch', { id })\n  },\n  async fetchSearchResults({ state, dispatch }) {\n    dispatch('beginRequest')\n    const data = await fetchSearchResults(\n      {\n        term: state.term,\n        page: state.pageId\n      },\n      { offset: 0, limit: 100 }\n    )\n\n    if (data === null) {\n      dispatch('update', { results: [] })\n    } else {\n      dispatch('update', {\n        results:\n          data.results.length === 0\n            ? Object.freeze([])\n            : Object.freeze(data.results[0].results)\n      })\n    }\n    dispatch('endRequest')\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions,\n  getters\n};","import deepEqual from 'fast-deep-equal'\nconst tags = require('../../assets/tag-config.json');\n\nexport const state = () => ({\n  docId: null,\n  title: null,\n  colTitle: null,\n  colRole: null,\n  collections: [],\n  tagDefs: tags,\n  documents: [],\n})\n\n\nexport const mutations = {\n  update(state, params) {\n    for (const key in params)\n      if (!deepEqual(state[key], params[key])) state[key] = params[key]\n  }\n}\n\nexport const actions = {\n  update({ commit }, params) {\n    commit('update', params)\n  },\n  setCollections({ dispatch, state }, { collections }) {\n    dispatch('update', { collections: collections })\n  },\n  setTagDefs({ dispatch, state }, { tagDefs }) {\n    dispatch('update', { tagDefs: tagDefs })\n  },\n  setDocuments({ dispatch, state }, { documents }) {\n    dispatch('update', { documents: documents })\n  },\n  setColTitle({ dispatch, state }, { colTitle }) {\n    dispatch('update', { colTitle: colTitle })\n  },\n  setColRole({ dispatch, state }, { colRole }) {\n    dispatch('update', { colRole: colRole })\n  }\n}\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions,\n};","import Vue from \"vue\";\nimport Vuex from \"vuex\";\n\nimport detail from \"./detail\";\nimport browse from \"./browse\";\nimport content from \"./content\";\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n  modules: {\n    browse,\n    detail,\n    content,\n  },\n  strict: process.env.NODE_ENV !== \"production\",\n  // plugins: debug ? [createLogger()] : []\n});\n","import { Node, mergeAttributes } from \"@tiptap/core\";\nimport { VueNodeViewRenderer } from \"@tiptap/vue-2\";\nimport Component from \"./LineNode.vue\";\nimport { TextSelection } from \"prosemirror-state\";\nimport { Plugin, PluginKey } from \"prosemirror-state\";\nimport store from \"@/store\";\n\nexport default Node.create({\n  name: \"line\",\n\n  group: \"block+\",\n\n  // content: '(inline* | tag*)',\n  content: \"inline* \",\n  addAttributes() {\n    return {\n      line: {\n        default: [],\n      },\n    };\n  },\n  addProseMirrorPlugins() {\n    return [\n      new Plugin({\n        props: {\n          handleKeyDown: (view, event) => {\n            if (event.which === 8 || event.which === 46) {\n              view.state.deleting = true;\n            }\n\n            return false;\n          },\n        },\n\n        filterTransaction: (transaction, state) => {\n          var isDeleting = state.deleting;\n\n          if (!state.deleting) {\n            return true;\n          }\n\n          var result = true;\n\n          transaction.mapping.maps.forEach((map) => {\n            map.forEach((oldStart, oldEnd, newStart, newEnd) => {\n              state.doc.nodesBetween(\n                oldStart,\n                oldEnd,\n                (node, number, pos, parent, index) => {\n                  if (node.type.name === \"line\") {\n                    result = false;\n                  }\n                }\n              );\n            });\n          });\n\n          return result;\n        },\n      }),\n    ];\n  },\n  addKeyboardShortcuts() {\n    return {\n      Enter: (state, dispatch, view) => {\n        this.editor.commands.selectParentNode();\n        var selection = this.editor.view.state.selection;\n        var node = this.editor.view.state.doc.nodeAt(selection.$head.pos);\n        this.editor.chain().selectNodeForward();\n        if (node) {\n          if (node.attrs.line) {\n            this.editor.commands.setTextSelection(\n              this.editor.state.selection.$head.pos + node.content.size + 1\n            );\n            var lineId = node.attrs.line.attributes.id;\n            const el = document.getElementById(lineId);\n            el.scrollIntoView({ behavior: \"smooth\" });\n            store.dispatch(\"content/select\", {\n              target: lineId,\n              origin: \"content\",\n            });\n          }\n        }\n\n        return true;\n      },\n      ArrowDown: (state, dispatch, view) => {\n        this.editor.commands.selectParentNode();\n        var selection = this.editor.view.state.selection;\n        var node = this.editor.view.state.doc.nodeAt(selection.$head.pos);\n        this.editor.chain().selectNodeForward();\n        if (node) {\n          if (node.attrs.line) {\n            this.editor.commands.setTextSelection(\n              this.editor.state.selection.$head.pos + node.content.size + 1\n            );\n            var lineId = node.attrs.line.attributes.id;\n            const el = document.getElementById(lineId);\n            el.scrollIntoView({ behavior: \"smooth\" });\n            store.dispatch(\"content/select\", {\n              target: lineId,\n              origin: \"content\",\n            });\n          }\n        }\n\n        return true;\n      },\n      ArrowUp: (state, dispatch, view) => {\n        this.editor.commands.selectParentNode();\n        var selection = this.editor.view.state.selection;\n        var node = this.editor.view.state.doc.nodeAt(selection.$head.pos);\n        if (node && node.attrs.line) {\n          store.dispatch(\"content/select\", {\n            target: node.attrs.line.attributes.id,\n            origin: \"content\",\n          });\n        }\n      },\n    };\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: \"div\",\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\"div\", mergeAttributes(HTMLAttributes)];\n  },\n\n  addNodeView() {\n    return VueNodeViewRenderer(Component);\n  },\n});\n","import Highlight from \"@tiptap/extension-highlight\";\n\nimport { Node, mergeAttributes } from \"@tiptap/core\";\n\nexport async function tagExtensions(tagDefs) {\n  var tagExtensionArr = [];\n  for (var tagIndex in tagDefs) {\n    var tag = tagDefs[tagIndex];\n    var tempExtension = Highlight.extend({\n      name: tag.name,\n      addKeyboardShortcuts() {\n        return {\n          \"Mod-l\": () => this.editor.commands.toggleBulletList(),\n        };\n      },\n      addCommands() {\n        return {\n          setTag:\n            () =>\n            ({ commands }) => {\n              return commands.setMark(tag.name);\n            },\n          toggleTag:\n            (attributes) =>\n            ({ commands, tr, state, dispatch }) => {\n              return commands.toggleMark(attributes.name, attributes);\n            },\n          unsetTag:\n            () =>\n            ({ commands }) => {\n              return commands.unsetMark(tag.name);\n            },\n        };\n      },\n      addAttributes() {\n        // Return an object with attribute configuration\n        return {\n          tag: {\n            default: {},\n          },\n          annotationId: {\n            default: null,\n          },\n          color: {\n            default: tag.color,\n            parseHTML: (element) => {\n              return [\n                {\n                  color:\n                    element.getAttribute(\"data-color\") ||\n                    element.style.backgroundColor,\n                },\n                {\n                  tag: tag.name,\n                },\n              ];\n            },\n            renderHTML: (attributes) => {\n              if (!attributes.color) {\n                return {};\n              }\n\n              return {\n                \"data-color\": attributes.color,\n                style: `outline-color: ${attributes.color} !important; outline: 2px solid;`,\n                class: \"tag\",\n              };\n            },\n          },\n        };\n      },\n      // parseHTML() {\n      //   return [{ tag: 'a[href]' }]\n      // },\n\n      renderHTML({ HTMLAttributes }) {\n        return [\n          \"a\",\n          mergeAttributes(this.options.HTMLAttributes, HTMLAttributes),\n          0,\n        ];\n      },\n    });\n    tagExtensionArr.push(tempExtension);\n  }\n\n  return tagExtensionArr;\n}\n","import {\n  Command,\n  Mark,\n  markInputRule,\n  markPasteRule,\n  mergeAttributes,\n} from \"@tiptap/core\";\n\nexport const Subscript = Mark.create({\n  name: \"subscript\",\n\n  defaultOptions: {\n    HTMLAttributes: {},\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: \"subscript\",\n      },\n      {\n        tag: \"del\",\n      },\n      {\n        tag: \"subscript\",\n      },\n      {\n        style: \"text-decoration\",\n        consuming: false,\n        getAttrs: (style) => (style.includes(\"line-through\") ? {} : false),\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\n      \"sub\",\n      mergeAttributes(this.options.HTMLAttributes, HTMLAttributes),\n      0,\n    ];\n  },\n\n  addCommands() {\n    return {\n      setSub:\n        () =>\n        ({ commands }) => {\n          return commands.setMark(\"subscript\");\n        },\n      toggleSub:\n        () =>\n        ({ commands }) => {\n          return commands.toggleMark(\"subscript\");\n        },\n      unsetSub:\n        () =>\n        ({ commands }) => {\n          return commands.unsetMark(\"subscript\");\n        },\n    };\n  },\n});\n","import {\n  Command,\n  Mark,\n  markInputRule,\n  markPasteRule,\n  mergeAttributes,\n} from \"@tiptap/core\";\n\nexport const Superscript = Mark.create({\n  name: \"superscript\",\n\n  defaultOptions: {\n    HTMLAttributes: {},\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: \"superscript\",\n      },\n      {\n        tag: \"del\",\n      },\n      {\n        tag: \"superscript\",\n      },\n      {\n        style: \"text-decoration\",\n        consuming: false,\n        getAttrs: (style) => (style.includes(\"line-through\") ? {} : false),\n      },\n    ];\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\n      \"sup\",\n      mergeAttributes(this.options.HTMLAttributes, HTMLAttributes),\n      0,\n    ];\n  },\n\n  addCommands() {\n    return {\n      setSuper:\n        () =>\n        ({ commands }) => {\n          return commands.setMark(\"superscript\");\n        },\n      toggleSuper:\n        () =>\n        ({ commands }) => {\n          return commands.toggleMark(\"superscript\");\n        },\n      unsetSuper:\n        () =>\n        ({ commands }) => {\n          return commands.unsetMark(\"superscript\");\n        },\n    };\n  },\n});\n","<template>\n  <div class=\"editor\" v-if=\"editor\">\n    <b-loading v-model=\"isLoading\" :active=\"isLoading\" :is-full-page=\"false\" />\n    <div class=\"editor__header\" v-if=\"editor\">\n      <b-navbar style=\"width: 100%; overflow: auto\">\n        <template #start>\n          <b-navbar-item>\n            <b-switch v-model=\"isAnnotation\"> Annotation </b-switch>\n          </b-navbar-item>\n        </template>\n\n        <template #end>\n          <b-navbar-item>\n            <b-button\n              title=\"Increase font size\"\n              icon-left=\"plus\"\n              @click=\"setFontSize(0.1)\"\n            >\n            </b-button>\n            <b-button\n              title=\"Decrease font size\"\n              icon-left=\"minus\"\n              @click=\"setFontSize(-0.1)\"\n            >\n            </b-button>\n          </b-navbar-item>\n          <b-navbar-item>\n            <b-button\n              title=\"Switch view\"\n              :icon-left=\"layoutIcon()\"\n              @click=\"setEditLayout\"\n            >\n            </b-button>\n\n            <b-button\n              title=\"Undo\"\n              icon-left=\"undo\"\n              @click=\"editor.chain().focus().undo().run()\"\n            >\n            </b-button>\n            <b-button\n              title=\"Redo\"\n              icon-left=\"redo\"\n              @click=\"editor.chain().focus().redo().run()\"\n            >\n            </b-button>\n          </b-navbar-item>\n          <b-navbar-item>\n            <b-field>\n              <b-button @click=\"saveContent\" icon-left=\"save\" type=\"is-success\">\n                Save\n              </b-button>\n            </b-field>\n          </b-navbar-item>\n          <!-- <b-navbar-item>\n            <b-button\n              title=\"Advanced\"\n              type=\"is-light\"\n              icon-left=\"toolbox\"\n              @click=\"openAdvancedModal\"\n            />\n          </b-navbar-item> -->\n        </template>\n      </b-navbar>\n    </div>\n    <div class=\"tile editor__content\">\n      <div v-if=\"isAnnotation\" class=\"tile is-parent is-vertical is-3\">\n        <div v-if=\"selectedTag\" class=\"tile is-child box\">\n          <div>\n            <div\n              class=\"tile is-vertical\"\n              style=\"width: 100%\"\n              v-for=\"(tempTag, index) in selectedTag.marks\"\n              :key=\"index\"\n            >\n              <div class=\"tile is-child\" v-if=\"tempTag.attrs.tag\">\n                <b-tag\n                  :style=\"`outline-color: ${tempTag.attrs.color} !important; outline: 2px solid; color : ${tempTag.attrs.color} !important;margin-top: auto;margin-bottom: auto;`\"\n                  icon-left=\"tag\"\n                >\n                  {{ tempTag.attrs.tag.name }}\n                </b-tag>\n              </div>\n              <div\n                class=\"tile is-child\"\n                v-for=\"(attribute, i) in findTagAttributes(tempTag)\"\n                :key=\"i\"\n              >\n                <b-field\n                  v-if=\"tempTag.attrs.tag\"\n                  :label=\"attribute\"\n                  label-position=\"on-border\"\n                >\n                  <b-input\n                    @input=\"\n                      changeContinued(\n                        tempTag,\n                        tempTag.attrs.tag.attributes[attribute],\n                        attribute\n                      )\n                    \"\n                    v-model=\"tempTag.attrs.tag.attributes[attribute]\"\n                  ></b-input>\n                </b-field>\n              </div>\n              <div class=\"tile is-child\" v-if=\"tempTag.attrs.tag\">\n                <b-button\n                  type=\"is-danger\"\n                  icon-left=\"trash\"\n                  @click=\"deleteTag()\"\n                >\n                  Delete\n                </b-button>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"tile is-child box\">\n          <div\n            class=\"transkribusEditor-bubble-menu\"\n            style=\"text-align: center\"\n            v-if=\"editor && isAnnotation && tagDefs\"\n          >\n            <b-button\n              title=\"Bold\"\n              type=\"is-primary\"\n              icon-left=\"bold\"\n              @click=\"editor.chain().focus().toggleBold().run()\"\n              :class=\"{ 'is-active': editor.isActive('bold') }\"\n            >\n            </b-button>\n            <b-button\n              title=\"Strike\"\n              type=\"is-primary\"\n              icon-left=\"strikethrough\"\n              @click=\"editor.chain().focus().toggleStrike().run()\"\n              :class=\"{ 'is-active': editor.isActive('strike') }\"\n            >\n            </b-button>\n            <b-button\n              title=\"Underline\"\n              type=\"is-primary\"\n              icon-left=\"underline\"\n              @click=\"editor.chain().focus().toggleUnderline().run()\"\n              :class=\"{ 'is-active': editor.isActive('underline') }\"\n            >\n            </b-button>\n            <b-button\n              title=\"Subscript\"\n              type=\"is-primary\"\n              icon-left=\"subscript\"\n              @click=\"editor.chain().focus().toggleSub().run()\"\n              :class=\"{ 'is-active': editor.isActive('subscript') }\"\n            >\n            </b-button>\n            <b-button\n              title=\"Superscript\"\n              type=\"is-primary\"\n              icon-left=\"superscript\"\n              @click=\"editor.chain().focus().toggleSuper().run()\"\n              :class=\"{ 'is-active': editor.isActive('superscript') }\"\n            >\n            </b-button>\n            <br />\n            <b-button\n              v-for=\"(tag, index) in tagDefs.definitions.annotations\"\n              :key=\"index\"\n              icon-left=\"tag\"\n              :style=\"'background-color:' + tag.color\"\n              @click=\"setAttributes(tag)\"\n              :class=\"{\n                'is-active': editor.isActive(tag.name, {\n                  color: tag.color,\n                }),\n              }\"\n            >\n              {{ tag.label }}\n            </b-button>\n          </div>\n        </div>\n      </div>\n      <div class=\"tile is-parent box\">\n        <editor-content\n          class=\"editor__content\"\n          v-bind:style=\"{ fontSize: fontSize + 'rem' }\"\n          :editor=\"editor\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n//  http://localhost:5000/collection/62267/doc/425931/detail/1?view=edit\n// http://localhost:5000/collection/100402/doc/512221/detail/2\n//  http://localhost:5000/collection/100402/doc/642576/detail/3\n\n//TODO adding continued tag and set attributes to continued tags\nimport {\n  generateHTML,\n  Editor,\n  EditorContent,\n  NodeViewWrapper,\n  NodeViewContent,\n  BubbleMenu,\n} from \"@tiptap/vue-2\";\nimport { defaultExtensions } from \"@tiptap/starter-kit\";\nimport TextAlign from \"@tiptap/extension-text-align\";\nimport StarterKit from \"@tiptap/starter-kit\";\nimport Focus from \"@tiptap/extension-focus\";\nimport Text from \"@tiptap/extension-text\";\nimport Region from \"../Editor/RegionExtension.js\";\nimport Line from \"../Editor/LineExtension.js\";\nimport Table from \"@tiptap/extension-table\";\nimport TableRow from \"@tiptap/extension-table-row\";\nimport TableCell from \"@tiptap/extension-table-cell\";\nimport TableHeader from \"@tiptap/extension-table-header\";\nimport Underline from \"@tiptap/extension-underline\";\nimport { tagExtensions } from \"../Editor/TagExtension.js\";\n\nimport { Subscript } from \"../Editor/SubscriptExtension.js\";\nimport { Superscript } from \"../Editor/SuperscriptExtension.js\";\n\nimport { NodeSelection } from \"prosemirror-state\";\nimport { Plugin, PluginKey } from \"prosemirror-state\";\n\nimport { mapState } from \"vuex\";\n\nimport { fetchTagDef, setPageContentXML } from \"../../utils/api.js\";\n\nimport { parseToXML, parseEditorOutput } from \"../../utils/xml.js\";\n\nvar groupBy = require(\"json-groupby\");\n\nexport default {\n  filters: {\n    text(item) {\n      return item.elements && item.elements[0] ? item.elements[0].text : \"\";\n    },\n    clean(s) {\n      if (typeof s !== \"string\") return \"\";\n      return s.trim().replace(/¬$/, \"\\u2010\");\n    },\n  },\n  watch: {\n    selected: {\n      handler: function (newValue, oldValue) {\n        if (newValue === null || newValue === oldValue) return;\n        if (newValue.origin === \"image\") {\n          var lineId = newValue.target;\n          var content = this.editor.state.doc.content.content;\n          this.editor.chain().focus();\n          var nodes = this.editor.view.docView.node;\n\n          nodes.descendants((node, pos) => {\n            if (node.attrs.line) {\n              if (node.attrs.line.attributes.id === lineId) {\n                var tr = this.editor.state.tr;\n                const transaction = tr.setSelection(\n                  NodeSelection.create(tr.doc, pos)\n                );\n                this.editor.view.dispatch(transaction);\n                const el = document.getElementById(lineId);\n                el.scrollIntoView({ behavior: \"smooth\" });\n              }\n            }\n          });\n        }\n      },\n      deep: true,\n    },\n    tagDefs: {\n      handler: function (newValue, oldValue) {\n        this.setup();\n      },\n      deep: true,\n    },\n    contentData: {\n      handler: function (newValue, oldValue) {\n        this.setEditorContentJSON();\n      },\n      deep: true,\n    },\n  },\n  components: {\n    TextAlign,\n    EditorContent,\n    BubbleMenu,\n  },\n  props: {\n    // xmlJson: {\n    //   type: Object,\n    //   required: true,\n    // },\n  },\n  data() {\n    return {\n      editorContentJson: {},\n      editor: null,\n      isAnnotation: false,\n      selectedTag: null,\n      status: \"IN_PROGRESS\",\n      isLoading: false,\n      annotationCounter: 0,\n      lastTag: {},\n      fontSize: 1,\n    };\n  },\n  computed: {\n    ...mapState(\"content\", [\n      \"data\",\n      \"selected\",\n      \"highlighted\",\n      \"isReady\",\n      \"xmlModel\",\n      \"wasSaved\",\n      \"wasEdited\",\n      \"editLayoutHorizontal\",\n      \"xmlJson\",\n    ]),\n    ...mapState(\"detail\", [\"tagMode\", \"tsKey\"]),\n    ...mapState(\"browse\", [\"tagDefs\"]),\n    hasContent() {\n      return this.content.elements.length !== 0;\n    },\n    contentData() {\n      if (!this.xmlJson || !this.xmlJson.elements) return { elements: [] };\n      else {\n        for (var element in this.xmlJson.elements) {\n          var temp = this.xmlJson.elements[element];\n          for (var line in temp.elements) {\n            var linetemp = temp.elements[line];\n\n            if (linetemp.type == \"TextLine\") {\n              linetemp.hasTag = this.hasTag(linetemp.attributes.custom);\n              linetemp.tags = this.getTags(linetemp.attributes.custom);\n            } else if (linetemp.type == \"TableCell\" && linetemp.elements[0]) {\n              linetemp.hasTag = this.hasTag(\n                linetemp.elements[0].attributes.custom\n              );\n              linetemp.tags = this.getTags(\n                linetemp.elements[0].attributes.custom\n              );\n            }\n          }\n        }\n\n        return this.xmlJson;\n      }\n    },\n  },\n  async mounted() {\n    this.setup();\n  },\n  methods: {\n    async setup() {\n      var tagArray = await tagExtensions(this.tagDefs.definitions.annotations);\n      var that = this;\n      this.editor = new Editor({\n        content: \"\",\n        extensions: [\n          Text,\n          Region,\n          Line,\n          StarterKit,\n          ...tagArray,\n          Focus.configure({\n            className: \"is-selected\",\n            nested: true,\n          }),\n          Underline,\n          Table,\n          TableRow,\n          TableHeader,\n          TableCell,\n          Subscript,\n          Superscript,\n        ],\n        onSelectionUpdate({ editor }) {\n          var selectedLine = editor.getAttributes(\"line\");\n          var head = editor.view.state.selection.$head.pos;\n          var anchor = editor.view.state.selection.$anchor.pos;\n          var node = editor.view.state.doc.nodeAt(head);\n          if (node && anchor == head) {\n            var marks = node.marks;\n            if (marks.length > 0) {\n              that.selectedTag = node;\n            } else {\n              that.selectedTag = null;\n            }\n          } else {\n            that.selectedTag = null;\n          }\n        },\n        onUpdate({ editor }) {\n          that.$store.dispatch(\"content/update\", { wasEdited: true });\n        },\n      });\n      this.setEditorContentJSON();\n    },\n    select(id) {\n      this.$store.dispatch(\"content/select\", {\n        target: id,\n        origin: \"content\",\n      });\n    },\n    setEditLayout() {\n      this.$store.dispatch(\"content/update\", {\n        editLayoutHorizontal: !this.editLayoutHorizontal,\n      });\n    },\n    layoutIcon() {\n      if (this.editLayoutHorizontal) {\n        return \"columns\";\n      }\n      return \"bars\";\n    },\n    changeContinued(tag, value, attribute) {\n      if (tag.attrs.tag.attributes.continued) {\n        var continuedTags = this.findMarkByUid(0, 1000, tag.attrs.annotationId);\n        for (var index in continuedTags) {\n          var tempTag = continuedTags[index];\n          tempTag.attrs.tag.attributes[attribute] = value;\n        }\n      }\n    },\n    setFontSize(value) {\n      this.fontSize += value;\n    },\n    findMarkByUid(from, to, uid) {\n      const { doc } = this.editor.state;\n      let found = [];\n      doc.nodesBetween(from, to, (node) => {\n        found.push(\n          node.marks.find((mark) => mark.attrs[\"annotationId\"] === uid)\n        );\n      });\n      return found.filter(Boolean);\n    },\n    findTagAttributes(tag) {\n      var found = {};\n      found = this.tagDefs.definitions.annotations.find(\n        (element) => element.name === tag.type.name\n      );\n      if (found) {\n        return found.attributes;\n      } else {\n        return found;\n      }\n    },\n\n    async saveContent() {\n      const json = this.editor.getJSON();\n      var js = JSON.parse(JSON.stringify(json));\n\n      var modelCopy = JSON.parse(JSON.stringify(this.xmlModel));\n\n      var parsedResult = parseEditorOutput(js, modelCopy);\n      console.log(\"parsedResult\", parsedResult);\n      var xmlResult = parseToXML(parsedResult);\n      var output = { xml: xmlResult, xmlJson: parsedResult };\n      this.$root.$emit(\"save\", output);\n    },\n    deleteTag() {\n      this.selectedTag.marks = [];\n      this.selectedTag = null;\n      this.editor.chain().focus().run();\n    },\n    setAttributes(tag) {\n      var attributes = {};\n      var contentObj = this.editor.state.selection.content();\n\n      if (\n        contentObj.content.content[0] &&\n        contentObj.content.content[0].content.content.length > 1\n      ) {\n        attributes = { continued: true };\n      }\n      var tagObj;\n      var tagName;\n      var tagColor;\n      if (tag.name) {\n        tagObj = { name: tag.name, attributes: attributes };\n        tagName = tag.name;\n        tagColor = tag.color;\n      } else {\n        tagName = tag.attrs.tag.name;\n        tagColor = tag.attrs.color;\n        tagObj = { name: tagName, attributes: attributes };\n      }\n      this.editor\n        .chain()\n        .focus()\n        .toggleTag({ color: tagColor, tag: tagObj, name: tagName })\n        .run();\n\n      var selectedLine = this.editor.getAttributes(\"line\");\n      var anchor = this.editor.state.selection.$anchor.pos;\n      var node = this.editor.state.doc.nodeAt(anchor);\n      if (node && node.marks) {\n        var marks = node.marks;\n        if (marks.length > 0) {\n          this.selectedTag = node;\n        } else {\n          this.selectedTag = null;\n        }\n      } else {\n        this.selectedTag = null;\n      }\n    },\n    openToast(message, type) {\n      this.$buefy.toast.open({\n        duration: 4000,\n        message: message,\n        position: \"is-top\",\n        type: type,\n      });\n    },\n    async loadTagDefs() {\n      let data;\n      try {\n        data = await fetchTagDef({\n          collId: this.$route.params.collectionid,\n        });\n      } catch (err) {\n        console.log(err);\n      }\n      this.$store.dispatch(\"browse/setTagDefs\", { tagDefs: data });\n    },\n    groupByRow(table) {\n      var result = groupBy(table, [\"attributes.row\"]);\n      return result;\n    },\n    getTagDef(tag) {\n      if (tag) {\n        var found = this.tagDefs.definitions.annotations.find(\n          (x) => x.name === tag.name\n        );\n      }\n\n      return found;\n    },\n    beforeDestroy() {\n      if (this.editor) {\n        this.editor.destroy();\n      }\n    },\n    setEditorContentJSON() {\n      let editorContent = {\n        type: \"doc\",\n        content: [],\n      };\n\n      if (!this.contentData || !this.contentData.elements)\n        return { elements: [] };\n      else {\n        for (var element in this.contentData.elements) {\n          var temp = this.contentData.elements[element];\n          var content = [];\n          if (temp.type == \"TextRegion\") {\n            for (var line in temp.elements) {\n              var linetemp = temp.elements[line];\n              if (linetemp.type == \"TextLine\") {\n                if (linetemp.elements[0]) {\n                  var id = linetemp.attributes.id;\n                  var text = \"\";\n                  if (\n                    linetemp.elements[0].elements[0][0] &&\n                    linetemp.elements[0].elements[0][0][0]\n                  ) {\n                    text = linetemp.elements[0].elements[0][0][0].text;\n                  }\n                  if (linetemp.hasTag) {\n                    var tagContent = this.setTagContent(linetemp, text, false);\n                    content.push({\n                      type: \"line\",\n                      attrs: {\n                        line: linetemp,\n                      },\n                      content: tagContent,\n                    });\n                  } else {\n                    if (text) {\n                      content.push({\n                        type: \"line\",\n                        attrs: {\n                          line: linetemp,\n                        },\n                        content: [\n                          {\n                            type: \"text\",\n                            text: text,\n                          },\n                        ],\n                      });\n                    } else {\n                      content.push({\n                        type: \"line\",\n                        attrs: {\n                          line: linetemp,\n                        },\n                      });\n                    }\n                  }\n                }\n              }\n            }\n            editorContent.content.push({\n              type: \"region\",\n              attrs: {\n                lines: temp,\n              },\n              content: content,\n            });\n          } else if (temp.type == \"TableRegion\") {\n            var groupedRows = this.groupByRow(temp.elements);\n            var rowContent = [];\n            for (var row in groupedRows) {\n              var cellContent = [];\n              var rowtemp = groupedRows[row];\n              for (var cell in rowtemp) {\n                var celltemp = rowtemp[cell];\n                var text = \"\";\n                var lineObjects = [];\n                for (line in celltemp.elements) {\n                  var linetemp = celltemp.elements[line];\n                  if (linetemp && linetemp.elements[0][0][0].elements[0]) {\n                    text = linetemp.elements[0][0][0].elements[0].text;\n                  }\n                  var lineContent = [];\n                  if (celltemp.hasTag) {\n                    lineContent = this.setTagContent(celltemp, text, true);\n                  } else {\n                    lineContent.push({\n                      type: \"text\",\n                      text: text,\n                    });\n                  }\n                  let lineObj;\n                  if (text) {\n                    lineObj = {\n                      type: \"line\",\n                      attrs: {\n                        line: linetemp,\n                      },\n                      content: lineContent,\n                    };\n                  } else {\n                    lineObj = {\n                      type: \"line\",\n                      attrs: {\n                        line: linetemp,\n                      },\n                    };\n                  }\n                  lineObjects.push(lineObj);\n                }\n                cellContent.push({\n                  type: \"tableCell\",\n                  content: lineObjects,\n                });\n              }\n              rowContent.push({\n                type: \"tableRow\",\n                content: cellContent,\n              });\n            }\n            var regionObj = {\n              type: \"region\",\n              content: rowContent,\n            };\n\n            editorContent.content.push({\n              type: \"table\",\n              content: [regionObj],\n            });\n          }\n        }\n        this.editorContentJson = editorContent;\n        this.editor.commands.setContent(editorContent);\n      }\n    },\n    getTags(attributes) {\n      var tags = [];\n      for (var i = 0; i < attributes.length; i++) {\n        if (\n          \"offset\" in attributes[i].attributes &&\n          \"length\" in attributes[i].attributes\n        ) {\n          tags.push(attributes[i]);\n        }\n      }\n      return tags;\n    },\n    hasTag(attributes) {\n      for (var i = 0; i < attributes.length; i++) {\n        if (\n          \"offset\" in attributes[i].attributes &&\n          \"length\" in attributes[i].attributes\n        ) {\n          return true;\n        }\n      }\n      return false;\n    },\n    setTagContent(linetemp, text, table) {\n      var tagContent = [];\n      var arrText = this.stringOffset(text, linetemp.tags);\n      for (var split in arrText) {\n        var marks = [];\n        var text = \" \";\n        if (!arrText[split] == \"\") {\n          text = arrText[split];\n        }\n        var offset = 0;\n        for (var i = 0; i < split; i++) {\n          offset += arrText[i].length;\n        }\n        var tags = this.findTags(linetemp, text, table, offset);\n        if (tags.length > 0) {\n          for (var tagTemp in tags) {\n            var tag = tags[tagTemp];\n            if (tag.name == \"textStyle\") {\n              var textStyles = this.setTextStyles(tag);\n              for (var index in textStyles) {\n                var textStyle = textStyles[index];\n                marks.push(textStyle);\n              }\n            }\n            var tagDef = this.getTagDef(tag);\n            var color = \"#ffff\";\n            var name = \"mark\";\n            if (tagDef) {\n              color = tagDef.color;\n              name = tagDef.name;\n              if (\n                !tag.attributes.continued ||\n                this.lastTag.name !== name ||\n                this.lastTag.continued !== tag.attributes.continued\n              ) {\n                this.annotationCounter++;\n              }\n              var tagMark = {\n                type: name,\n                attrs: {\n                  color: color,\n                  tag: tag,\n                  annotationId: this.annotationCounter,\n                },\n              };\n              this.lastTag = {\n                name: tag.name,\n                lineId: linetemp.attributes.id,\n                tag: tag,\n                continued: tag.attributes.continued,\n              };\n              marks.push(tagMark);\n            }\n          }\n          var obj = {\n            type: \"text\",\n            marks: marks,\n            text: text,\n          };\n          tagContent.push(obj);\n        } else {\n          var obj = {\n            type: \"text\",\n            marks: marks,\n            text: text,\n          };\n          tagContent.push(obj);\n        }\n      }\n      return tagContent;\n    },\n    setTextStyles(tag) {\n      var name = [];\n      if (tag.attributes.strikethrough) {\n        name.push(\"strike\");\n      }\n      if (tag.attributes.subscript) {\n        name.push(\"subscript\");\n      }\n      if (tag.attributes.superscript) {\n        name.push(\"superscript\");\n      }\n      if (tag.attributes.underlined) {\n        name.push(\"underline\");\n      }\n      if (tag.attributes.bold) {\n        name.push(\"bold\");\n      }\n      var textStyleArr = [];\n      for (var i = 0; i < name.length; i++) {\n        textStyleArr.push({\n          type: name[i],\n        });\n      }\n      return textStyleArr;\n    },\n    stringOffset(str, tags) {\n      if (!tags.length) return [];\n\n      const results = [],\n        indexes = [];\n\n      tags.forEach((options) => {\n        indexes.push(\n          options.attributes.offset,\n          options.attributes.offset + options.attributes.length\n        );\n      });\n\n      indexes.sort((i1, i2) => i1 - i2);\n\n      if (indexes.indexOf(0) < 0) indexes.unshift(0);\n\n      if (indexes[indexes.length - 1] < str.length) indexes.push(str.length);\n\n      for (let i = 0, len = indexes.length; i < len - 1; i++) {\n        results.push(str.substring(indexes[i], indexes[i + 1]));\n      }\n\n      return results;\n    },\n    findTags(element, text, table, offset) {\n      var lineText;\n      if (table) {\n        lineText = element.elements[0].elements[0][0][0].elements[0].text;\n      } else {\n        lineText = element.elements[0].elements[0][0][0].text;\n      }\n      if (text == \" \") {\n        return [];\n      }\n      var index = lineText.indexOf(text);\n      return element.tags.filter((x) => {\n        var tagtext = lineText.substr(x.attributes.offset, x.attributes.length);\n        if (\n          tagtext.includes(text) &&\n          offset >= x.attributes.offset &&\n          offset <= x.attributes.offset + x.attributes.length\n        ) {\n          return x;\n        }\n      });\n    },\n    textStyleClass(label) {\n      var classString = \"\";\n      if (label.includes(\"superscript = true\")) {\n        classString += \"is-superscript\";\n      }\n      if (label.includes(\"subscript = true\")) {\n        classString += \"is-subscript\";\n      }\n      if (label.includes(\"italic = true\")) {\n        classString += \"is-italic\";\n      }\n      if (label.includes(\"underlined = true\")) {\n        classString += \"is-underlined\";\n      }\n      if (label.includes(\"strikethrough = true\")) {\n        classString += \"is-strikethrough\";\n      }\n      if (label.includes(\"bold = true\")) {\n        classString += \"is-bold\";\n      }\n\n      return classString;\n    },\n    highlight(id) {\n      this.$store.dispatch(\"content/highlight\", {\n        target: id,\n        origin: \"content\",\n      });\n    },\n    scrollIntoView(id) {\n      if (!this.$refs[id]) return;\n      const [element] = this.$refs[id];\n      if (element)\n        element.scrollIntoView({\n          block: \"center\",\n          inline: \"center\",\n          behavior: \"smooth\",\n        });\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailContentTextEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailContentTextEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailContentTextEdit.vue?vue&type=template&id=1a5bd2ca&\"\nimport script from \"./DetailContentTextEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailContentTextEdit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <Layout>\n    <template #header> </template>\n    <template>\n      <ContentTextEdit :xmlJson=\"xmlJson\"/>\n    </template>\n    <template #footer> </template>\n  </Layout>\n</template>\n\n<script>\nimport Layout from \"./DetailContentLayout.vue\";\nimport ContentTextEdit from \"./DetailContentTextEdit.vue\";\n\nimport { mapState } from \"vuex\";\n\nexport default {\n  props: {\n    xmlJson: {\n      type: Object,\n      required: true,\n    },\n  },\n  components: {\n    Layout,\n    ContentTextEdit,\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailContentEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailContentEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailContentEdit.vue?vue&type=template&id=44433fd0&\"\nimport script from \"./DetailContentEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailContentEdit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('OpenSeadragon',{key:'penseadragon',ref:\"openseadragon\",staticClass:\"has-background-dark\",staticStyle:{\"width\":\"100%\",\"height\":\"100%\"},attrs:{\"id\":\"imageViewer\",\"options\":_vm.options},on:{\"open\":_vm.onOpen}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import config from \"../config\";\nimport round from \"lodash/round\";\n\nexport default {\n  data() {\n    return { imageBaseUrl: config.urls.image };\n  },\n  methods: {\n    getPaddedRect({ x, y, width, height }, padding = 5) {\n      return {\n        x: x - padding,\n        y: y - padding,\n        width: width + 2 * padding,\n        height: height + 2 * padding,\n      };\n    },\n    getImageInfo(id) {\n      return `${this.imageBaseUrl}/${id}/info.json`;\n    },\n    getImageSource(id, options = {}) {\n      const { x = 0, y = 0, width = \"\", height = \"\" } = options;\n      if (x === 0 && y === 0 && width === \"\" && height === \"\") {\n        return `${this.imageBaseUrl}/${id}/full/full/0/default.jpg`;\n      }\n      return `${this.imageBaseUrl}/${id}/${x},${y},${width},${height}/full/0/default.jpg`;\n    },\n    getScaledSource(id, { width = \"\", height = \"\" }) {\n      return `${this.imageBaseUrl}/${id}/full/${width},${height}/0/default.jpg`;\n    },\n    getThumbnailSource(id, params) {\n      return this.getScaledSource(id, params);\n    },\n    getContextImageSource(id, { x, y, width, height }, toRect) {\n      return `${this.imageBaseUrl}/${id}/${x},${y},${width},${height}/${toRect.width},${toRect.height}/0/default.jpg`;\n    },\n    getRoundedRect(rect, n = 2) {\n      return {\n        x: round(rect.x, 2),\n        y: round(rect.y, 2),\n        width: round(rect.width, 2),\n        height: round(rect.height, 2),\n      };\n    },\n    getIntersectionRatio(r1, r2) {\n      // https://stackoverflow.com/a/27162334\n      const dx =\n        Math.min(r1.x + r1.width, r2.x + r2.width) - Math.max(r1.x, r2.x);\n      const dy =\n        Math.min(r1.y + r1.height, r2.y + r2.height) - Math.max(r1.y, r2.y);\n      return Math.max(0, dx) * Math.max(0, dy);\n    },\n    getScaledRect({ x, y, width, height }) {\n      const rounded = (x) => Math.round(x * 1000000) / 1000000;\n      const w = this.width;\n      return {\n        x: rounded(x / w),\n        y: rounded(y / w),\n        width: rounded(width / w),\n        height: rounded(height / w),\n      };\n    },\n    getScaledPoints(points, width) {\n    \n      const rounded = (x) => Math.round(x * 1000) / 1000;\n      const w = width;\n      return points.map(({ x, y }) => ({\n        x: rounded(x / w),\n        y: rounded(y / w),\n      }));\n    },\n  \n    getPaddedRect({ x, y, width, height }, padding = 5) {\n      return {\n        x: x - padding,\n        y: y - padding,\n        width: width + 2 * padding,\n        height: height + 2 * padding,\n      };\n    },\n    parseNumber(value) {\n      if (typeof value === \"number\") return value;\n      if (typeof value === \"string\" && /\\d+/.test(value))\n        return parseInt(value);\n      return null;\n    },\n    roundNumber(value, n) {\n      return round(value, n);\n    },\n  },\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":_vm.id}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/* ** Based on https://github.com/braceslab/vue-openseadragon */\n\n<template>\n  <div :id=\"id\" />\n</template>\n\n<script>\nimport omit from \"lodash/omit\";\n\nexport default {\n  props: {\n    id: {\n      type: String,\n      default: \"openseadragon-editor\",\n    },\n    options: {\n      type: Object,\n    },\n    i18n: {\n      type: Object,\n    },\n    messages: {\n      type: Object,\n      default: () => ({\n        \"Tooltips.FullPage\": \"\",\n        \"Tooltips.Home\": \"\",\n        \"Tooltips.ZoomIn\": \"\",\n        \"Tooltips.ZoomOut\": \"\",\n        \"Tooltips.NextPage\": \"\",\n        \"Tooltips.PreviousPage\": \"\",\n        \"Tooltips.RotateLeft\": \"\",\n        \"Tooltips.RotateRight\": \"\",\n        \"Errors.Dzc\": \"\",\n        \"Errors.Dzi\": \"\",\n        \"Errors.Xml\": \"\",\n        \"Errors.ImageFormat\": \"\",\n        \"Errors.Security\": \"\",\n        \"Errors.Status\": \"\",\n        \"Errors.OpenFailed\": \"\",\n      }),\n    },\n  },\n  data() {\n    return {\n      viewer: null,\n    };\n  },\n\n  mounted() {\n    this.$nextTick(() => this.setup());\n  },\n  methods: {\n    setup() {\n      if (!this.viewer && this.options) {\n        this.translate();\n        const _options = this.options;\n        const OpenSeadragon = require(\"openseadragon\");\n        _options.id = this.id;\n        this.viewer = OpenSeadragon(omit(_options, \"tileSources\"));\n        this.viewer.open(_options.tileSources);\n        this.viewer.zoomPerClick = 1\n        this.viewer.addOnceHandler(\"open\", () => {\n          this.$emit(\"open\");\n        });\n      }\n    },\n    resolve(object, key) {\n      try {\n        const _keys = key.split(\".\");\n        let _cursor = object;\n        for (const _key of _keys) {\n          _cursor = _cursor[_key];\n        }\n        return _cursor;\n      } catch (e) {\n        return null;\n      }\n    },\n    /**\n\t@see https://openseadragon.github.io/examples/ui-customize-tooltips/\n      */\n    translate() {\n      if (!this.i18n || !this.messages) {\n        return;\n      }\n\n      const _messages = this.i18n.messages[this.i18n.locale];\n      const OpenSeadragon = require(\"openseadragon\");\n      for (const label in this.messages) {\n        OpenSeadragon.setString(\n          label,\n          this.resolve(_messages, this.messages[label])\n        );\n      }\n    },\n    panTo({ x, y }, immediate) {\n      const { Point } = require(\"openseadragon\");\n      this.viewer.viewport\n        .panTo(new Point(x, y), immediate)\n        .applyConstraints(immediate);\n    },\n    fitBoundsWithConstraints({ x, y, width, height }, immediate) {\n      const { Rect } = require(\"openseadragon\");\n      this.viewer.viewport\n        .fitBounds(new Rect(x, y, width, height), immediate)\n        .applyConstraints(immediate);\n    },\n    addOverlay({ element, location }) {\n      const { Overlay } = require(\"openseadragon\");\n      this.viewer.addOverlay(new Overlay({ element, location }));\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./vue-openseadragon.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./vue-openseadragon.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./vue-openseadragon.vue?vue&type=template&id=76016373&\"\nimport script from \"./vue-openseadragon.vue?vue&type=script&lang=js&\"\nexport * from \"./vue-openseadragon.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <OpenSeadragon\n    id=\"imageViewer\"\n    :key=\"'penseadragon'\"\n    ref=\"openseadragon\"\n    class=\"has-background-dark\"\n    :options=\"options\"\n    style=\"width: 100%; height: 100%\"\n    @open=\"onOpen\"\n  />\n</template>\n\n<script>\n// const svgOverlay = require(\"svg-overlay\");\n\nimport { mapState } from \"vuex\";\n\nimport imageMixin from \"../../mixins/image.js\";\n\nimport OpenSeadragon from \"../vue-openseadragon.vue\";\n\nimport { svgOverlay } from \"../../utils/openseadragon-svg-overlay.js\";\n\nexport default {\n  components: {\n    OpenSeadragon,\n  },\n  mixins: [imageMixin],\n  props: {\n    // source: {\n    //   type: String,\n    //   required: true,\n    // },\n    width: {\n      type: Number,\n      required: true,\n      default: 100,\n    },\n    height: {\n      type: Number,\n      required: true,\n    },\n    xmlJson: {\n      type: Object,\n      required: true,\n    },\n    results: {\n      type: Array,\n      required: true,\n    },\n  },\n\n  data: () => ({\n    overlays: null,\n    selectedOverlayIndex: null,\n    layoutElements: {},\n    // width: 0,\n    // height: 0,\n    selectedLayoutElement: null,\n    highlightedLayoutElement: null,\n    selectedOverlayIndex: null,\n  }),\n  watch: {\n    /*\n     ** FIXME: use reactive style everywhere, i.e. change variable in methods,\n     **        then watch this variable, perform action when it has changed\n     */\n    data: {\n      handler: function (newValue, oldValue) {\n        // if (newValue) this.layoutElements = this.renderLayout(newValue);\n      },\n      deep: true,\n    },\n    selected: {\n      handler: function (newValue, oldValue) {\n        if (newValue !== null && newValue.origin !== \"image\") {\n          this.selectLayoutElement(newValue.target);\n          this.fitBounds(newValue.target, true);\n        }\n      },\n      deep: true,\n    },\n    highlighted: {\n      handler: function (newValue, oldValue) {\n        if (newValue !== null && newValue.origin !== \"image\")\n          this.highlightLayoutElement(newValue.target);\n      },\n      deep: true,\n    },\n    // iiifUrl: {\n    //   handler: async function (newValue, oldValue) {\n    //   console.log('image changed fit width and height')\n    //   const response = await fetch(newValue);\n    //   const data = await response.json();\n    //   console.log('imageInfo ', data)\n    //   this.height = data.height\n    //   this.width = data.width\n    //   this.onOpen()\n      \n    //   },\n    //   deep: true,\n    // },\n  },\n  computed: {\n    ...mapState(\"content\", [\"data\", \"selected\", \"highlighted\", \"iiifUrl\"]),\n    options() {\n      const baseUrl =\n        \"https://cdnjs.cloudflare.com/ajax/libs/openseadragon/2.4.0\";\n      return {\n        tileSources: this.iiifUrl,\n        zoomPerClick: 1.2,\n        prefixUrl: `${baseUrl}/images/`,\n        maxZoomLevel: 5,\n        showZoomControl: false,\n        showHomeControl: false,\n        showFullPageControl: false,\n        visibilityRatio: 0.2,\n      };\n    },\n  },\n  destroyed() {\n    // clear svg node's content\n    if (this.$refs.openseadragon) {\n      const viewer = this.$refs.openseadragon.viewer;\n      const overlay = viewer.svgOverlay();\n      const svgNode = overlay.node();\n\n      if (svgNode) svgNode.innerHTML = \"\";\n    }\n  },\n  methods: {\n    onOpen() {\n      this.fitToWidth();\n\n      if (this.xmlJson) this.layoutElements = this.renderLayout(this.xmlJson);\n\n      if (this.overlays === null)\n        this.overlays = Object.freeze(this.createOverlays());\n\n      // const index = this.parseNumber(this.$route.query.result);\n      // if (index !== null && this.results.length > 0)\n      //   this.selectedOverlayIndex = index;\n\n      if (this.selectedOverlayIndex !== null)\n        this.selectWithPan(this.selectedOverlayIndex, false);\n    },\n    fitToWidth() {\n      /*\n       ** as seen on https://github.com/openseadragon/openseadragon/issues/839#issuecomment-181968800\n       */\n      const viewer = this.$refs.openseadragon.viewer;\n      const viewportBounds = viewer.viewport.getBounds();\n      const viewportAspect = viewportBounds.height / viewportBounds.width;\n      const newBounds = viewer.world.getHomeBounds();\n      newBounds.height = newBounds.width * viewportAspect;\n      viewer.viewport.fitBounds(newBounds, false);\n    },\n    setHome() {\n      if (!this.$refs.openseadragon) return;\n      const viewer = this.$refs.openseadragon.viewer;\n      // disables zoom on click\n      viewer.gestureSettingsMouse.clickToZoom = false;\n\n      /*\n       ** as seen on https://github.com/openseadragon/openseadragon/issues/839#issuecomment-181968800\n       */\n      const viewportBounds = viewer.viewport.getBounds();\n      const viewportAspect = viewportBounds.height / viewportBounds.width;\n      const newBounds = viewer.world.getHomeBounds();\n      newBounds.height = newBounds.width * viewportAspect;\n      viewer.viewport.fitBounds(newBounds, true);\n    },\n    panTo(index, isAnimated = false) {\n      if (this.results.length > 0) {\n        const { rect } = this.results[index];\n        const point = {\n          x: (rect.x + rect.width / 2) / this.width,\n          y: (rect.y + rect.height / 2) / this.width,\n        };\n        this.$refs.openseadragon.panTo(point, !isAnimated);\n      }\n    },\n    zoom(delta) {\n      if (!this.$refs.openseadragon) return;\n\n      const viewer = this.$refs.openseadragon.viewer;\n\n      if (delta > 0) {\n        viewer.viewport.zoomBy(1.5);\n      } else {\n        viewer.viewport.zoomBy(1 / 1.5);\n      }\n      viewer.viewport.applyConstraints();\n    },\n    async fitBounds(id, isAnimated = false) {\n      const data = await this.$store.dispatch(\"content/findElementById\", id);\n      if (data === null) return;\n\n      const toRect = (points) => {\n        const x = Math.min.apply(\n          null,\n          data.geometry.coords.map((p) => p.x)\n        );\n        const y = Math.min.apply(\n          null,\n          data.geometry.coords.map((p) => p.y)\n        );\n        const width =\n          Math.max.apply(\n            null,\n            data.geometry.coords.map((p) => p.x)\n          ) - x;\n        const height =\n          Math.max.apply(\n            null,\n            data.geometry.coords.map((p) => p.y)\n          ) - y;\n        return { x, y, width, height };\n      };\n\n      const rect = this.getScaledRect(\n        this.getPaddedRect(toRect(data.geometry.coords), 75)\n      );\n\n      const point = {\n        x: rect.x + rect.width / 2,\n        y: rect.y + rect.height / 2,\n      };\n\n      this.$refs.openseadragon.panTo(point, !isAnimated);\n    },\n    select(index, isAnimated) {\n      if (this.overlays.length === 0) return;\n      if (!(index < this.overlays.length)) return;\n\n      const activeNode =\n        this.selectedOverlayIndex === null\n          ? null\n          : this.overlays[this.selectedOverlayIndex].element;\n\n      const node = this.overlays[index].element;\n\n      if (activeNode && node !== activeNode)\n        activeNode.classList.remove(\"is-selected\");\n\n      node.classList.add(\"is-selected\");\n\n      this.selectedOverlayIndex = index;\n    },\n    selectWithPan(index) {\n      this.select(index, false);\n      this.panTo(index, false);\n    },\n    renderLayout(data) {\n      if (!this.$refs.openseadragon) return [];\n      //  FIXME openseadragon viewer and editor use same refernece -> collision\n      const viewer = this.$refs.openseadragon.viewer;\n      // const svgOverlay = require(\"svg-overlay\");\n\n      const d3 = require(\"d3\");\n      const overlay = viewer.svgOverlay();\n      const svg = d3.select(overlay.node());\n      svg.attr(\"class\", \"layout\");\n\n      const contentGroup = svg.append(\"g\");\n      return data.elements.reduce((m, element) => {\n        if (!element.geometry) return [];\n        const pointsTemp = element.geometry.coords;\n        if (pointsTemp)\n          this.renderPolygon({\n            parent: contentGroup,\n            points: pointsTemp,\n            className: \"content\",\n          });\n\n        const vm = this;\n\n        const elementGroup = contentGroup.append(\"g\");\n\n        return element.elements.reduce((m, element) => {\n          var points = element.geometry.coords;\n          var id = element.attributes.id;\n\n          if (element.type == \"TableCell\") {\n            return element.elements.reduce((m, element) => {\n              var points = element.geometry.coords;\n              var id = element.attributes.id;\n\n              const polygon = this.renderPolygon({\n                parent: elementGroup,\n                points: this.getScaledPoints(points, this.width),\n                className: \"element\",\n              })\n                .on(\"click\", () => {\n                  this.selectLayoutElement(id);\n                  this.$store.dispatch(\"content/select\", {\n                    target: id,\n                    origin: \"image\",\n                  });\n                })\n                .on(\"mouseover\", () => this.highlightLayoutElement(id), true)\n                .on(\"mouseout\", () => this.highlightLayoutElement(id), true)\n                .node();\n              return Object.assign(m, { [id]: polygon });\n            }, m);\n          }\n          const polygon = this.renderPolygon({\n            parent: elementGroup,\n            points: this.getScaledPoints(points, this.width),\n            className: \"element\",\n          })\n            .on(\"click\", () => {\n              this.selectLayoutElement(id);\n              this.$store.dispatch(\"content/select\", {\n                target: id,\n                origin: \"image\",\n              });\n            })\n            .on(\"mouseover\", () => this.highlightLayoutElement(id), true)\n            .on(\"mouseout\", () => this.highlightLayoutElement(id), true)\n            .node();\n          return Object.assign(m, { [id]: polygon });\n        }, m);\n      }, {});\n    },\n    async selectLayoutElement(id) {\n      const element = this.layoutElements[id];\n      if (!element) return;\n\n      if (\n        this.selectedLayoutElement !== null &&\n        element !== this.selectedLayoutElement &&\n        this.selectedLayoutElement.classList.contains(\"is-selected\")\n      )\n        this.selectedLayoutElement.classList.remove(\"is-selected\");\n\n      if (!element.classList.contains(\"is-selected\")) {\n        element.classList.add(\"is-selected\");\n      }\n\n      if (element !== this.selectedLayoutElement)\n        this.selectedLayoutElement = element;\n    },\n    highlightLayoutElement(id) {\n      const element = this.layoutElements[id];\n      if (!element) return;\n      if (this.highlightedLayoutElement === element) {\n        if (element.classList.contains(\"is-highlighted\"))\n          element.classList.remove(\"is-highlighted\");\n      } else {\n        this.highlightedLayoutElement = element;\n\n        if (!element.classList.contains(\"is-highlighted\"))\n          element.classList.add(\"is-highlighted\");\n      }\n\n      this.$store.dispatch(\"content/highlight\", {\n        target: id,\n        origin: \"image\",\n      });\n    },\n    renderPolygon({ parent, points, className }) {\n      return parent\n        .append(\"polygon\")\n        .attr(\n          \"points\",\n          points.map(({ x, y }) => {\n            return `${x},${y}`;\n          })\n        )\n        .attr(\"class\", className)\n        .attr(\"tabindex\", 0);\n    },\n    createOverlays() {\n      if (!this.$refs.openseadragon) return [];\n\n      const viewer = this.$refs.openseadragon.viewer;\n      // const svgOverlay = require(\"svg-overlay\");\n\n      const d3 = require(\"d3\");\n\n      const overlay = viewer.svgOverlay();\n\n      const svg = d3.select(overlay.node());\n\n      return this.results.map(({ score, label, ...result }, index) => {\n        const rect = this.getScaledRect(\n          this.getPaddedRect(result.rect, this.height / 100)\n        );\n\n        const d3Rect = svg\n          .append(\"rect\")\n          .attr(\"x\", rect.x)\n          .attr(\"y\", rect.y)\n          .attr(\"width\", rect.width)\n          .attr(\"height\", rect.height)\n          .attr(\"title\", `${label} (${this.sanitizeScore(score)})`)\n          .attr(\"class\", \"highlight is-primary\")\n          .on(\"click\", () => {\n            this.select(index, true);\n          });\n\n        return {\n          d3: d3Rect,\n          element: d3Rect.node(),\n        };\n      });\n    },\n    clear() {\n      if (this.overlays.length === 0) return;\n      const index = this.selectedOverlayIndex;\n\n      if (!(this.index < this.overlays.length)) return;\n\n      const node = this.overlays[index].element;\n      if (node) node.classList.remove(\"is-selected\");\n      this.selectedOverlayIndex = null;\n      this.setHome();\n    },\n    sanitizeScore(score) {\n      return score === 1 || score === 0\n        ? score + \".0\"\n        : Math.round(score * 100) / 100;\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailImageEditViewer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailImageEditViewer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailImageEditViewer.vue?vue&type=template&id=0d985f4e&\"\nimport script from \"./DetailImageEditViewer.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailImageEditViewer.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-field',{staticClass:\"has-background-white\",staticStyle:{\"flex-direction\":\"column\"}},[_c('p',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"position\":\"is-left\",\"label\":\"Increase zoom level\"}},[_c('b-button',{on:{\"click\":_vm.increaseZoom}},[_c('b-icon',{attrs:{\"icon\":\"plus\"}})],1)],1)],1),_c('p',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"position\":\"is-left\",\"label\":\"Decrease zoom level\"}},[_c('b-button',{on:{\"click\":_vm.decreaseZoom}},[_c('b-icon',{attrs:{\"icon\":\"minus\"}})],1)],1)],1),_c('p',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"position\":\"is-left\",\"label\":\"Fit to width\"}},[_c('b-button',{on:{\"click\":_vm.fitToWidth}},[_c('b-icon',{attrs:{\"icon\":\"compress\"}})],1)],1)],1),_c('p',{staticClass:\"control\"},[_c('b-tooltip',{attrs:{\"position\":\"is-left\",\"label\":\"Fullscreen\"}},[_c('b-button',{on:{\"click\":_vm.fullscreen}},[_c('b-icon',{attrs:{\"icon\":\"expand\"}})],1)],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <b-field class=\"has-background-white\" style=\"flex-direction: column;\">\n    <p class=\"control\">\n      <b-tooltip position=\"is-left\" label=\"Increase zoom level\">\n        <b-button @click=\"increaseZoom\">\n          <b-icon icon=\"plus\"></b-icon>\n        </b-button>\n      </b-tooltip>\n    </p>\n    <p class=\"control\">\n      <b-tooltip position=\"is-left\" label=\"Decrease zoom level\">\n        <b-button @click=\"decreaseZoom\">\n          <b-icon icon=\"minus\"></b-icon>\n        </b-button>\n      </b-tooltip>\n    </p>\n    <p class=\"control\">\n      <b-tooltip position=\"is-left\" label=\"Fit to width\">\n        <b-button @click=\"fitToWidth\">\n          <b-icon  icon=\"compress\"></b-icon>\n        </b-button>\n      </b-tooltip>\n    </p>\n    <p class=\"control\">\n      <b-tooltip position=\"is-left\" label=\"Fullscreen\">\n        <b-button @click=\"fullscreen\">\n          <b-icon  icon=\"expand\"></b-icon>\n        </b-button>\n      </b-tooltip>\n    </p>\n  </b-field>\n</template>\n<style >\n.field.has-addons {\n\tdisplay: flex;\n  justify-content: flex-start;\n\tflex-direction: column;\n}\n\n</style>\n\n<script>\n\nexport default {\n  methods: {\n    increaseZoom() {\n      this.$emit(\"input\", { type: \"zoom\", delta: 1 });\n    },\n    decreaseZoom() {\n      this.$emit(\"input\", { type: \"zoom\", delta: -1 });\n    },\n    home() {\n      this.$emit(\"input\", { type: \"home\" });\n    },\n    fitToWidth() {\n      this.$emit(\"input\", { type: \"fit\" });\n    },\n    fullscreen() {\n      this.$fullscreen.toggle();\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailImageControls.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailImageControls.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailImageControls.vue?vue&type=template&id=3cee92df&\"\nimport script from \"./DetailImageControls.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailImageControls.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DetailImageControls.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <section class=\"hero is-fullheight-with-navbar\">\n    <DetailEditLayout :name=\"view\">\n      <template v-slot:image>\n        <ImageViewer\n          v-if=\"imageInfo\"\n          ref=\"viewer\"\n          :source=\"iiifUrl\"\n          :width=\"imageInfo.width\"\n          :height=\"imageInfo.height\"\n          :xmlJson=\"xmlJson\"\n          :results=\"results\"\n        />\n        <aside class=\"detail-image-controls-wrapper\">\n          <ImageControls @input=\"handleControlEvent\" />\n        </aside>\n      </template>\n\n      <template v-slot:content>\n        <Content id=\"textEditor\" :xmlJson=\"xmlJson\" />\n      </template>\n    </DetailEditLayout>\n  </section>\n</template>\n<style lang=\"scss\">\n// .detail-image-controls-wrapper {\n//   position: absolute;\n//   right: 1.25rem;\n//   top: 1.25rem;\n// }\n</style>\n\n<script>\nimport DetailEditLayout from \"./DetailEditLayout.vue\";\nimport Content from \"./DetailContentEdit.vue\";\nimport ImageViewer from \"./DetailImageEditViewer.vue\";\nimport ImageControls from \"./DetailImageControls.vue\";\n\nimport { parseJsonContent } from \"../../utils/xml.js\";\nimport imageMixin from \"../../mixins/image.js\";\nimport { getImageSize } from \"../../utils/api.js\";\n\nimport { mapState, mapGetters } from \"vuex\";\n\nvar WindowObjectReference; // global variable\n\nexport default {\n  components: {\n    DetailEditLayout,\n    Content,\n    ImageViewer,\n    ImageControls,\n  },\n  props: {\n    // iiifUrl: {\n    //   type: String,\n    //   required: true,\n    // },\n    // xmlJson: {\n    //   type: Object,\n    //   required: true,\n    // },\n  },\n  mixins: [imageMixin],\n  data() {\n    return {\n      imageInfo: null,\n    };\n  },\n  computed: {\n    ...mapState(\"detail\", [\n      // document\n      \"docId\",\n      \"title\",\n      \"colTitle\",\n      \"pageNum\",\n      \"maxPage\",\n      \"isDocumentReady\",\n      \"tsList\",\n\n      // page\n      \"image\",\n      \"isPageReady\",\n      \"isPageContentReady\",\n      // search\n      \"results\",\n      \"view\",\n      \"tagMode\",\n    ]),\n    ...mapState(\"content\", [\n      \"data\",\n      \"selected\",\n      \"highlighted\",\n      \"fetchPageContent\",\n      \"iiifUrl\",\n      \"xmlJson\",\n    ]),\n    ...mapGetters(\"detail\", [\"isLoading\"]),\n    source() {\n      return this.getImageInfo(this.image.id);\n    }\n  },\n    watch: {\n      iiifUrl: {\n      handler: async function (newValue, oldValue) {\n        this.imageInfo= null\n      const response = await fetch(newValue);\n      const data = await response.json();\n      this.imageInfo= data\n     },\n      deep: true,\n    },\n    },\n  async mounted() {\n    const response = await fetch(this.iiifUrl);\n    const data = await response.json();\n    this.imageInfo = data;\n  },\n  async destroyed() {\n    // reset state\n    this.$store.dispatch(\"content/reset\");\n  },\n  methods: {\n    async update() {\n      await this.$store.dispatch(\"detail/fetch\", this.$route.params);\n    },\n    handleControlEvent(event) {\n      if (event.type.toLowerCase() === \"zoom\") {\n        this.$refs.viewer.zoom(event.delta);\n      }\n      if (event.type.toLowerCase() === \"home\") {\n        this.$refs.viewer.setHome();\n      }\n      if (event.type.toLowerCase() === \"fit\") {\n        this.$refs.viewer.fitToWidth();\n      }\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TranscriptionInterfaceLocal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TranscriptionInterfaceLocal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TranscriptionInterfaceLocal.vue?vue&type=template&id=4611c6b2&\"\nimport script from \"./TranscriptionInterfaceLocal.vue?vue&type=script&lang=js&\"\nexport * from \"./TranscriptionInterfaceLocal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TranscriptionInterfaceLocal.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <section>\n    <b-loading :active=\"!iiifUrl && !xmlJson\"></b-loading>\n    <TranscriptionInterfaceLocal\n      :iiifUrl=\"iiifUrl\"\n      :xmlJson=\"xmlJson\"\n      :tags=\"tags\"\n    />\n  </section>\n</template>\n\n<script>\nimport TranscriptionInterfaceLocal from \"../components/DetailView/TranscriptionInterfaceLocal.vue\";\n\nimport { mapState, mapGetters } from \"vuex\";\n\nimport imageMixin from \"../mixins/image.js\";\n\nconst json = require(\"../assets/page1.json\");\n\nexport default {\n  components: {\n    TranscriptionInterfaceLocal,\n  },\n  mixins: [imageMixin],\n  computed: {\n    ...mapState(\"content\", [\"iiifUrl\", \"xmlJson\"]),\n  },\n  props: {\n    // iiifUrl: {\n    //   type: String,\n    //   required: true,\n    // },\n    // xmlJson: {\n    //   type: Object,\n    //   required: true,\n    // },\n  },\n  data() {\n    return {};\n  },\n  methods: {},\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Editor.vue?vue&type=template&id=ff5bd3ca&\"\nimport script from \"./Editor.vue?vue&type=script&lang=js&\"\nexport * from \"./Editor.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"transkribusEditor\">\n    <Editor v-if=\"xmlJsonString\" :iiifUrl=\"iiifUrl\" :xmlJson=\"toJsonObject\" />\n    <Editor v-else :iiifUrl=\"iiifUrl\" :xmlJson=\"xmlJson\" />\n  </div>\n</template>\n\n<script>\n// Test page : http://localhost:5000/collection/76950/doc/497355/detail/1\n\nimport Editor from \"./views/Editor.vue\";\nimport { mapState, mapGetters } from \"vuex\";\n\nconst json = require(\"./assets/page1.json\");\n\nexport default {\n  name: \"transkribusEditor\",\n  props: {\n    iiifUrl: {\n      type: String,\n      // default: () =>\n      //   \"https://files.transkribus.eu/iiif/2/XITIHIQXRRBAHPZDHDPHWHMP/info.json\",\n    },\n    xmlJson: {\n      type: Object,\n      // default: () => json,\n    },\n    xmlJsonString: {\n      type: String,\n    },\n    xml: {\n      type: String,\n    },\n    tags: {\n      type: String,\n    },\n  },\n  watch: {\n    iiifUrl: {\n      handler: async function (newValue, oldValue) {\n        console.log(\"set IIIF\", newValue);\n        this.$store.dispatch(\"content/setIIIF\", {\n          iiifUrl: newValue,\n        });\n      },\n      deep: true,\n    },\n    xml: {\n      handler: async function (newValue, oldValue) {\n        console.log(\"set XML\", newValue);\n\n        this.$store.dispatch(\"content/setXml\", {\n          xml: newValue,\n        });\n      },\n      deep: true,\n    },\n    tags: {\n      handler: async function (newValue, oldValue) {\n        var cleanedString = this.escapeSpecialChars(newValue);\n        const obj = JSON.parse(cleanedString);\n        console.log(\"set Tags\", obj);\n        this.$store.dispatch(\"browse/setTagDefs\", { tagDefs: obj });\n      },\n      deep: true,\n    },\n    xmlJsonString: {\n      handler: async function (newValue, oldValue) {\n        console.log(\"set xmlJsonString\", this.toJsonObject);\n        this.$store.dispatch(\"content/setXmlJson\", {\n          xmlJson: this.toJsonObject,\n        });\n      },\n      deep: true,\n    },\n  },\n  methods: {\n    escapeSpecialChars(string) {\n      return string\n        .replace(/\\\\n/g, \"\\\\n\")\n        .replace(/\\\\'/g, \"\\\\'\")\n        .replace(/\\\\\"/g, '\\\\\"')\n        .replace(/\\\\&/g, \"\\\\&\")\n        .replace(/\\\\r/g, \"\\\\r\")\n        .replace(/\\\\t/g, \"\\\\t\")\n        .replace(/\\\\b/g, \"\\\\b\")\n        .replace(/\\\\f/g, \"\\\\f\");\n    },\n  },\n  components: {\n    Editor,\n  },\n  computed: {\n    toJsonObject() {\n      var cleanedString = this.escapeSpecialChars(this.xmlJsonString);\n      const obj = JSON.parse(cleanedString);\n      return obj;\n    },\n    // ...mapState(\"content\", [\n    //   \"data\",\n    //   \"selected\",\n    //   \"highlighted\",\n    //   \"fetchPageContent\",\n    //   \"iiifUrl\",\n    //   \"xmlJson\",\n    // ]),\n  },\n  mounted() {\n    if (this.iiifUrl) {\n      this.$store.dispatch(\"content/setIIIF\", {\n        iiifUrl: this.iiifUrl,\n      });\n    }\n    if (this.xml) {\n      this.$store.dispatch(\"content/setXml\", {\n        xml: this.xml,\n      });\n    }\n    if (this.xmlJsonString) {\n      this.$store.dispatch(\"content/setXmlJson\", {\n        xmlJson: this.toJsonObject,\n      });\n    }\n    if (this.tags) {\n      var cleanedString = this.escapeSpecialChars(this.tags);\n      const obj = JSON.parse(cleanedString);\n      this.$store.dispatch(\"browse/setTagDefs\", { tagDefs: obj });\n    }\n  },\n};\n</script>\n<style lang=\"scss\">\n@import \"~bulma/sass/utilities/_all\";\n@import \"assets/variables.scss\";\n@import \"assets/styles.scss\";\n\n@import \"bulma\";\n@import \"buefy/src/scss/buefy\";\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=b1415dd2&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { library } from \"@fortawesome/fontawesome-svg-core\";\nimport {\n  faSearch,\n  faAngleRight,\n  faAngleLeft,\n  faAngleUp,\n  faAngleDown,\n  faMinusSquare,\n  faPlusSquare,\n  faChevronLeft,\n  faChevronRight,\n  faChevronUp,\n  faChevronDown,\n  faFileAlt,\n  faTimes,\n  faArrowUp,\n  faArrowDown,\n  faPlus,\n  faMinus,\n  faTrash,\n  faDesktop,\n  faColumns,\n  faImage,\n  faCode,\n  faEye,\n  faPaperPlane,\n  faCheck,\n  faShoppingCart,\n  faDownload,\n  faEyeSlash,\n  faTags,\n  faCaretDown,\n  faCaretUp,\n  faImages,\n  faAlignLeft,\n  faObjectGroup,\n  faQuestion,\n  faQuestionCircle,\n  faExternalLinkAlt,\n  faUndo,\n  faRedo,\n  faBars,\n  faSave,\n  faBold,\n  faCompress,\n  faExpand,\n  faStrikethrough,\n  faUnderline,\n  faSubscript,\n  faSuperscript,\n  faTag,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\n\nexport default {\n  install(Vue, options = {}) {\n    library.add(\n      faSearch,\n      faAngleRight,\n      faAngleLeft,\n      faAngleUp,\n      faAngleDown,\n      faMinusSquare,\n      faPlusSquare,\n      faChevronLeft,\n      faChevronRight,\n      faChevronUp,\n      faChevronDown,\n      faFileAlt,\n      faTimes,\n      faArrowUp,\n      faCompress,\n      faExpand,\n      faArrowDown,\n      faPlus,\n      faMinus,\n      faTrash,\n      faDesktop,\n      faColumns,\n      faImage,\n      faCode,\n      faEye,\n      faPaperPlane,\n      faCheck,\n      faShoppingCart,\n      faDownload,\n      faEyeSlash,\n      faTags,\n      faCaretDown,\n      faCaretUp,\n      faAlignLeft,\n      faImages,\n      faObjectGroup,\n      faQuestion,\n      faQuestionCircle,\n      faExternalLinkAlt,\n      faUndo,\n      faRedo,\n      faBars,\n      faSave,\n      faBold,\n      faStrikethrough,\n      faUnderline,\n      faSubscript,\n      faSuperscript,\n      faTag\n    );\n\n    Vue.component(\"font-awesome-icon\", FontAwesomeIcon);\n  },\n};\n","import Vue from \"vue\";\nimport App from \"./App.vue\";\nimport Vuex from \"vuex\";\nimport Buefy from \"buefy\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/vue-fontawesome\";\nimport fontawesome from \"@/plugins/fontawesome.js\";\nimport VueFullscreen from \"vue-fullscreen\";\nimport banner from \"rollup-plugin-banner\";\nimport store from \"@/store\";\n\nVue.config.productionTip = false;\n\nVue.use(Vuex);\nVue.use(fontawesome);\n\nVue.use(Buefy, {\n  defaultIconComponent: FontAwesomeIcon,\n  defaultIconPack: \"fas\",\n});\nVue.use(VueFullscreen);\n\nconst root_element = document.getElementById(\"transkribusEditor\");\nconst AppRoot = Vue.extend(App);\n\n\nwindow.eventBus = new AppRoot({\n  store,\n  el: root_element,\n  propsData: { ...root_element.dataset },\n  mounted() {\n    this.$root.$on(\"save\", this.save);\n    const that = this;\n    this.$root.$on(\"change\", function (payLoad) {\n      if (payLoad.iiifUrl) {\n        that.$store.dispatch(\"content/setIIIF\", {\n          iiifUrl: payLoad.iiifUrl,\n        });\n      }\n      if (payLoad.xmlJsonString) {\n        var cleanedString = this.escapeSpecialChars(payLoad.xmlJsonString);\n        const obj = JSON.parse(cleanedString);\n        that.$store.dispatch(\"content/setXmlJson\", {\n          xmlJson: obj,\n        });\n      }\n      if (payLoad.xml) {\n        that.$store.dispatch(\"content/setXml\", {\n          xml: payLoad.xml,\n        });\n      }\n    });\n  },\n  methods: {\n    save(value) {\n      window.output = value;\n      root_element.dataset.output = JSON.stringify(value);\n      window.eventBus.$emit(\"dataSaved\", value);\n    },\n    escapeSpecialChars(string) {\n      return string\n        .replace(/\\\\n/g, \"\\\\n\")\n        .replace(/\\\\'/g, \"\\\\'\")\n        .replace(/\\\\\"/g, '\\\\\"')\n        .replace(/\\\\&/g, \"\\\\&\")\n        .replace(/\\\\r/g, \"\\\\r\")\n        .replace(/\\\\t/g, \"\\\\t\")\n        .replace(/\\\\b/g, \"\\\\b\")\n        .replace(/\\\\f/g, \"\\\\f\");\n    },\n  },\n}).$mount(\"#transkribusEditor\");\n\nexport default AppRoot;\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailImageControls.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TranscriptionInterfaceLocal.vue?vue&type=style&index=0&lang=scss&\"","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = \"a3ea\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RegionNode.vue?vue&type=style&index=0&id=90ae8d76&lang=scss&scoped=true&\""],"sourceRoot":""}